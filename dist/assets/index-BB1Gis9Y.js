(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var hI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function i0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var r0={exports:{}},ad={},o0={exports:{}},xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fl=Symbol.for("react.element"),fI=Symbol.for("react.portal"),pI=Symbol.for("react.fragment"),mI=Symbol.for("react.strict_mode"),gI=Symbol.for("react.profiler"),_I=Symbol.for("react.provider"),yI=Symbol.for("react.context"),vI=Symbol.for("react.forward_ref"),TI=Symbol.for("react.suspense"),EI=Symbol.for("react.memo"),wI=Symbol.for("react.lazy"),vg=Symbol.iterator;function CI(t){return t===null||typeof t!="object"?null:(t=vg&&t[vg]||t["@@iterator"],typeof t=="function"?t:null)}var s0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},a0=Object.assign,l0={};function Ns(t,e,n){this.props=t,this.context=e,this.refs=l0,this.updater=n||s0}Ns.prototype.isReactComponent={};Ns.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ns.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function u0(){}u0.prototype=Ns.prototype;function sp(t,e,n){this.props=t,this.context=e,this.refs=l0,this.updater=n||s0}var ap=sp.prototype=new u0;ap.constructor=sp;a0(ap,Ns.prototype);ap.isPureReactComponent=!0;var Tg=Array.isArray,c0=Object.prototype.hasOwnProperty,lp={current:null},d0={key:!0,ref:!0,__self:!0,__source:!0};function h0(t,e,n){var i,r={},o=null,a=null;if(e!=null)for(i in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)c0.call(e,i)&&!d0.hasOwnProperty(i)&&(r[i]=e[i]);var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){for(var d=Array(u),p=0;p<u;p++)d[p]=arguments[p+2];r.children=d}if(t&&t.defaultProps)for(i in u=t.defaultProps,u)r[i]===void 0&&(r[i]=u[i]);return{$$typeof:Fl,type:t,key:o,ref:a,props:r,_owner:lp.current}}function II(t,e){return{$$typeof:Fl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function up(t){return typeof t=="object"&&t!==null&&t.$$typeof===Fl}function SI(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Eg=/\/+/g;function Xd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?SI(""+t.key):e.toString(36)}function rc(t,e,n,i,r){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Fl:case fI:a=!0}}if(a)return a=t,r=r(a),t=i===""?"."+Xd(a,0):i,Tg(r)?(n="",t!=null&&(n=t.replace(Eg,"$&/")+"/"),rc(r,e,n,"",function(p){return p})):r!=null&&(up(r)&&(r=II(r,n+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(Eg,"$&/")+"/")+t)),e.push(r)),1;if(a=0,i=i===""?".":i+":",Tg(t))for(var u=0;u<t.length;u++){o=t[u];var d=i+Xd(o,u);a+=rc(o,e,n,d,r)}else if(d=CI(t),typeof d=="function")for(t=d.call(t),u=0;!(o=t.next()).done;)o=o.value,d=i+Xd(o,u++),a+=rc(o,e,n,d,r);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Du(t,e,n){if(t==null)return t;var i=[],r=0;return rc(t,i,"","",function(o){return e.call(n,o,r++)}),i}function xI(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Kt={current:null},oc={transition:null},AI={ReactCurrentDispatcher:Kt,ReactCurrentBatchConfig:oc,ReactCurrentOwner:lp};function f0(){throw Error("act(...) is not supported in production builds of React.")}xe.Children={map:Du,forEach:function(t,e,n){Du(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Du(t,function(){e++}),e},toArray:function(t){return Du(t,function(e){return e})||[]},only:function(t){if(!up(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};xe.Component=Ns;xe.Fragment=pI;xe.Profiler=gI;xe.PureComponent=sp;xe.StrictMode=mI;xe.Suspense=TI;xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AI;xe.act=f0;xe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=a0({},t.props),r=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=lp.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(d in e)c0.call(e,d)&&!d0.hasOwnProperty(d)&&(i[d]=e[d]===void 0&&u!==void 0?u[d]:e[d])}var d=arguments.length-2;if(d===1)i.children=n;else if(1<d){u=Array(d);for(var p=0;p<d;p++)u[p]=arguments[p+2];i.children=u}return{$$typeof:Fl,type:t.type,key:r,ref:o,props:i,_owner:a}};xe.createContext=function(t){return t={$$typeof:yI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:_I,_context:t},t.Consumer=t};xe.createElement=h0;xe.createFactory=function(t){var e=h0.bind(null,t);return e.type=t,e};xe.createRef=function(){return{current:null}};xe.forwardRef=function(t){return{$$typeof:vI,render:t}};xe.isValidElement=up;xe.lazy=function(t){return{$$typeof:wI,_payload:{_status:-1,_result:t},_init:xI}};xe.memo=function(t,e){return{$$typeof:EI,type:t,compare:e===void 0?null:e}};xe.startTransition=function(t){var e=oc.transition;oc.transition={};try{t()}finally{oc.transition=e}};xe.unstable_act=f0;xe.useCallback=function(t,e){return Kt.current.useCallback(t,e)};xe.useContext=function(t){return Kt.current.useContext(t)};xe.useDebugValue=function(){};xe.useDeferredValue=function(t){return Kt.current.useDeferredValue(t)};xe.useEffect=function(t,e){return Kt.current.useEffect(t,e)};xe.useId=function(){return Kt.current.useId()};xe.useImperativeHandle=function(t,e,n){return Kt.current.useImperativeHandle(t,e,n)};xe.useInsertionEffect=function(t,e){return Kt.current.useInsertionEffect(t,e)};xe.useLayoutEffect=function(t,e){return Kt.current.useLayoutEffect(t,e)};xe.useMemo=function(t,e){return Kt.current.useMemo(t,e)};xe.useReducer=function(t,e,n){return Kt.current.useReducer(t,e,n)};xe.useRef=function(t){return Kt.current.useRef(t)};xe.useState=function(t){return Kt.current.useState(t)};xe.useSyncExternalStore=function(t,e,n){return Kt.current.useSyncExternalStore(t,e,n)};xe.useTransition=function(){return Kt.current.useTransition()};xe.version="18.3.1";o0.exports=xe;var ne=o0.exports;const ms=i0(ne);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PI=ne,RI=Symbol.for("react.element"),NI=Symbol.for("react.fragment"),kI=Object.prototype.hasOwnProperty,MI=PI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,LI={key:!0,ref:!0,__self:!0,__source:!0};function p0(t,e,n){var i,r={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(i in e)kI.call(e,i)&&!LI.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:RI,type:t,key:o,ref:a,props:r,_owner:MI.current}}ad.Fragment=NI;ad.jsx=p0;ad.jsxs=p0;r0.exports=ad;var C=r0.exports,Dh={},m0={exports:{}},fn={},g0={exports:{}},_0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,fe){var ee=Z.length;Z.push(fe);e:for(;0<ee;){var pe=ee-1>>>1,Ee=Z[pe];if(0<r(Ee,fe))Z[pe]=fe,Z[ee]=Ee,ee=pe;else break e}}function n(Z){return Z.length===0?null:Z[0]}function i(Z){if(Z.length===0)return null;var fe=Z[0],ee=Z.pop();if(ee!==fe){Z[0]=ee;e:for(var pe=0,Ee=Z.length,Ae=Ee>>>1;pe<Ae;){var Ue=2*(pe+1)-1,Ce=Z[Ue],_e=Ue+1,_t=Z[_e];if(0>r(Ce,ee))_e<Ee&&0>r(_t,Ce)?(Z[pe]=_t,Z[_e]=ee,pe=_e):(Z[pe]=Ce,Z[Ue]=ee,pe=Ue);else if(_e<Ee&&0>r(_t,ee))Z[pe]=_t,Z[_e]=ee,pe=_e;else break e}}return fe}function r(Z,fe){var ee=Z.sortIndex-fe.sortIndex;return ee!==0?ee:Z.id-fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}var d=[],p=[],g=1,y=null,T=3,I=!1,V=!1,b=!1,q=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(Z){for(var fe=n(p);fe!==null;){if(fe.callback===null)i(p);else if(fe.startTime<=Z)i(p),fe.sortIndex=fe.expirationTime,e(d,fe);else break;fe=n(p)}}function z(Z){if(b=!1,R(Z),!V)if(n(d)!==null)V=!0,we(W);else{var fe=n(p);fe!==null&&Fe(z,fe.startTime-Z)}}function W(Z,fe){V=!1,b&&(b=!1,A(N),N=-1),I=!0;var ee=T;try{for(R(fe),y=n(d);y!==null&&(!(y.expirationTime>fe)||Z&&!B());){var pe=y.callback;if(typeof pe=="function"){y.callback=null,T=y.priorityLevel;var Ee=pe(y.expirationTime<=fe);fe=t.unstable_now(),typeof Ee=="function"?y.callback=Ee:y===n(d)&&i(d),R(fe)}else i(d);y=n(d)}if(y!==null)var Ae=!0;else{var Ue=n(p);Ue!==null&&Fe(z,Ue.startTime-fe),Ae=!1}return Ae}finally{y=null,T=ee,I=!1}}var J=!1,k=null,N=-1,D=5,F=-1;function B(){return!(t.unstable_now()-F<D)}function U(){if(k!==null){var Z=t.unstable_now();F=Z;var fe=!0;try{fe=k(!0,Z)}finally{fe?M():(J=!1,k=null)}}else J=!1}var M;if(typeof x=="function")M=function(){x(U)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,De=le.port2;le.port1.onmessage=U,M=function(){De.postMessage(null)}}else M=function(){q(U,0)};function we(Z){k=Z,J||(J=!0,M())}function Fe(Z,fe){N=q(function(){Z(t.unstable_now())},fe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){V||I||(V=!0,we(W))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return T},t.unstable_getFirstCallbackNode=function(){return n(d)},t.unstable_next=function(Z){switch(T){case 1:case 2:case 3:var fe=3;break;default:fe=T}var ee=T;T=fe;try{return Z()}finally{T=ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,fe){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ee=T;T=Z;try{return fe()}finally{T=ee}},t.unstable_scheduleCallback=function(Z,fe,ee){var pe=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?pe+ee:pe):ee=pe,Z){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=ee+Ee,Z={id:g++,callback:fe,priorityLevel:Z,startTime:ee,expirationTime:Ee,sortIndex:-1},ee>pe?(Z.sortIndex=ee,e(p,Z),n(d)===null&&Z===n(p)&&(b?(A(N),N=-1):b=!0,Fe(z,ee-pe))):(Z.sortIndex=Ee,e(d,Z),V||I||(V=!0,we(W))),Z},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(Z){var fe=T;return function(){var ee=T;T=fe;try{return Z.apply(this,arguments)}finally{T=ee}}}})(_0);g0.exports=_0;var DI=g0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VI=ne,hn=DI;function j(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y0=new Set,sl={};function io(t,e){gs(t,e),gs(t+"Capture",e)}function gs(t,e){for(sl[t]=e,t=0;t<e.length;t++)y0.add(e[t])}var Ii=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vh=Object.prototype.hasOwnProperty,bI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wg={},Cg={};function FI(t){return Vh.call(Cg,t)?!0:Vh.call(wg,t)?!1:bI.test(t)?Cg[t]=!0:(wg[t]=!0,!1)}function UI(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function OI(t,e,n,i){if(e===null||typeof e>"u"||UI(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Jt(t,e,n,i,r,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var Lt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Lt[t]=new Jt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Lt[e]=new Jt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Lt[t]=new Jt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Lt[t]=new Jt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Lt[t]=new Jt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Lt[t]=new Jt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Lt[t]=new Jt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Lt[t]=new Jt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Lt[t]=new Jt(t,5,!1,t.toLowerCase(),null,!1,!1)});var cp=/[\-:]([a-z])/g;function dp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cp,dp);Lt[e]=new Jt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cp,dp);Lt[e]=new Jt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cp,dp);Lt[e]=new Jt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Lt[t]=new Jt(t,1,!1,t.toLowerCase(),null,!1,!1)});Lt.xlinkHref=new Jt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Lt[t]=new Jt(t,1,!1,t.toLowerCase(),null,!0,!0)});function hp(t,e,n,i){var r=Lt.hasOwnProperty(e)?Lt[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(OI(e,n,r,i)&&(n=null),i||r===null?FI(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var Mi=VI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vu=Symbol.for("react.element"),Wo=Symbol.for("react.portal"),$o=Symbol.for("react.fragment"),fp=Symbol.for("react.strict_mode"),bh=Symbol.for("react.profiler"),v0=Symbol.for("react.provider"),T0=Symbol.for("react.context"),pp=Symbol.for("react.forward_ref"),Fh=Symbol.for("react.suspense"),Uh=Symbol.for("react.suspense_list"),mp=Symbol.for("react.memo"),Ki=Symbol.for("react.lazy"),E0=Symbol.for("react.offscreen"),Ig=Symbol.iterator;function Sa(t){return t===null||typeof t!="object"?null:(t=Ig&&t[Ig]||t["@@iterator"],typeof t=="function"?t:null)}var rt=Object.assign,jd;function Fa(t){if(jd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);jd=e&&e[1]||""}return`
`+jd+t}var eh=!1;function th(t,e){if(!t||eh)return"";eh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(p){var i=p}Reflect.construct(t,[],e)}else{try{e.call()}catch(p){i=p}t.call(e.prototype)}else{try{throw Error()}catch(p){i=p}t()}}catch(p){if(p&&i&&typeof p.stack=="string"){for(var r=p.stack.split(`
`),o=i.stack.split(`
`),a=r.length-1,u=o.length-1;1<=a&&0<=u&&r[a]!==o[u];)u--;for(;1<=a&&0<=u;a--,u--)if(r[a]!==o[u]){if(a!==1||u!==1)do if(a--,u--,0>u||r[a]!==o[u]){var d=`
`+r[a].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=a&&0<=u);break}}}finally{eh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fa(t):""}function BI(t){switch(t.tag){case 5:return Fa(t.type);case 16:return Fa("Lazy");case 13:return Fa("Suspense");case 19:return Fa("SuspenseList");case 0:case 2:case 15:return t=th(t.type,!1),t;case 11:return t=th(t.type.render,!1),t;case 1:return t=th(t.type,!0),t;default:return""}}function Oh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case $o:return"Fragment";case Wo:return"Portal";case bh:return"Profiler";case fp:return"StrictMode";case Fh:return"Suspense";case Uh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case T0:return(t.displayName||"Context")+".Consumer";case v0:return(t._context.displayName||"Context")+".Provider";case pp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case mp:return e=t.displayName||null,e!==null?e:Oh(t.type)||"Memo";case Ki:e=t._payload,t=t._init;try{return Oh(t(e))}catch{}}return null}function zI(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Oh(e);case 8:return e===fp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function w0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function qI(t){var e=w0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,o.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function bu(t){t._valueTracker||(t._valueTracker=qI(t))}function C0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=w0(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Cc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Bh(t,e){var n=e.checked;return rt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Sg(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=hr(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function I0(t,e){e=e.checked,e!=null&&hp(t,"checked",e,!1)}function zh(t,e){I0(t,e);var n=hr(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?qh(t,e.type,n):e.hasOwnProperty("defaultValue")&&qh(t,e.type,hr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function xg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function qh(t,e,n){(e!=="number"||Cc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ua=Array.isArray;function rs(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+hr(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Hh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(j(91));return rt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ag(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(j(92));if(Ua(n)){if(1<n.length)throw Error(j(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:hr(n)}}function S0(t,e){var n=hr(e.value),i=hr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function Pg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function x0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Gh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?x0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Fu,A0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Fu=Fu||document.createElement("div"),Fu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Fu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function al(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Wa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},HI=["Webkit","ms","Moz","O"];Object.keys(Wa).forEach(function(t){HI.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Wa[e]=Wa[t]})});function P0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Wa.hasOwnProperty(t)&&Wa[t]?(""+e).trim():e+"px"}function R0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=P0(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var GI=rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wh(t,e){if(e){if(GI[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(j(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(j(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(j(61))}if(e.style!=null&&typeof e.style!="object")throw Error(j(62))}}function $h(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kh=null;function gp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Jh=null,os=null,ss=null;function Rg(t){if(t=Bl(t)){if(typeof Jh!="function")throw Error(j(280));var e=t.stateNode;e&&(e=hd(e),Jh(t.stateNode,t.type,e))}}function N0(t){os?ss?ss.push(t):ss=[t]:os=t}function k0(){if(os){var t=os,e=ss;if(ss=os=null,Rg(t),e)for(t=0;t<e.length;t++)Rg(e[t])}}function M0(t,e){return t(e)}function L0(){}var nh=!1;function D0(t,e,n){if(nh)return t(e,n);nh=!0;try{return M0(t,e,n)}finally{nh=!1,(os!==null||ss!==null)&&(L0(),k0())}}function ll(t,e){var n=t.stateNode;if(n===null)return null;var i=hd(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(j(231,e,typeof n));return n}var Zh=!1;if(Ii)try{var xa={};Object.defineProperty(xa,"passive",{get:function(){Zh=!0}}),window.addEventListener("test",xa,xa),window.removeEventListener("test",xa,xa)}catch{Zh=!1}function WI(t,e,n,i,r,o,a,u,d){var p=Array.prototype.slice.call(arguments,3);try{e.apply(n,p)}catch(g){this.onError(g)}}var $a=!1,Ic=null,Sc=!1,Yh=null,$I={onError:function(t){$a=!0,Ic=t}};function KI(t,e,n,i,r,o,a,u,d){$a=!1,Ic=null,WI.apply($I,arguments)}function JI(t,e,n,i,r,o,a,u,d){if(KI.apply(this,arguments),$a){if($a){var p=Ic;$a=!1,Ic=null}else throw Error(j(198));Sc||(Sc=!0,Yh=p)}}function ro(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function V0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ng(t){if(ro(t)!==t)throw Error(j(188))}function ZI(t){var e=t.alternate;if(!e){if(e=ro(t),e===null)throw Error(j(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var o=r.alternate;if(o===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return Ng(r),t;if(o===i)return Ng(r),e;o=o.sibling}throw Error(j(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,u=r.child;u;){if(u===n){a=!0,n=r,i=o;break}if(u===i){a=!0,i=r,n=o;break}u=u.sibling}if(!a){for(u=o.child;u;){if(u===n){a=!0,n=o,i=r;break}if(u===i){a=!0,i=o,n=r;break}u=u.sibling}if(!a)throw Error(j(189))}}if(n.alternate!==i)throw Error(j(190))}if(n.tag!==3)throw Error(j(188));return n.stateNode.current===n?t:e}function b0(t){return t=ZI(t),t!==null?F0(t):null}function F0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=F0(t);if(e!==null)return e;t=t.sibling}return null}var U0=hn.unstable_scheduleCallback,kg=hn.unstable_cancelCallback,YI=hn.unstable_shouldYield,QI=hn.unstable_requestPaint,ct=hn.unstable_now,XI=hn.unstable_getCurrentPriorityLevel,_p=hn.unstable_ImmediatePriority,O0=hn.unstable_UserBlockingPriority,xc=hn.unstable_NormalPriority,jI=hn.unstable_LowPriority,B0=hn.unstable_IdlePriority,ld=null,ei=null;function eS(t){if(ei&&typeof ei.onCommitFiberRoot=="function")try{ei.onCommitFiberRoot(ld,t,void 0,(t.current.flags&128)===128)}catch{}}var zn=Math.clz32?Math.clz32:iS,tS=Math.log,nS=Math.LN2;function iS(t){return t>>>=0,t===0?32:31-(tS(t)/nS|0)|0}var Uu=64,Ou=4194304;function Oa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ac(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,o=t.pingedLanes,a=n&268435455;if(a!==0){var u=a&~r;u!==0?i=Oa(u):(o&=a,o!==0&&(i=Oa(o)))}else a=n&~r,a!==0?i=Oa(a):o!==0&&(i=Oa(o));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,o=e&-e,r>=o||r===16&&(o&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-zn(e),r=1<<n,i|=t[n],e&=~r;return i}function rS(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oS(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-zn(o),u=1<<a,d=r[a];d===-1?(!(u&n)||u&i)&&(r[a]=rS(u,e)):d<=e&&(t.expiredLanes|=u),o&=~u}}function Qh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function z0(){var t=Uu;return Uu<<=1,!(Uu&4194240)&&(Uu=64),t}function ih(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ul(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-zn(e),t[e]=n}function sS(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-zn(n),o=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~o}}function yp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-zn(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var Be=0;function q0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var H0,vp,G0,W0,$0,Xh=!1,Bu=[],tr=null,nr=null,ir=null,ul=new Map,cl=new Map,Yi=[],aS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mg(t,e){switch(t){case"focusin":case"focusout":tr=null;break;case"dragenter":case"dragleave":nr=null;break;case"mouseover":case"mouseout":ir=null;break;case"pointerover":case"pointerout":ul.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":cl.delete(e.pointerId)}}function Aa(t,e,n,i,r,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},e!==null&&(e=Bl(e),e!==null&&vp(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function lS(t,e,n,i,r){switch(e){case"focusin":return tr=Aa(tr,t,e,n,i,r),!0;case"dragenter":return nr=Aa(nr,t,e,n,i,r),!0;case"mouseover":return ir=Aa(ir,t,e,n,i,r),!0;case"pointerover":var o=r.pointerId;return ul.set(o,Aa(ul.get(o)||null,t,e,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,cl.set(o,Aa(cl.get(o)||null,t,e,n,i,r)),!0}return!1}function K0(t){var e=Br(t.target);if(e!==null){var n=ro(e);if(n!==null){if(e=n.tag,e===13){if(e=V0(n),e!==null){t.blockedOn=e,$0(t.priority,function(){G0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function sc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=jh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);Kh=i,n.target.dispatchEvent(i),Kh=null}else return e=Bl(n),e!==null&&vp(e),t.blockedOn=n,!1;e.shift()}return!0}function Lg(t,e,n){sc(t)&&n.delete(e)}function uS(){Xh=!1,tr!==null&&sc(tr)&&(tr=null),nr!==null&&sc(nr)&&(nr=null),ir!==null&&sc(ir)&&(ir=null),ul.forEach(Lg),cl.forEach(Lg)}function Pa(t,e){t.blockedOn===e&&(t.blockedOn=null,Xh||(Xh=!0,hn.unstable_scheduleCallback(hn.unstable_NormalPriority,uS)))}function dl(t){function e(r){return Pa(r,t)}if(0<Bu.length){Pa(Bu[0],t);for(var n=1;n<Bu.length;n++){var i=Bu[n];i.blockedOn===t&&(i.blockedOn=null)}}for(tr!==null&&Pa(tr,t),nr!==null&&Pa(nr,t),ir!==null&&Pa(ir,t),ul.forEach(e),cl.forEach(e),n=0;n<Yi.length;n++)i=Yi[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<Yi.length&&(n=Yi[0],n.blockedOn===null);)K0(n),n.blockedOn===null&&Yi.shift()}var as=Mi.ReactCurrentBatchConfig,Pc=!0;function cS(t,e,n,i){var r=Be,o=as.transition;as.transition=null;try{Be=1,Tp(t,e,n,i)}finally{Be=r,as.transition=o}}function dS(t,e,n,i){var r=Be,o=as.transition;as.transition=null;try{Be=4,Tp(t,e,n,i)}finally{Be=r,as.transition=o}}function Tp(t,e,n,i){if(Pc){var r=jh(t,e,n,i);if(r===null)fh(t,e,i,Rc,n),Mg(t,i);else if(lS(r,t,e,n,i))i.stopPropagation();else if(Mg(t,i),e&4&&-1<aS.indexOf(t)){for(;r!==null;){var o=Bl(r);if(o!==null&&H0(o),o=jh(t,e,n,i),o===null&&fh(t,e,i,Rc,n),o===r)break;r=o}r!==null&&i.stopPropagation()}else fh(t,e,i,null,n)}}var Rc=null;function jh(t,e,n,i){if(Rc=null,t=gp(i),t=Br(t),t!==null)if(e=ro(t),e===null)t=null;else if(n=e.tag,n===13){if(t=V0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Rc=t,null}function J0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XI()){case _p:return 1;case O0:return 4;case xc:case jI:return 16;case B0:return 536870912;default:return 16}default:return 16}}var Xi=null,Ep=null,ac=null;function Z0(){if(ac)return ac;var t,e=Ep,n=e.length,i,r="value"in Xi?Xi.value:Xi.textContent,o=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(i=1;i<=a&&e[n-i]===r[o-i];i++);return ac=r.slice(t,1<i?1-i:void 0)}function lc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function zu(){return!0}function Dg(){return!1}function pn(t){function e(n,i,r,o,a){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(o):o[u]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?zu:Dg,this.isPropagationStopped=Dg,this}return rt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zu)},persist:function(){},isPersistent:zu}),e}var ks={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wp=pn(ks),Ol=rt({},ks,{view:0,detail:0}),hS=pn(Ol),rh,oh,Ra,ud=rt({},Ol,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ra&&(Ra&&t.type==="mousemove"?(rh=t.screenX-Ra.screenX,oh=t.screenY-Ra.screenY):oh=rh=0,Ra=t),rh)},movementY:function(t){return"movementY"in t?t.movementY:oh}}),Vg=pn(ud),fS=rt({},ud,{dataTransfer:0}),pS=pn(fS),mS=rt({},Ol,{relatedTarget:0}),sh=pn(mS),gS=rt({},ks,{animationName:0,elapsedTime:0,pseudoElement:0}),_S=pn(gS),yS=rt({},ks,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),vS=pn(yS),TS=rt({},ks,{data:0}),bg=pn(TS),ES={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function IS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=CS[t])?!!e[t]:!1}function Cp(){return IS}var SS=rt({},Ol,{key:function(t){if(t.key){var e=ES[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=lc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?wS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cp,charCode:function(t){return t.type==="keypress"?lc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?lc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),xS=pn(SS),AS=rt({},ud,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fg=pn(AS),PS=rt({},Ol,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cp}),RS=pn(PS),NS=rt({},ks,{propertyName:0,elapsedTime:0,pseudoElement:0}),kS=pn(NS),MS=rt({},ud,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),LS=pn(MS),DS=[9,13,27,32],Ip=Ii&&"CompositionEvent"in window,Ka=null;Ii&&"documentMode"in document&&(Ka=document.documentMode);var VS=Ii&&"TextEvent"in window&&!Ka,Y0=Ii&&(!Ip||Ka&&8<Ka&&11>=Ka),Ug=" ",Og=!1;function Q0(t,e){switch(t){case"keyup":return DS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function X0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ko=!1;function bS(t,e){switch(t){case"compositionend":return X0(e);case"keypress":return e.which!==32?null:(Og=!0,Ug);case"textInput":return t=e.data,t===Ug&&Og?null:t;default:return null}}function FS(t,e){if(Ko)return t==="compositionend"||!Ip&&Q0(t,e)?(t=Z0(),ac=Ep=Xi=null,Ko=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Y0&&e.locale!=="ko"?null:e.data;default:return null}}var US={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!US[t.type]:e==="textarea"}function j0(t,e,n,i){N0(i),e=Nc(e,"onChange"),0<e.length&&(n=new wp("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Ja=null,hl=null;function OS(t){cT(t,0)}function cd(t){var e=Yo(t);if(C0(e))return t}function BS(t,e){if(t==="change")return e}var eT=!1;if(Ii){var ah;if(Ii){var lh="oninput"in document;if(!lh){var zg=document.createElement("div");zg.setAttribute("oninput","return;"),lh=typeof zg.oninput=="function"}ah=lh}else ah=!1;eT=ah&&(!document.documentMode||9<document.documentMode)}function qg(){Ja&&(Ja.detachEvent("onpropertychange",tT),hl=Ja=null)}function tT(t){if(t.propertyName==="value"&&cd(hl)){var e=[];j0(e,hl,t,gp(t)),D0(OS,e)}}function zS(t,e,n){t==="focusin"?(qg(),Ja=e,hl=n,Ja.attachEvent("onpropertychange",tT)):t==="focusout"&&qg()}function qS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return cd(hl)}function HS(t,e){if(t==="click")return cd(e)}function GS(t,e){if(t==="input"||t==="change")return cd(e)}function WS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Hn=typeof Object.is=="function"?Object.is:WS;function fl(t,e){if(Hn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!Vh.call(e,r)||!Hn(t[r],e[r]))return!1}return!0}function Hg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Gg(t,e){var n=Hg(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Hg(n)}}function nT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?nT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function iT(){for(var t=window,e=Cc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Cc(t.document)}return e}function Sp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function $S(t){var e=iT(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&nT(n.ownerDocument.documentElement,n)){if(i!==null&&Sp(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,o=Math.min(i.start,r);i=i.end===void 0?o:Math.min(i.end,r),!t.extend&&o>i&&(r=i,i=o,o=r),r=Gg(n,o);var a=Gg(n,i);r&&a&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),o>i?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var KS=Ii&&"documentMode"in document&&11>=document.documentMode,Jo=null,ef=null,Za=null,tf=!1;function Wg(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;tf||Jo==null||Jo!==Cc(i)||(i=Jo,"selectionStart"in i&&Sp(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Za&&fl(Za,i)||(Za=i,i=Nc(ef,"onSelect"),0<i.length&&(e=new wp("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Jo)))}function qu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Zo={animationend:qu("Animation","AnimationEnd"),animationiteration:qu("Animation","AnimationIteration"),animationstart:qu("Animation","AnimationStart"),transitionend:qu("Transition","TransitionEnd")},uh={},rT={};Ii&&(rT=document.createElement("div").style,"AnimationEvent"in window||(delete Zo.animationend.animation,delete Zo.animationiteration.animation,delete Zo.animationstart.animation),"TransitionEvent"in window||delete Zo.transitionend.transition);function dd(t){if(uh[t])return uh[t];if(!Zo[t])return t;var e=Zo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in rT)return uh[t]=e[n];return t}var oT=dd("animationend"),sT=dd("animationiteration"),aT=dd("animationstart"),lT=dd("transitionend"),uT=new Map,$g="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _r(t,e){uT.set(t,e),io(e,[t])}for(var ch=0;ch<$g.length;ch++){var dh=$g[ch],JS=dh.toLowerCase(),ZS=dh[0].toUpperCase()+dh.slice(1);_r(JS,"on"+ZS)}_r(oT,"onAnimationEnd");_r(sT,"onAnimationIteration");_r(aT,"onAnimationStart");_r("dblclick","onDoubleClick");_r("focusin","onFocus");_r("focusout","onBlur");_r(lT,"onTransitionEnd");gs("onMouseEnter",["mouseout","mouseover"]);gs("onMouseLeave",["mouseout","mouseover"]);gs("onPointerEnter",["pointerout","pointerover"]);gs("onPointerLeave",["pointerout","pointerover"]);io("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));io("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));io("onBeforeInput",["compositionend","keypress","textInput","paste"]);io("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));io("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));io("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ba="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),YS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ba));function Kg(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,JI(i,e,void 0,t),t.currentTarget=null}function cT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var o=void 0;if(e)for(var a=i.length-1;0<=a;a--){var u=i[a],d=u.instance,p=u.currentTarget;if(u=u.listener,d!==o&&r.isPropagationStopped())break e;Kg(r,u,p),o=d}else for(a=0;a<i.length;a++){if(u=i[a],d=u.instance,p=u.currentTarget,u=u.listener,d!==o&&r.isPropagationStopped())break e;Kg(r,u,p),o=d}}}if(Sc)throw t=Yh,Sc=!1,Yh=null,t}function Ke(t,e){var n=e[af];n===void 0&&(n=e[af]=new Set);var i=t+"__bubble";n.has(i)||(dT(e,t,2,!1),n.add(i))}function hh(t,e,n){var i=0;e&&(i|=4),dT(n,t,i,e)}var Hu="_reactListening"+Math.random().toString(36).slice(2);function pl(t){if(!t[Hu]){t[Hu]=!0,y0.forEach(function(n){n!=="selectionchange"&&(YS.has(n)||hh(n,!1,t),hh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Hu]||(e[Hu]=!0,hh("selectionchange",!1,e))}}function dT(t,e,n,i){switch(J0(e)){case 1:var r=cS;break;case 4:r=dS;break;default:r=Tp}n=r.bind(null,e,n,t),r=void 0,!Zh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function fh(t,e,n,i,r){var o=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var u=i.stateNode.containerInfo;if(u===r||u.nodeType===8&&u.parentNode===r)break;if(a===4)for(a=i.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===r||d.nodeType===8&&d.parentNode===r))return;a=a.return}for(;u!==null;){if(a=Br(u),a===null)return;if(d=a.tag,d===5||d===6){i=o=a;continue e}u=u.parentNode}}i=i.return}D0(function(){var p=o,g=gp(n),y=[];e:{var T=uT.get(t);if(T!==void 0){var I=wp,V=t;switch(t){case"keypress":if(lc(n)===0)break e;case"keydown":case"keyup":I=xS;break;case"focusin":V="focus",I=sh;break;case"focusout":V="blur",I=sh;break;case"beforeblur":case"afterblur":I=sh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=Vg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=pS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=RS;break;case oT:case sT:case aT:I=_S;break;case lT:I=kS;break;case"scroll":I=hS;break;case"wheel":I=LS;break;case"copy":case"cut":case"paste":I=vS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=Fg}var b=(e&4)!==0,q=!b&&t==="scroll",A=b?T!==null?T+"Capture":null:T;b=[];for(var x=p,R;x!==null;){R=x;var z=R.stateNode;if(R.tag===5&&z!==null&&(R=z,A!==null&&(z=ll(x,A),z!=null&&b.push(ml(x,z,R)))),q)break;x=x.return}0<b.length&&(T=new I(T,V,null,n,g),y.push({event:T,listeners:b}))}}if(!(e&7)){e:{if(T=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",T&&n!==Kh&&(V=n.relatedTarget||n.fromElement)&&(Br(V)||V[Si]))break e;if((I||T)&&(T=g.window===g?g:(T=g.ownerDocument)?T.defaultView||T.parentWindow:window,I?(V=n.relatedTarget||n.toElement,I=p,V=V?Br(V):null,V!==null&&(q=ro(V),V!==q||V.tag!==5&&V.tag!==6)&&(V=null)):(I=null,V=p),I!==V)){if(b=Vg,z="onMouseLeave",A="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(b=Fg,z="onPointerLeave",A="onPointerEnter",x="pointer"),q=I==null?T:Yo(I),R=V==null?T:Yo(V),T=new b(z,x+"leave",I,n,g),T.target=q,T.relatedTarget=R,z=null,Br(g)===p&&(b=new b(A,x+"enter",V,n,g),b.target=R,b.relatedTarget=q,z=b),q=z,I&&V)t:{for(b=I,A=V,x=0,R=b;R;R=zo(R))x++;for(R=0,z=A;z;z=zo(z))R++;for(;0<x-R;)b=zo(b),x--;for(;0<R-x;)A=zo(A),R--;for(;x--;){if(b===A||A!==null&&b===A.alternate)break t;b=zo(b),A=zo(A)}b=null}else b=null;I!==null&&Jg(y,T,I,b,!1),V!==null&&q!==null&&Jg(y,q,V,b,!0)}}e:{if(T=p?Yo(p):window,I=T.nodeName&&T.nodeName.toLowerCase(),I==="select"||I==="input"&&T.type==="file")var W=BS;else if(Bg(T))if(eT)W=GS;else{W=qS;var J=zS}else(I=T.nodeName)&&I.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(W=HS);if(W&&(W=W(t,p))){j0(y,W,n,g);break e}J&&J(t,T,p),t==="focusout"&&(J=T._wrapperState)&&J.controlled&&T.type==="number"&&qh(T,"number",T.value)}switch(J=p?Yo(p):window,t){case"focusin":(Bg(J)||J.contentEditable==="true")&&(Jo=J,ef=p,Za=null);break;case"focusout":Za=ef=Jo=null;break;case"mousedown":tf=!0;break;case"contextmenu":case"mouseup":case"dragend":tf=!1,Wg(y,n,g);break;case"selectionchange":if(KS)break;case"keydown":case"keyup":Wg(y,n,g)}var k;if(Ip)e:{switch(t){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Ko?Q0(t,n)&&(N="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(Y0&&n.locale!=="ko"&&(Ko||N!=="onCompositionStart"?N==="onCompositionEnd"&&Ko&&(k=Z0()):(Xi=g,Ep="value"in Xi?Xi.value:Xi.textContent,Ko=!0)),J=Nc(p,N),0<J.length&&(N=new bg(N,t,null,n,g),y.push({event:N,listeners:J}),k?N.data=k:(k=X0(n),k!==null&&(N.data=k)))),(k=VS?bS(t,n):FS(t,n))&&(p=Nc(p,"onBeforeInput"),0<p.length&&(g=new bg("onBeforeInput","beforeinput",null,n,g),y.push({event:g,listeners:p}),g.data=k))}cT(y,e)})}function ml(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Nc(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,o=r.stateNode;r.tag===5&&o!==null&&(r=o,o=ll(t,n),o!=null&&i.unshift(ml(t,o,r)),o=ll(t,e),o!=null&&i.push(ml(t,o,r))),t=t.return}return i}function zo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Jg(t,e,n,i,r){for(var o=e._reactName,a=[];n!==null&&n!==i;){var u=n,d=u.alternate,p=u.stateNode;if(d!==null&&d===i)break;u.tag===5&&p!==null&&(u=p,r?(d=ll(n,o),d!=null&&a.unshift(ml(n,d,u))):r||(d=ll(n,o),d!=null&&a.push(ml(n,d,u)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var QS=/\r\n?/g,XS=/\u0000|\uFFFD/g;function Zg(t){return(typeof t=="string"?t:""+t).replace(QS,`
`).replace(XS,"")}function Gu(t,e,n){if(e=Zg(e),Zg(t)!==e&&n)throw Error(j(425))}function kc(){}var nf=null,rf=null;function of(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var sf=typeof setTimeout=="function"?setTimeout:void 0,jS=typeof clearTimeout=="function"?clearTimeout:void 0,Yg=typeof Promise=="function"?Promise:void 0,ex=typeof queueMicrotask=="function"?queueMicrotask:typeof Yg<"u"?function(t){return Yg.resolve(null).then(t).catch(tx)}:sf;function tx(t){setTimeout(function(){throw t})}function ph(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),dl(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);dl(e)}function rr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Qg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ms=Math.random().toString(36).slice(2),jn="__reactFiber$"+Ms,gl="__reactProps$"+Ms,Si="__reactContainer$"+Ms,af="__reactEvents$"+Ms,nx="__reactListeners$"+Ms,ix="__reactHandles$"+Ms;function Br(t){var e=t[jn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Si]||n[jn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Qg(t);t!==null;){if(n=t[jn])return n;t=Qg(t)}return e}t=n,n=t.parentNode}return null}function Bl(t){return t=t[jn]||t[Si],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Yo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(j(33))}function hd(t){return t[gl]||null}var lf=[],Qo=-1;function yr(t){return{current:t}}function Ye(t){0>Qo||(t.current=lf[Qo],lf[Qo]=null,Qo--)}function $e(t,e){Qo++,lf[Qo]=t.current,t.current=e}var fr={},qt=yr(fr),en=yr(!1),Zr=fr;function _s(t,e){var n=t.type.contextTypes;if(!n)return fr;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},o;for(o in n)r[o]=e[o];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function tn(t){return t=t.childContextTypes,t!=null}function Mc(){Ye(en),Ye(qt)}function Xg(t,e,n){if(qt.current!==fr)throw Error(j(168));$e(qt,e),$e(en,n)}function hT(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(j(108,zI(t)||"Unknown",r));return rt({},n,i)}function Lc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||fr,Zr=qt.current,$e(qt,t),$e(en,en.current),!0}function jg(t,e,n){var i=t.stateNode;if(!i)throw Error(j(169));n?(t=hT(t,e,Zr),i.__reactInternalMemoizedMergedChildContext=t,Ye(en),Ye(qt),$e(qt,t)):Ye(en),$e(en,n)}var Ti=null,fd=!1,mh=!1;function fT(t){Ti===null?Ti=[t]:Ti.push(t)}function rx(t){fd=!0,fT(t)}function vr(){if(!mh&&Ti!==null){mh=!0;var t=0,e=Be;try{var n=Ti;for(Be=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Ti=null,fd=!1}catch(r){throw Ti!==null&&(Ti=Ti.slice(t+1)),U0(_p,vr),r}finally{Be=e,mh=!1}}return null}var Xo=[],jo=0,Dc=null,Vc=0,In=[],Sn=0,Yr=null,Ei=1,wi="";function Fr(t,e){Xo[jo++]=Vc,Xo[jo++]=Dc,Dc=t,Vc=e}function pT(t,e,n){In[Sn++]=Ei,In[Sn++]=wi,In[Sn++]=Yr,Yr=t;var i=Ei;t=wi;var r=32-zn(i)-1;i&=~(1<<r),n+=1;var o=32-zn(e)+r;if(30<o){var a=r-r%5;o=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Ei=1<<32-zn(e)+r|n<<r|i,wi=o+t}else Ei=1<<o|n<<r|i,wi=t}function xp(t){t.return!==null&&(Fr(t,1),pT(t,1,0))}function Ap(t){for(;t===Dc;)Dc=Xo[--jo],Xo[jo]=null,Vc=Xo[--jo],Xo[jo]=null;for(;t===Yr;)Yr=In[--Sn],In[Sn]=null,wi=In[--Sn],In[Sn]=null,Ei=In[--Sn],In[Sn]=null}var dn=null,un=null,je=!1,On=null;function mT(t,e){var n=xn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function e_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,dn=t,un=rr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,dn=t,un=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Yr!==null?{id:Ei,overflow:wi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=xn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,dn=t,un=null,!0):!1;default:return!1}}function uf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cf(t){if(je){var e=un;if(e){var n=e;if(!e_(t,e)){if(uf(t))throw Error(j(418));e=rr(n.nextSibling);var i=dn;e&&e_(t,e)?mT(i,n):(t.flags=t.flags&-4097|2,je=!1,dn=t)}}else{if(uf(t))throw Error(j(418));t.flags=t.flags&-4097|2,je=!1,dn=t}}}function t_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;dn=t}function Wu(t){if(t!==dn)return!1;if(!je)return t_(t),je=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!of(t.type,t.memoizedProps)),e&&(e=un)){if(uf(t))throw gT(),Error(j(418));for(;e;)mT(t,e),e=rr(e.nextSibling)}if(t_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(j(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){un=rr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}un=null}}else un=dn?rr(t.stateNode.nextSibling):null;return!0}function gT(){for(var t=un;t;)t=rr(t.nextSibling)}function ys(){un=dn=null,je=!1}function Pp(t){On===null?On=[t]:On.push(t)}var ox=Mi.ReactCurrentBatchConfig;function Na(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(j(309));var i=n.stateNode}if(!i)throw Error(j(147,t));var r=i,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var u=r.refs;a===null?delete u[o]:u[o]=a},e._stringRef=o,e)}if(typeof t!="string")throw Error(j(284));if(!n._owner)throw Error(j(290,t))}return t}function $u(t,e){throw t=Object.prototype.toString.call(e),Error(j(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function n_(t){var e=t._init;return e(t._payload)}function _T(t){function e(A,x){if(t){var R=A.deletions;R===null?(A.deletions=[x],A.flags|=16):R.push(x)}}function n(A,x){if(!t)return null;for(;x!==null;)e(A,x),x=x.sibling;return null}function i(A,x){for(A=new Map;x!==null;)x.key!==null?A.set(x.key,x):A.set(x.index,x),x=x.sibling;return A}function r(A,x){return A=lr(A,x),A.index=0,A.sibling=null,A}function o(A,x,R){return A.index=R,t?(R=A.alternate,R!==null?(R=R.index,R<x?(A.flags|=2,x):R):(A.flags|=2,x)):(A.flags|=1048576,x)}function a(A){return t&&A.alternate===null&&(A.flags|=2),A}function u(A,x,R,z){return x===null||x.tag!==6?(x=wh(R,A.mode,z),x.return=A,x):(x=r(x,R),x.return=A,x)}function d(A,x,R,z){var W=R.type;return W===$o?g(A,x,R.props.children,z,R.key):x!==null&&(x.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===Ki&&n_(W)===x.type)?(z=r(x,R.props),z.ref=Na(A,x,R),z.return=A,z):(z=mc(R.type,R.key,R.props,null,A.mode,z),z.ref=Na(A,x,R),z.return=A,z)}function p(A,x,R,z){return x===null||x.tag!==4||x.stateNode.containerInfo!==R.containerInfo||x.stateNode.implementation!==R.implementation?(x=Ch(R,A.mode,z),x.return=A,x):(x=r(x,R.children||[]),x.return=A,x)}function g(A,x,R,z,W){return x===null||x.tag!==7?(x=Wr(R,A.mode,z,W),x.return=A,x):(x=r(x,R),x.return=A,x)}function y(A,x,R){if(typeof x=="string"&&x!==""||typeof x=="number")return x=wh(""+x,A.mode,R),x.return=A,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Vu:return R=mc(x.type,x.key,x.props,null,A.mode,R),R.ref=Na(A,null,x),R.return=A,R;case Wo:return x=Ch(x,A.mode,R),x.return=A,x;case Ki:var z=x._init;return y(A,z(x._payload),R)}if(Ua(x)||Sa(x))return x=Wr(x,A.mode,R,null),x.return=A,x;$u(A,x)}return null}function T(A,x,R,z){var W=x!==null?x.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return W!==null?null:u(A,x,""+R,z);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Vu:return R.key===W?d(A,x,R,z):null;case Wo:return R.key===W?p(A,x,R,z):null;case Ki:return W=R._init,T(A,x,W(R._payload),z)}if(Ua(R)||Sa(R))return W!==null?null:g(A,x,R,z,null);$u(A,R)}return null}function I(A,x,R,z,W){if(typeof z=="string"&&z!==""||typeof z=="number")return A=A.get(R)||null,u(x,A,""+z,W);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case Vu:return A=A.get(z.key===null?R:z.key)||null,d(x,A,z,W);case Wo:return A=A.get(z.key===null?R:z.key)||null,p(x,A,z,W);case Ki:var J=z._init;return I(A,x,R,J(z._payload),W)}if(Ua(z)||Sa(z))return A=A.get(R)||null,g(x,A,z,W,null);$u(x,z)}return null}function V(A,x,R,z){for(var W=null,J=null,k=x,N=x=0,D=null;k!==null&&N<R.length;N++){k.index>N?(D=k,k=null):D=k.sibling;var F=T(A,k,R[N],z);if(F===null){k===null&&(k=D);break}t&&k&&F.alternate===null&&e(A,k),x=o(F,x,N),J===null?W=F:J.sibling=F,J=F,k=D}if(N===R.length)return n(A,k),je&&Fr(A,N),W;if(k===null){for(;N<R.length;N++)k=y(A,R[N],z),k!==null&&(x=o(k,x,N),J===null?W=k:J.sibling=k,J=k);return je&&Fr(A,N),W}for(k=i(A,k);N<R.length;N++)D=I(k,A,N,R[N],z),D!==null&&(t&&D.alternate!==null&&k.delete(D.key===null?N:D.key),x=o(D,x,N),J===null?W=D:J.sibling=D,J=D);return t&&k.forEach(function(B){return e(A,B)}),je&&Fr(A,N),W}function b(A,x,R,z){var W=Sa(R);if(typeof W!="function")throw Error(j(150));if(R=W.call(R),R==null)throw Error(j(151));for(var J=W=null,k=x,N=x=0,D=null,F=R.next();k!==null&&!F.done;N++,F=R.next()){k.index>N?(D=k,k=null):D=k.sibling;var B=T(A,k,F.value,z);if(B===null){k===null&&(k=D);break}t&&k&&B.alternate===null&&e(A,k),x=o(B,x,N),J===null?W=B:J.sibling=B,J=B,k=D}if(F.done)return n(A,k),je&&Fr(A,N),W;if(k===null){for(;!F.done;N++,F=R.next())F=y(A,F.value,z),F!==null&&(x=o(F,x,N),J===null?W=F:J.sibling=F,J=F);return je&&Fr(A,N),W}for(k=i(A,k);!F.done;N++,F=R.next())F=I(k,A,N,F.value,z),F!==null&&(t&&F.alternate!==null&&k.delete(F.key===null?N:F.key),x=o(F,x,N),J===null?W=F:J.sibling=F,J=F);return t&&k.forEach(function(U){return e(A,U)}),je&&Fr(A,N),W}function q(A,x,R,z){if(typeof R=="object"&&R!==null&&R.type===$o&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case Vu:e:{for(var W=R.key,J=x;J!==null;){if(J.key===W){if(W=R.type,W===$o){if(J.tag===7){n(A,J.sibling),x=r(J,R.props.children),x.return=A,A=x;break e}}else if(J.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===Ki&&n_(W)===J.type){n(A,J.sibling),x=r(J,R.props),x.ref=Na(A,J,R),x.return=A,A=x;break e}n(A,J);break}else e(A,J);J=J.sibling}R.type===$o?(x=Wr(R.props.children,A.mode,z,R.key),x.return=A,A=x):(z=mc(R.type,R.key,R.props,null,A.mode,z),z.ref=Na(A,x,R),z.return=A,A=z)}return a(A);case Wo:e:{for(J=R.key;x!==null;){if(x.key===J)if(x.tag===4&&x.stateNode.containerInfo===R.containerInfo&&x.stateNode.implementation===R.implementation){n(A,x.sibling),x=r(x,R.children||[]),x.return=A,A=x;break e}else{n(A,x);break}else e(A,x);x=x.sibling}x=Ch(R,A.mode,z),x.return=A,A=x}return a(A);case Ki:return J=R._init,q(A,x,J(R._payload),z)}if(Ua(R))return V(A,x,R,z);if(Sa(R))return b(A,x,R,z);$u(A,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,x!==null&&x.tag===6?(n(A,x.sibling),x=r(x,R),x.return=A,A=x):(n(A,x),x=wh(R,A.mode,z),x.return=A,A=x),a(A)):n(A,x)}return q}var vs=_T(!0),yT=_T(!1),bc=yr(null),Fc=null,es=null,Rp=null;function Np(){Rp=es=Fc=null}function kp(t){var e=bc.current;Ye(bc),t._currentValue=e}function df(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function ls(t,e){Fc=t,Rp=es=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(jt=!0),t.firstContext=null)}function Rn(t){var e=t._currentValue;if(Rp!==t)if(t={context:t,memoizedValue:e,next:null},es===null){if(Fc===null)throw Error(j(308));es=t,Fc.dependencies={lanes:0,firstContext:t}}else es=es.next=t;return e}var zr=null;function Mp(t){zr===null?zr=[t]:zr.push(t)}function vT(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,Mp(e)):(n.next=r.next,r.next=n),e.interleaved=n,xi(t,i)}function xi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ji=!1;function Lp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function TT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ci(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function or(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Le&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,xi(t,n)}return r=i.interleaved,r===null?(e.next=e,Mp(i)):(e.next=r.next,r.next=e),i.interleaved=e,xi(t,n)}function uc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,yp(t,n)}}function i_(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?r=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?r=o=e:o=o.next=e}else r=o=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Uc(t,e,n,i){var r=t.updateQueue;Ji=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,u=r.shared.pending;if(u!==null){r.shared.pending=null;var d=u,p=d.next;d.next=null,a===null?o=p:a.next=p,a=d;var g=t.alternate;g!==null&&(g=g.updateQueue,u=g.lastBaseUpdate,u!==a&&(u===null?g.firstBaseUpdate=p:u.next=p,g.lastBaseUpdate=d))}if(o!==null){var y=r.baseState;a=0,g=p=d=null,u=o;do{var T=u.lane,I=u.eventTime;if((i&T)===T){g!==null&&(g=g.next={eventTime:I,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var V=t,b=u;switch(T=e,I=n,b.tag){case 1:if(V=b.payload,typeof V=="function"){y=V.call(I,y,T);break e}y=V;break e;case 3:V.flags=V.flags&-65537|128;case 0:if(V=b.payload,T=typeof V=="function"?V.call(I,y,T):V,T==null)break e;y=rt({},y,T);break e;case 2:Ji=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,T=r.effects,T===null?r.effects=[u]:T.push(u))}else I={eventTime:I,lane:T,tag:u.tag,payload:u.payload,callback:u.callback,next:null},g===null?(p=g=I,d=y):g=g.next=I,a|=T;if(u=u.next,u===null){if(u=r.shared.pending,u===null)break;T=u,u=T.next,T.next=null,r.lastBaseUpdate=T,r.shared.pending=null}}while(!0);if(g===null&&(d=y),r.baseState=d,r.firstBaseUpdate=p,r.lastBaseUpdate=g,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else o===null&&(r.shared.lanes=0);Xr|=a,t.lanes=a,t.memoizedState=y}}function r_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(j(191,r));r.call(i)}}}var zl={},ti=yr(zl),_l=yr(zl),yl=yr(zl);function qr(t){if(t===zl)throw Error(j(174));return t}function Dp(t,e){switch($e(yl,e),$e(_l,t),$e(ti,zl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Gh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Gh(e,t)}Ye(ti),$e(ti,e)}function Ts(){Ye(ti),Ye(_l),Ye(yl)}function ET(t){qr(yl.current);var e=qr(ti.current),n=Gh(e,t.type);e!==n&&($e(_l,t),$e(ti,n))}function Vp(t){_l.current===t&&(Ye(ti),Ye(_l))}var nt=yr(0);function Oc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var gh=[];function bp(){for(var t=0;t<gh.length;t++)gh[t]._workInProgressVersionPrimary=null;gh.length=0}var cc=Mi.ReactCurrentDispatcher,_h=Mi.ReactCurrentBatchConfig,Qr=0,it=null,yt=null,St=null,Bc=!1,Ya=!1,vl=0,sx=0;function Vt(){throw Error(j(321))}function Fp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Hn(t[n],e[n]))return!1;return!0}function Up(t,e,n,i,r,o){if(Qr=o,it=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,cc.current=t===null||t.memoizedState===null?cx:dx,t=n(i,r),Ya){o=0;do{if(Ya=!1,vl=0,25<=o)throw Error(j(301));o+=1,St=yt=null,e.updateQueue=null,cc.current=hx,t=n(i,r)}while(Ya)}if(cc.current=zc,e=yt!==null&&yt.next!==null,Qr=0,St=yt=it=null,Bc=!1,e)throw Error(j(300));return t}function Op(){var t=vl!==0;return vl=0,t}function Xn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return St===null?it.memoizedState=St=t:St=St.next=t,St}function Nn(){if(yt===null){var t=it.alternate;t=t!==null?t.memoizedState:null}else t=yt.next;var e=St===null?it.memoizedState:St.next;if(e!==null)St=e,yt=t;else{if(t===null)throw Error(j(310));yt=t,t={memoizedState:yt.memoizedState,baseState:yt.baseState,baseQueue:yt.baseQueue,queue:yt.queue,next:null},St===null?it.memoizedState=St=t:St=St.next=t}return St}function Tl(t,e){return typeof e=="function"?e(t):e}function yh(t){var e=Nn(),n=e.queue;if(n===null)throw Error(j(311));n.lastRenderedReducer=t;var i=yt,r=i.baseQueue,o=n.pending;if(o!==null){if(r!==null){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(r!==null){o=r.next,i=i.baseState;var u=a=null,d=null,p=o;do{var g=p.lane;if((Qr&g)===g)d!==null&&(d=d.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),i=p.hasEagerState?p.eagerState:t(i,p.action);else{var y={lane:g,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};d===null?(u=d=y,a=i):d=d.next=y,it.lanes|=g,Xr|=g}p=p.next}while(p!==null&&p!==o);d===null?a=i:d.next=u,Hn(i,e.memoizedState)||(jt=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=d,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do o=r.lane,it.lanes|=o,Xr|=o,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function vh(t){var e=Nn(),n=e.queue;if(n===null)throw Error(j(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,o=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do o=t(o,a.action),a=a.next;while(a!==r);Hn(o,e.memoizedState)||(jt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,i]}function wT(){}function CT(t,e){var n=it,i=Nn(),r=e(),o=!Hn(i.memoizedState,r);if(o&&(i.memoizedState=r,jt=!0),i=i.queue,Bp(xT.bind(null,n,i,t),[t]),i.getSnapshot!==e||o||St!==null&&St.memoizedState.tag&1){if(n.flags|=2048,El(9,ST.bind(null,n,i,r,e),void 0,null),xt===null)throw Error(j(349));Qr&30||IT(n,e,r)}return r}function IT(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=it.updateQueue,e===null?(e={lastEffect:null,stores:null},it.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function ST(t,e,n,i){e.value=n,e.getSnapshot=i,AT(e)&&PT(t)}function xT(t,e,n){return n(function(){AT(e)&&PT(t)})}function AT(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Hn(t,n)}catch{return!0}}function PT(t){var e=xi(t,1);e!==null&&qn(e,t,1,-1)}function o_(t){var e=Xn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tl,lastRenderedState:t},e.queue=t,t=t.dispatch=ux.bind(null,it,t),[e.memoizedState,t]}function El(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=it.updateQueue,e===null?(e={lastEffect:null,stores:null},it.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function RT(){return Nn().memoizedState}function dc(t,e,n,i){var r=Xn();it.flags|=t,r.memoizedState=El(1|e,n,void 0,i===void 0?null:i)}function pd(t,e,n,i){var r=Nn();i=i===void 0?null:i;var o=void 0;if(yt!==null){var a=yt.memoizedState;if(o=a.destroy,i!==null&&Fp(i,a.deps)){r.memoizedState=El(e,n,o,i);return}}it.flags|=t,r.memoizedState=El(1|e,n,o,i)}function s_(t,e){return dc(8390656,8,t,e)}function Bp(t,e){return pd(2048,8,t,e)}function NT(t,e){return pd(4,2,t,e)}function kT(t,e){return pd(4,4,t,e)}function MT(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function LT(t,e,n){return n=n!=null?n.concat([t]):null,pd(4,4,MT.bind(null,e,t),n)}function zp(){}function DT(t,e){var n=Nn();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&Fp(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function VT(t,e){var n=Nn();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&Fp(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function bT(t,e,n){return Qr&21?(Hn(n,e)||(n=z0(),it.lanes|=n,Xr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,jt=!0),t.memoizedState=n)}function ax(t,e){var n=Be;Be=n!==0&&4>n?n:4,t(!0);var i=_h.transition;_h.transition={};try{t(!1),e()}finally{Be=n,_h.transition=i}}function FT(){return Nn().memoizedState}function lx(t,e,n){var i=ar(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},UT(t))OT(e,n);else if(n=vT(t,e,n,i),n!==null){var r=$t();qn(n,t,i,r),BT(n,e,i)}}function ux(t,e,n){var i=ar(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(UT(t))OT(e,r);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,u=o(a,n);if(r.hasEagerState=!0,r.eagerState=u,Hn(u,a)){var d=e.interleaved;d===null?(r.next=r,Mp(e)):(r.next=d.next,d.next=r),e.interleaved=r;return}}catch{}finally{}n=vT(t,e,r,i),n!==null&&(r=$t(),qn(n,t,i,r),BT(n,e,i))}}function UT(t){var e=t.alternate;return t===it||e!==null&&e===it}function OT(t,e){Ya=Bc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function BT(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,yp(t,n)}}var zc={readContext:Rn,useCallback:Vt,useContext:Vt,useEffect:Vt,useImperativeHandle:Vt,useInsertionEffect:Vt,useLayoutEffect:Vt,useMemo:Vt,useReducer:Vt,useRef:Vt,useState:Vt,useDebugValue:Vt,useDeferredValue:Vt,useTransition:Vt,useMutableSource:Vt,useSyncExternalStore:Vt,useId:Vt,unstable_isNewReconciler:!1},cx={readContext:Rn,useCallback:function(t,e){return Xn().memoizedState=[t,e===void 0?null:e],t},useContext:Rn,useEffect:s_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,dc(4194308,4,MT.bind(null,e,t),n)},useLayoutEffect:function(t,e){return dc(4194308,4,t,e)},useInsertionEffect:function(t,e){return dc(4,2,t,e)},useMemo:function(t,e){var n=Xn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=Xn();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=lx.bind(null,it,t),[i.memoizedState,t]},useRef:function(t){var e=Xn();return t={current:t},e.memoizedState=t},useState:o_,useDebugValue:zp,useDeferredValue:function(t){return Xn().memoizedState=t},useTransition:function(){var t=o_(!1),e=t[0];return t=ax.bind(null,t[1]),Xn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=it,r=Xn();if(je){if(n===void 0)throw Error(j(407));n=n()}else{if(n=e(),xt===null)throw Error(j(349));Qr&30||IT(i,e,n)}r.memoizedState=n;var o={value:n,getSnapshot:e};return r.queue=o,s_(xT.bind(null,i,o,t),[t]),i.flags|=2048,El(9,ST.bind(null,i,o,n,e),void 0,null),n},useId:function(){var t=Xn(),e=xt.identifierPrefix;if(je){var n=wi,i=Ei;n=(i&~(1<<32-zn(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=vl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=sx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},dx={readContext:Rn,useCallback:DT,useContext:Rn,useEffect:Bp,useImperativeHandle:LT,useInsertionEffect:NT,useLayoutEffect:kT,useMemo:VT,useReducer:yh,useRef:RT,useState:function(){return yh(Tl)},useDebugValue:zp,useDeferredValue:function(t){var e=Nn();return bT(e,yt.memoizedState,t)},useTransition:function(){var t=yh(Tl)[0],e=Nn().memoizedState;return[t,e]},useMutableSource:wT,useSyncExternalStore:CT,useId:FT,unstable_isNewReconciler:!1},hx={readContext:Rn,useCallback:DT,useContext:Rn,useEffect:Bp,useImperativeHandle:LT,useInsertionEffect:NT,useLayoutEffect:kT,useMemo:VT,useReducer:vh,useRef:RT,useState:function(){return vh(Tl)},useDebugValue:zp,useDeferredValue:function(t){var e=Nn();return yt===null?e.memoizedState=t:bT(e,yt.memoizedState,t)},useTransition:function(){var t=vh(Tl)[0],e=Nn().memoizedState;return[t,e]},useMutableSource:wT,useSyncExternalStore:CT,useId:FT,unstable_isNewReconciler:!1};function Fn(t,e){if(t&&t.defaultProps){e=rt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function hf(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:rt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var md={isMounted:function(t){return(t=t._reactInternals)?ro(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=$t(),r=ar(t),o=Ci(i,r);o.payload=e,n!=null&&(o.callback=n),e=or(t,o,r),e!==null&&(qn(e,t,r,i),uc(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=$t(),r=ar(t),o=Ci(i,r);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=or(t,o,r),e!==null&&(qn(e,t,r,i),uc(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=$t(),i=ar(t),r=Ci(n,i);r.tag=2,e!=null&&(r.callback=e),e=or(t,r,i),e!==null&&(qn(e,t,i,n),uc(e,t,i))}};function a_(t,e,n,i,r,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,o,a):e.prototype&&e.prototype.isPureReactComponent?!fl(n,i)||!fl(r,o):!0}function zT(t,e,n){var i=!1,r=fr,o=e.contextType;return typeof o=="object"&&o!==null?o=Rn(o):(r=tn(e)?Zr:qt.current,i=e.contextTypes,o=(i=i!=null)?_s(t,r):fr),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=md,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function l_(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&md.enqueueReplaceState(e,e.state,null)}function ff(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},Lp(t);var o=e.contextType;typeof o=="object"&&o!==null?r.context=Rn(o):(o=tn(e)?Zr:qt.current,r.context=_s(t,o)),r.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(hf(t,e,o,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&md.enqueueReplaceState(r,r.state,null),Uc(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Es(t,e){try{var n="",i=e;do n+=BI(i),i=i.return;while(i);var r=n}catch(o){r=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:r,digest:null}}function Th(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function pf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var fx=typeof WeakMap=="function"?WeakMap:Map;function qT(t,e,n){n=Ci(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Hc||(Hc=!0,If=i),pf(t,e)},n}function HT(t,e,n){n=Ci(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){pf(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){pf(t,e),typeof i!="function"&&(sr===null?sr=new Set([this]):sr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function u_(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new fx;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=Ax.bind(null,t,e,n),e.then(t,t))}function c_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function d_(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ci(-1,1),e.tag=2,or(n,e,1))),n.lanes|=1),t)}var px=Mi.ReactCurrentOwner,jt=!1;function Wt(t,e,n,i){e.child=t===null?yT(e,null,n,i):vs(e,t.child,n,i)}function h_(t,e,n,i,r){n=n.render;var o=e.ref;return ls(e,r),i=Up(t,e,n,i,o,r),n=Op(),t!==null&&!jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ai(t,e,r)):(je&&n&&xp(e),e.flags|=1,Wt(t,e,i,r),e.child)}function f_(t,e,n,i,r){if(t===null){var o=n.type;return typeof o=="function"&&!Zp(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,GT(t,e,o,i,r)):(t=mc(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&r)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:fl,n(a,i)&&t.ref===e.ref)return Ai(t,e,r)}return e.flags|=1,t=lr(o,i),t.ref=e.ref,t.return=e,e.child=t}function GT(t,e,n,i,r){if(t!==null){var o=t.memoizedProps;if(fl(o,i)&&t.ref===e.ref)if(jt=!1,e.pendingProps=i=o,(t.lanes&r)!==0)t.flags&131072&&(jt=!0);else return e.lanes=t.lanes,Ai(t,e,r)}return mf(t,e,n,i,r)}function WT(t,e,n){var i=e.pendingProps,r=i.children,o=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},$e(ns,ln),ln|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,$e(ns,ln),ln|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=o!==null?o.baseLanes:n,$e(ns,ln),ln|=i}else o!==null?(i=o.baseLanes|n,e.memoizedState=null):i=n,$e(ns,ln),ln|=i;return Wt(t,e,r,n),e.child}function $T(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function mf(t,e,n,i,r){var o=tn(n)?Zr:qt.current;return o=_s(e,o),ls(e,r),n=Up(t,e,n,i,o,r),i=Op(),t!==null&&!jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ai(t,e,r)):(je&&i&&xp(e),e.flags|=1,Wt(t,e,n,r),e.child)}function p_(t,e,n,i,r){if(tn(n)){var o=!0;Lc(e)}else o=!1;if(ls(e,r),e.stateNode===null)hc(t,e),zT(e,n,i),ff(e,n,i,r),i=!0;else if(t===null){var a=e.stateNode,u=e.memoizedProps;a.props=u;var d=a.context,p=n.contextType;typeof p=="object"&&p!==null?p=Rn(p):(p=tn(n)?Zr:qt.current,p=_s(e,p));var g=n.getDerivedStateFromProps,y=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function";y||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==i||d!==p)&&l_(e,a,i,p),Ji=!1;var T=e.memoizedState;a.state=T,Uc(e,i,a,r),d=e.memoizedState,u!==i||T!==d||en.current||Ji?(typeof g=="function"&&(hf(e,n,g,i),d=e.memoizedState),(u=Ji||a_(e,n,u,i,T,d,p))?(y||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=d),a.props=i,a.state=d,a.context=p,i=u):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,TT(t,e),u=e.memoizedProps,p=e.type===e.elementType?u:Fn(e.type,u),a.props=p,y=e.pendingProps,T=a.context,d=n.contextType,typeof d=="object"&&d!==null?d=Rn(d):(d=tn(n)?Zr:qt.current,d=_s(e,d));var I=n.getDerivedStateFromProps;(g=typeof I=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==y||T!==d)&&l_(e,a,i,d),Ji=!1,T=e.memoizedState,a.state=T,Uc(e,i,a,r);var V=e.memoizedState;u!==y||T!==V||en.current||Ji?(typeof I=="function"&&(hf(e,n,I,i),V=e.memoizedState),(p=Ji||a_(e,n,p,i,T,V,d)||!1)?(g||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,V,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,V,d)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=V),a.props=i,a.state=V,a.context=d,i=p):(typeof a.componentDidUpdate!="function"||u===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),i=!1)}return gf(t,e,n,i,o,r)}function gf(t,e,n,i,r,o){$T(t,e);var a=(e.flags&128)!==0;if(!i&&!a)return r&&jg(e,n,!1),Ai(t,e,o);i=e.stateNode,px.current=e;var u=a&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&a?(e.child=vs(e,t.child,null,o),e.child=vs(e,null,u,o)):Wt(t,e,u,o),e.memoizedState=i.state,r&&jg(e,n,!0),e.child}function KT(t){var e=t.stateNode;e.pendingContext?Xg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Xg(t,e.context,!1),Dp(t,e.containerInfo)}function m_(t,e,n,i,r){return ys(),Pp(r),e.flags|=256,Wt(t,e,n,i),e.child}var _f={dehydrated:null,treeContext:null,retryLane:0};function yf(t){return{baseLanes:t,cachePool:null,transitions:null}}function JT(t,e,n){var i=e.pendingProps,r=nt.current,o=!1,a=(e.flags&128)!==0,u;if((u=a)||(u=t!==null&&t.memoizedState===null?!1:(r&2)!==0),u?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),$e(nt,r&1),t===null)return cf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=i.children,t=i.fallback,o?(i=e.mode,o=e.child,a={mode:"hidden",children:a},!(i&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=yd(a,i,0,null),t=Wr(t,i,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=yf(n),e.memoizedState=_f,t):qp(e,a));if(r=t.memoizedState,r!==null&&(u=r.dehydrated,u!==null))return mx(t,e,a,i,u,r,n);if(o){o=i.fallback,a=e.mode,r=t.child,u=r.sibling;var d={mode:"hidden",children:i.children};return!(a&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=d,e.deletions=null):(i=lr(r,d),i.subtreeFlags=r.subtreeFlags&14680064),u!==null?o=lr(u,o):(o=Wr(o,a,n,null),o.flags|=2),o.return=e,i.return=e,i.sibling=o,e.child=i,i=o,o=e.child,a=t.child.memoizedState,a=a===null?yf(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~n,e.memoizedState=_f,i}return o=t.child,t=o.sibling,i=lr(o,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function qp(t,e){return e=yd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ku(t,e,n,i){return i!==null&&Pp(i),vs(e,t.child,null,n),t=qp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function mx(t,e,n,i,r,o,a){if(n)return e.flags&256?(e.flags&=-257,i=Th(Error(j(422))),Ku(t,e,a,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=i.fallback,r=e.mode,i=yd({mode:"visible",children:i.children},r,0,null),o=Wr(o,r,a,null),o.flags|=2,i.return=e,o.return=e,i.sibling=o,e.child=i,e.mode&1&&vs(e,t.child,null,a),e.child.memoizedState=yf(a),e.memoizedState=_f,o);if(!(e.mode&1))return Ku(t,e,a,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var u=i.dgst;return i=u,o=Error(j(419)),i=Th(o,i,void 0),Ku(t,e,a,i)}if(u=(a&t.childLanes)!==0,jt||u){if(i=xt,i!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|a)?0:r,r!==0&&r!==o.retryLane&&(o.retryLane=r,xi(t,r),qn(i,t,r,-1))}return Jp(),i=Th(Error(j(421))),Ku(t,e,a,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=Px.bind(null,t),r._reactRetry=e,null):(t=o.treeContext,un=rr(r.nextSibling),dn=e,je=!0,On=null,t!==null&&(In[Sn++]=Ei,In[Sn++]=wi,In[Sn++]=Yr,Ei=t.id,wi=t.overflow,Yr=e),e=qp(e,i.children),e.flags|=4096,e)}function g_(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),df(t.return,e,n)}function Eh(t,e,n,i,r){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r)}function ZT(t,e,n){var i=e.pendingProps,r=i.revealOrder,o=i.tail;if(Wt(t,e,i.children,n),i=nt.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&g_(t,n,e);else if(t.tag===19)g_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if($e(nt,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Oc(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Eh(e,!1,r,n,o);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Oc(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Eh(e,!0,n,null,o);break;case"together":Eh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function hc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ai(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Xr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(j(153));if(e.child!==null){for(t=e.child,n=lr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=lr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function gx(t,e,n){switch(e.tag){case 3:KT(e),ys();break;case 5:ET(e);break;case 1:tn(e.type)&&Lc(e);break;case 4:Dp(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;$e(bc,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?($e(nt,nt.current&1),e.flags|=128,null):n&e.child.childLanes?JT(t,e,n):($e(nt,nt.current&1),t=Ai(t,e,n),t!==null?t.sibling:null);$e(nt,nt.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return ZT(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),$e(nt,nt.current),i)break;return null;case 22:case 23:return e.lanes=0,WT(t,e,n)}return Ai(t,e,n)}var YT,vf,QT,XT;YT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};vf=function(){};QT=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,qr(ti.current);var o=null;switch(n){case"input":r=Bh(t,r),i=Bh(t,i),o=[];break;case"select":r=rt({},r,{value:void 0}),i=rt({},i,{value:void 0}),o=[];break;case"textarea":r=Hh(t,r),i=Hh(t,i),o=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=kc)}Wh(n,i);var a;n=null;for(p in r)if(!i.hasOwnProperty(p)&&r.hasOwnProperty(p)&&r[p]!=null)if(p==="style"){var u=r[p];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(sl.hasOwnProperty(p)?o||(o=[]):(o=o||[]).push(p,null));for(p in i){var d=i[p];if(u=r!=null?r[p]:void 0,i.hasOwnProperty(p)&&d!==u&&(d!=null||u!=null))if(p==="style")if(u){for(a in u)!u.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in d)d.hasOwnProperty(a)&&u[a]!==d[a]&&(n||(n={}),n[a]=d[a])}else n||(o||(o=[]),o.push(p,n)),n=d;else p==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,u=u?u.__html:void 0,d!=null&&u!==d&&(o=o||[]).push(p,d)):p==="children"?typeof d!="string"&&typeof d!="number"||(o=o||[]).push(p,""+d):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(sl.hasOwnProperty(p)?(d!=null&&p==="onScroll"&&Ke("scroll",t),o||u===d||(o=[])):(o=o||[]).push(p,d))}n&&(o=o||[]).push("style",n);var p=o;(e.updateQueue=p)&&(e.flags|=4)}};XT=function(t,e,n,i){n!==i&&(e.flags|=4)};function ka(t,e){if(!je)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function _x(t,e,n){var i=e.pendingProps;switch(Ap(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(e),null;case 1:return tn(e.type)&&Mc(),bt(e),null;case 3:return i=e.stateNode,Ts(),Ye(en),Ye(qt),bp(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Wu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,On!==null&&(Af(On),On=null))),vf(t,e),bt(e),null;case 5:Vp(e);var r=qr(yl.current);if(n=e.type,t!==null&&e.stateNode!=null)QT(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(j(166));return bt(e),null}if(t=qr(ti.current),Wu(e)){i=e.stateNode,n=e.type;var o=e.memoizedProps;switch(i[jn]=e,i[gl]=o,t=(e.mode&1)!==0,n){case"dialog":Ke("cancel",i),Ke("close",i);break;case"iframe":case"object":case"embed":Ke("load",i);break;case"video":case"audio":for(r=0;r<Ba.length;r++)Ke(Ba[r],i);break;case"source":Ke("error",i);break;case"img":case"image":case"link":Ke("error",i),Ke("load",i);break;case"details":Ke("toggle",i);break;case"input":Sg(i,o),Ke("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Ke("invalid",i);break;case"textarea":Ag(i,o),Ke("invalid",i)}Wh(n,o),r=null;for(var a in o)if(o.hasOwnProperty(a)){var u=o[a];a==="children"?typeof u=="string"?i.textContent!==u&&(o.suppressHydrationWarning!==!0&&Gu(i.textContent,u,t),r=["children",u]):typeof u=="number"&&i.textContent!==""+u&&(o.suppressHydrationWarning!==!0&&Gu(i.textContent,u,t),r=["children",""+u]):sl.hasOwnProperty(a)&&u!=null&&a==="onScroll"&&Ke("scroll",i)}switch(n){case"input":bu(i),xg(i,o,!0);break;case"textarea":bu(i),Pg(i);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(i.onclick=kc)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=x0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=a.createElement(n,{is:i.is}):(t=a.createElement(n),n==="select"&&(a=t,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):t=a.createElementNS(t,n),t[jn]=e,t[gl]=i,YT(t,e,!1,!1),e.stateNode=t;e:{switch(a=$h(n,i),n){case"dialog":Ke("cancel",t),Ke("close",t),r=i;break;case"iframe":case"object":case"embed":Ke("load",t),r=i;break;case"video":case"audio":for(r=0;r<Ba.length;r++)Ke(Ba[r],t);r=i;break;case"source":Ke("error",t),r=i;break;case"img":case"image":case"link":Ke("error",t),Ke("load",t),r=i;break;case"details":Ke("toggle",t),r=i;break;case"input":Sg(t,i),r=Bh(t,i),Ke("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=rt({},i,{value:void 0}),Ke("invalid",t);break;case"textarea":Ag(t,i),r=Hh(t,i),Ke("invalid",t);break;default:r=i}Wh(n,r),u=r;for(o in u)if(u.hasOwnProperty(o)){var d=u[o];o==="style"?R0(t,d):o==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&A0(t,d)):o==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&al(t,d):typeof d=="number"&&al(t,""+d):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(sl.hasOwnProperty(o)?d!=null&&o==="onScroll"&&Ke("scroll",t):d!=null&&hp(t,o,d,a))}switch(n){case"input":bu(t),xg(t,i,!1);break;case"textarea":bu(t),Pg(t);break;case"option":i.value!=null&&t.setAttribute("value",""+hr(i.value));break;case"select":t.multiple=!!i.multiple,o=i.value,o!=null?rs(t,!!i.multiple,o,!1):i.defaultValue!=null&&rs(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=kc)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bt(e),null;case 6:if(t&&e.stateNode!=null)XT(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(j(166));if(n=qr(yl.current),qr(ti.current),Wu(e)){if(i=e.stateNode,n=e.memoizedProps,i[jn]=e,(o=i.nodeValue!==n)&&(t=dn,t!==null))switch(t.tag){case 3:Gu(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Gu(i.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[jn]=e,e.stateNode=i}return bt(e),null;case 13:if(Ye(nt),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(je&&un!==null&&e.mode&1&&!(e.flags&128))gT(),ys(),e.flags|=98560,o=!1;else if(o=Wu(e),i!==null&&i.dehydrated!==null){if(t===null){if(!o)throw Error(j(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(j(317));o[jn]=e}else ys(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bt(e),o=!1}else On!==null&&(Af(On),On=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||nt.current&1?vt===0&&(vt=3):Jp())),e.updateQueue!==null&&(e.flags|=4),bt(e),null);case 4:return Ts(),vf(t,e),t===null&&pl(e.stateNode.containerInfo),bt(e),null;case 10:return kp(e.type._context),bt(e),null;case 17:return tn(e.type)&&Mc(),bt(e),null;case 19:if(Ye(nt),o=e.memoizedState,o===null)return bt(e),null;if(i=(e.flags&128)!==0,a=o.rendering,a===null)if(i)ka(o,!1);else{if(vt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Oc(t),a!==null){for(e.flags|=128,ka(o,!1),i=a.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)o=n,t=i,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return $e(nt,nt.current&1|2),e.child}t=t.sibling}o.tail!==null&&ct()>ws&&(e.flags|=128,i=!0,ka(o,!1),e.lanes=4194304)}else{if(!i)if(t=Oc(a),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ka(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!je)return bt(e),null}else 2*ct()-o.renderingStartTime>ws&&n!==1073741824&&(e.flags|=128,i=!0,ka(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=ct(),e.sibling=null,n=nt.current,$e(nt,i?n&1|2:n&1),e):(bt(e),null);case 22:case 23:return Kp(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?ln&1073741824&&(bt(e),e.subtreeFlags&6&&(e.flags|=8192)):bt(e),null;case 24:return null;case 25:return null}throw Error(j(156,e.tag))}function yx(t,e){switch(Ap(e),e.tag){case 1:return tn(e.type)&&Mc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ts(),Ye(en),Ye(qt),bp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Vp(e),null;case 13:if(Ye(nt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(j(340));ys()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ye(nt),null;case 4:return Ts(),null;case 10:return kp(e.type._context),null;case 22:case 23:return Kp(),null;case 24:return null;default:return null}}var Ju=!1,Ot=!1,vx=typeof WeakSet=="function"?WeakSet:Set,oe=null;function ts(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){at(t,e,i)}else n.current=null}function Tf(t,e,n){try{n()}catch(i){at(t,e,i)}}var __=!1;function Tx(t,e){if(nf=Pc,t=iT(),Sp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,u=-1,d=-1,p=0,g=0,y=t,T=null;t:for(;;){for(var I;y!==n||r!==0&&y.nodeType!==3||(u=a+r),y!==o||i!==0&&y.nodeType!==3||(d=a+i),y.nodeType===3&&(a+=y.nodeValue.length),(I=y.firstChild)!==null;)T=y,y=I;for(;;){if(y===t)break t;if(T===n&&++p===r&&(u=a),T===o&&++g===i&&(d=a),(I=y.nextSibling)!==null)break;y=T,T=y.parentNode}y=I}n=u===-1||d===-1?null:{start:u,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(rf={focusedElem:t,selectionRange:n},Pc=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var V=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(V!==null){var b=V.memoizedProps,q=V.memoizedState,A=e.stateNode,x=A.getSnapshotBeforeUpdate(e.elementType===e.type?b:Fn(e.type,b),q);A.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var R=e.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(j(163))}}catch(z){at(e,e.return,z)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return V=__,__=!1,V}function Qa(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var o=r.destroy;r.destroy=void 0,o!==void 0&&Tf(e,n,o)}r=r.next}while(r!==i)}}function gd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function Ef(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function jT(t){var e=t.alternate;e!==null&&(t.alternate=null,jT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[jn],delete e[gl],delete e[af],delete e[nx],delete e[ix])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function eE(t){return t.tag===5||t.tag===3||t.tag===4}function y_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||eE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function wf(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=kc));else if(i!==4&&(t=t.child,t!==null))for(wf(t,e,n),t=t.sibling;t!==null;)wf(t,e,n),t=t.sibling}function Cf(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(Cf(t,e,n),t=t.sibling;t!==null;)Cf(t,e,n),t=t.sibling}var Pt=null,Un=!1;function $i(t,e,n){for(n=n.child;n!==null;)tE(t,e,n),n=n.sibling}function tE(t,e,n){if(ei&&typeof ei.onCommitFiberUnmount=="function")try{ei.onCommitFiberUnmount(ld,n)}catch{}switch(n.tag){case 5:Ot||ts(n,e);case 6:var i=Pt,r=Un;Pt=null,$i(t,e,n),Pt=i,Un=r,Pt!==null&&(Un?(t=Pt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Pt.removeChild(n.stateNode));break;case 18:Pt!==null&&(Un?(t=Pt,n=n.stateNode,t.nodeType===8?ph(t.parentNode,n):t.nodeType===1&&ph(t,n),dl(t)):ph(Pt,n.stateNode));break;case 4:i=Pt,r=Un,Pt=n.stateNode.containerInfo,Un=!0,$i(t,e,n),Pt=i,Un=r;break;case 0:case 11:case 14:case 15:if(!Ot&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var o=r,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&Tf(n,e,a),r=r.next}while(r!==i)}$i(t,e,n);break;case 1:if(!Ot&&(ts(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(u){at(n,e,u)}$i(t,e,n);break;case 21:$i(t,e,n);break;case 22:n.mode&1?(Ot=(i=Ot)||n.memoizedState!==null,$i(t,e,n),Ot=i):$i(t,e,n);break;default:$i(t,e,n)}}function v_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new vx),e.forEach(function(i){var r=Rx.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function bn(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var o=t,a=e,u=a;e:for(;u!==null;){switch(u.tag){case 5:Pt=u.stateNode,Un=!1;break e;case 3:Pt=u.stateNode.containerInfo,Un=!0;break e;case 4:Pt=u.stateNode.containerInfo,Un=!0;break e}u=u.return}if(Pt===null)throw Error(j(160));tE(o,a,r),Pt=null,Un=!1;var d=r.alternate;d!==null&&(d.return=null),r.return=null}catch(p){at(r,e,p)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)nE(e,t),e=e.sibling}function nE(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(bn(e,t),Qn(t),i&4){try{Qa(3,t,t.return),gd(3,t)}catch(b){at(t,t.return,b)}try{Qa(5,t,t.return)}catch(b){at(t,t.return,b)}}break;case 1:bn(e,t),Qn(t),i&512&&n!==null&&ts(n,n.return);break;case 5:if(bn(e,t),Qn(t),i&512&&n!==null&&ts(n,n.return),t.flags&32){var r=t.stateNode;try{al(r,"")}catch(b){at(t,t.return,b)}}if(i&4&&(r=t.stateNode,r!=null)){var o=t.memoizedProps,a=n!==null?n.memoizedProps:o,u=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{u==="input"&&o.type==="radio"&&o.name!=null&&I0(r,o),$h(u,a);var p=$h(u,o);for(a=0;a<d.length;a+=2){var g=d[a],y=d[a+1];g==="style"?R0(r,y):g==="dangerouslySetInnerHTML"?A0(r,y):g==="children"?al(r,y):hp(r,g,y,p)}switch(u){case"input":zh(r,o);break;case"textarea":S0(r,o);break;case"select":var T=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var I=o.value;I!=null?rs(r,!!o.multiple,I,!1):T!==!!o.multiple&&(o.defaultValue!=null?rs(r,!!o.multiple,o.defaultValue,!0):rs(r,!!o.multiple,o.multiple?[]:"",!1))}r[gl]=o}catch(b){at(t,t.return,b)}}break;case 6:if(bn(e,t),Qn(t),i&4){if(t.stateNode===null)throw Error(j(162));r=t.stateNode,o=t.memoizedProps;try{r.nodeValue=o}catch(b){at(t,t.return,b)}}break;case 3:if(bn(e,t),Qn(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{dl(e.containerInfo)}catch(b){at(t,t.return,b)}break;case 4:bn(e,t),Qn(t);break;case 13:bn(e,t),Qn(t),r=t.child,r.flags&8192&&(o=r.memoizedState!==null,r.stateNode.isHidden=o,!o||r.alternate!==null&&r.alternate.memoizedState!==null||(Wp=ct())),i&4&&v_(t);break;case 22:if(g=n!==null&&n.memoizedState!==null,t.mode&1?(Ot=(p=Ot)||g,bn(e,t),Ot=p):bn(e,t),Qn(t),i&8192){if(p=t.memoizedState!==null,(t.stateNode.isHidden=p)&&!g&&t.mode&1)for(oe=t,g=t.child;g!==null;){for(y=oe=g;oe!==null;){switch(T=oe,I=T.child,T.tag){case 0:case 11:case 14:case 15:Qa(4,T,T.return);break;case 1:ts(T,T.return);var V=T.stateNode;if(typeof V.componentWillUnmount=="function"){i=T,n=T.return;try{e=i,V.props=e.memoizedProps,V.state=e.memoizedState,V.componentWillUnmount()}catch(b){at(i,n,b)}}break;case 5:ts(T,T.return);break;case 22:if(T.memoizedState!==null){E_(y);continue}}I!==null?(I.return=T,oe=I):E_(y)}g=g.sibling}e:for(g=null,y=t;;){if(y.tag===5){if(g===null){g=y;try{r=y.stateNode,p?(o=r.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(u=y.stateNode,d=y.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,u.style.display=P0("display",a))}catch(b){at(t,t.return,b)}}}else if(y.tag===6){if(g===null)try{y.stateNode.nodeValue=p?"":y.memoizedProps}catch(b){at(t,t.return,b)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===t)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;g===y&&(g=null),y=y.return}g===y&&(g=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:bn(e,t),Qn(t),i&4&&v_(t);break;case 21:break;default:bn(e,t),Qn(t)}}function Qn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(eE(n)){var i=n;break e}n=n.return}throw Error(j(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(al(r,""),i.flags&=-33);var o=y_(t);Cf(t,o,r);break;case 3:case 4:var a=i.stateNode.containerInfo,u=y_(t);wf(t,u,a);break;default:throw Error(j(161))}}catch(d){at(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Ex(t,e,n){oe=t,iE(t)}function iE(t,e,n){for(var i=(t.mode&1)!==0;oe!==null;){var r=oe,o=r.child;if(r.tag===22&&i){var a=r.memoizedState!==null||Ju;if(!a){var u=r.alternate,d=u!==null&&u.memoizedState!==null||Ot;u=Ju;var p=Ot;if(Ju=a,(Ot=d)&&!p)for(oe=r;oe!==null;)a=oe,d=a.child,a.tag===22&&a.memoizedState!==null?w_(r):d!==null?(d.return=a,oe=d):w_(r);for(;o!==null;)oe=o,iE(o),o=o.sibling;oe=r,Ju=u,Ot=p}T_(t)}else r.subtreeFlags&8772&&o!==null?(o.return=r,oe=o):T_(t)}}function T_(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ot||gd(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Ot)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Fn(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&r_(e,o,i);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}r_(e,a,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var p=e.alternate;if(p!==null){var g=p.memoizedState;if(g!==null){var y=g.dehydrated;y!==null&&dl(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(j(163))}Ot||e.flags&512&&Ef(e)}catch(T){at(e,e.return,T)}}if(e===t){oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,oe=n;break}oe=e.return}}function E_(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,oe=n;break}oe=e.return}}function w_(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{gd(4,e)}catch(d){at(e,n,d)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(d){at(e,r,d)}}var o=e.return;try{Ef(e)}catch(d){at(e,o,d)}break;case 5:var a=e.return;try{Ef(e)}catch(d){at(e,a,d)}}}catch(d){at(e,e.return,d)}if(e===t){oe=null;break}var u=e.sibling;if(u!==null){u.return=e.return,oe=u;break}oe=e.return}}var wx=Math.ceil,qc=Mi.ReactCurrentDispatcher,Hp=Mi.ReactCurrentOwner,An=Mi.ReactCurrentBatchConfig,Le=0,xt=null,mt=null,kt=0,ln=0,ns=yr(0),vt=0,wl=null,Xr=0,_d=0,Gp=0,Xa=null,Qt=null,Wp=0,ws=1/0,vi=null,Hc=!1,If=null,sr=null,Zu=!1,ji=null,Gc=0,ja=0,Sf=null,fc=-1,pc=0;function $t(){return Le&6?ct():fc!==-1?fc:fc=ct()}function ar(t){return t.mode&1?Le&2&&kt!==0?kt&-kt:ox.transition!==null?(pc===0&&(pc=z0()),pc):(t=Be,t!==0||(t=window.event,t=t===void 0?16:J0(t.type)),t):1}function qn(t,e,n,i){if(50<ja)throw ja=0,Sf=null,Error(j(185));Ul(t,n,i),(!(Le&2)||t!==xt)&&(t===xt&&(!(Le&2)&&(_d|=n),vt===4&&Qi(t,kt)),nn(t,i),n===1&&Le===0&&!(e.mode&1)&&(ws=ct()+500,fd&&vr()))}function nn(t,e){var n=t.callbackNode;oS(t,e);var i=Ac(t,t===xt?kt:0);if(i===0)n!==null&&kg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&kg(n),e===1)t.tag===0?rx(C_.bind(null,t)):fT(C_.bind(null,t)),ex(function(){!(Le&6)&&vr()}),n=null;else{switch(q0(i)){case 1:n=_p;break;case 4:n=O0;break;case 16:n=xc;break;case 536870912:n=B0;break;default:n=xc}n=dE(n,rE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function rE(t,e){if(fc=-1,pc=0,Le&6)throw Error(j(327));var n=t.callbackNode;if(us()&&t.callbackNode!==n)return null;var i=Ac(t,t===xt?kt:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Wc(t,i);else{e=i;var r=Le;Le|=2;var o=sE();(xt!==t||kt!==e)&&(vi=null,ws=ct()+500,Gr(t,e));do try{Sx();break}catch(u){oE(t,u)}while(!0);Np(),qc.current=o,Le=r,mt!==null?e=0:(xt=null,kt=0,e=vt)}if(e!==0){if(e===2&&(r=Qh(t),r!==0&&(i=r,e=xf(t,r))),e===1)throw n=wl,Gr(t,0),Qi(t,i),nn(t,ct()),n;if(e===6)Qi(t,i);else{if(r=t.current.alternate,!(i&30)&&!Cx(r)&&(e=Wc(t,i),e===2&&(o=Qh(t),o!==0&&(i=o,e=xf(t,o))),e===1))throw n=wl,Gr(t,0),Qi(t,i),nn(t,ct()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(j(345));case 2:Ur(t,Qt,vi);break;case 3:if(Qi(t,i),(i&130023424)===i&&(e=Wp+500-ct(),10<e)){if(Ac(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){$t(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=sf(Ur.bind(null,t,Qt,vi),e);break}Ur(t,Qt,vi);break;case 4:if(Qi(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var a=31-zn(i);o=1<<a,a=e[a],a>r&&(r=a),i&=~o}if(i=r,i=ct()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*wx(i/1960))-i,10<i){t.timeoutHandle=sf(Ur.bind(null,t,Qt,vi),i);break}Ur(t,Qt,vi);break;case 5:Ur(t,Qt,vi);break;default:throw Error(j(329))}}}return nn(t,ct()),t.callbackNode===n?rE.bind(null,t):null}function xf(t,e){var n=Xa;return t.current.memoizedState.isDehydrated&&(Gr(t,e).flags|=256),t=Wc(t,e),t!==2&&(e=Qt,Qt=n,e!==null&&Af(e)),t}function Af(t){Qt===null?Qt=t:Qt.push.apply(Qt,t)}function Cx(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!Hn(o(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qi(t,e){for(e&=~Gp,e&=~_d,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-zn(e),i=1<<n;t[n]=-1,e&=~i}}function C_(t){if(Le&6)throw Error(j(327));us();var e=Ac(t,0);if(!(e&1))return nn(t,ct()),null;var n=Wc(t,e);if(t.tag!==0&&n===2){var i=Qh(t);i!==0&&(e=i,n=xf(t,i))}if(n===1)throw n=wl,Gr(t,0),Qi(t,e),nn(t,ct()),n;if(n===6)throw Error(j(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ur(t,Qt,vi),nn(t,ct()),null}function $p(t,e){var n=Le;Le|=1;try{return t(e)}finally{Le=n,Le===0&&(ws=ct()+500,fd&&vr())}}function jr(t){ji!==null&&ji.tag===0&&!(Le&6)&&us();var e=Le;Le|=1;var n=An.transition,i=Be;try{if(An.transition=null,Be=1,t)return t()}finally{Be=i,An.transition=n,Le=e,!(Le&6)&&vr()}}function Kp(){ln=ns.current,Ye(ns)}function Gr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,jS(n)),mt!==null)for(n=mt.return;n!==null;){var i=n;switch(Ap(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Mc();break;case 3:Ts(),Ye(en),Ye(qt),bp();break;case 5:Vp(i);break;case 4:Ts();break;case 13:Ye(nt);break;case 19:Ye(nt);break;case 10:kp(i.type._context);break;case 22:case 23:Kp()}n=n.return}if(xt=t,mt=t=lr(t.current,null),kt=ln=e,vt=0,wl=null,Gp=_d=Xr=0,Qt=Xa=null,zr!==null){for(e=0;e<zr.length;e++)if(n=zr[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,o=n.pending;if(o!==null){var a=o.next;o.next=r,i.next=a}n.pending=i}zr=null}return t}function oE(t,e){do{var n=mt;try{if(Np(),cc.current=zc,Bc){for(var i=it.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Bc=!1}if(Qr=0,St=yt=it=null,Ya=!1,vl=0,Hp.current=null,n===null||n.return===null){vt=1,wl=e,mt=null;break}e:{var o=t,a=n.return,u=n,d=e;if(e=kt,u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var p=d,g=u,y=g.tag;if(!(g.mode&1)&&(y===0||y===11||y===15)){var T=g.alternate;T?(g.updateQueue=T.updateQueue,g.memoizedState=T.memoizedState,g.lanes=T.lanes):(g.updateQueue=null,g.memoizedState=null)}var I=c_(a);if(I!==null){I.flags&=-257,d_(I,a,u,o,e),I.mode&1&&u_(o,p,e),e=I,d=p;var V=e.updateQueue;if(V===null){var b=new Set;b.add(d),e.updateQueue=b}else V.add(d);break e}else{if(!(e&1)){u_(o,p,e),Jp();break e}d=Error(j(426))}}else if(je&&u.mode&1){var q=c_(a);if(q!==null){!(q.flags&65536)&&(q.flags|=256),d_(q,a,u,o,e),Pp(Es(d,u));break e}}o=d=Es(d,u),vt!==4&&(vt=2),Xa===null?Xa=[o]:Xa.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var A=qT(o,d,e);i_(o,A);break e;case 1:u=d;var x=o.type,R=o.stateNode;if(!(o.flags&128)&&(typeof x.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(sr===null||!sr.has(R)))){o.flags|=65536,e&=-e,o.lanes|=e;var z=HT(o,u,e);i_(o,z);break e}}o=o.return}while(o!==null)}lE(n)}catch(W){e=W,mt===n&&n!==null&&(mt=n=n.return);continue}break}while(!0)}function sE(){var t=qc.current;return qc.current=zc,t===null?zc:t}function Jp(){(vt===0||vt===3||vt===2)&&(vt=4),xt===null||!(Xr&268435455)&&!(_d&268435455)||Qi(xt,kt)}function Wc(t,e){var n=Le;Le|=2;var i=sE();(xt!==t||kt!==e)&&(vi=null,Gr(t,e));do try{Ix();break}catch(r){oE(t,r)}while(!0);if(Np(),Le=n,qc.current=i,mt!==null)throw Error(j(261));return xt=null,kt=0,vt}function Ix(){for(;mt!==null;)aE(mt)}function Sx(){for(;mt!==null&&!YI();)aE(mt)}function aE(t){var e=cE(t.alternate,t,ln);t.memoizedProps=t.pendingProps,e===null?lE(t):mt=e,Hp.current=null}function lE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=yx(n,e),n!==null){n.flags&=32767,mt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vt=6,mt=null;return}}else if(n=_x(n,e,ln),n!==null){mt=n;return}if(e=e.sibling,e!==null){mt=e;return}mt=e=t}while(e!==null);vt===0&&(vt=5)}function Ur(t,e,n){var i=Be,r=An.transition;try{An.transition=null,Be=1,xx(t,e,n,i)}finally{An.transition=r,Be=i}return null}function xx(t,e,n,i){do us();while(ji!==null);if(Le&6)throw Error(j(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(j(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(sS(t,o),t===xt&&(mt=xt=null,kt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zu||(Zu=!0,dE(xc,function(){return us(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=An.transition,An.transition=null;var a=Be;Be=1;var u=Le;Le|=4,Hp.current=null,Tx(t,n),nE(n,t),$S(rf),Pc=!!nf,rf=nf=null,t.current=n,Ex(n),QI(),Le=u,Be=a,An.transition=o}else t.current=n;if(Zu&&(Zu=!1,ji=t,Gc=r),o=t.pendingLanes,o===0&&(sr=null),eS(n.stateNode),nn(t,ct()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Hc)throw Hc=!1,t=If,If=null,t;return Gc&1&&t.tag!==0&&us(),o=t.pendingLanes,o&1?t===Sf?ja++:(ja=0,Sf=t):ja=0,vr(),null}function us(){if(ji!==null){var t=q0(Gc),e=An.transition,n=Be;try{if(An.transition=null,Be=16>t?16:t,ji===null)var i=!1;else{if(t=ji,ji=null,Gc=0,Le&6)throw Error(j(331));var r=Le;for(Le|=4,oe=t.current;oe!==null;){var o=oe,a=o.child;if(oe.flags&16){var u=o.deletions;if(u!==null){for(var d=0;d<u.length;d++){var p=u[d];for(oe=p;oe!==null;){var g=oe;switch(g.tag){case 0:case 11:case 15:Qa(8,g,o)}var y=g.child;if(y!==null)y.return=g,oe=y;else for(;oe!==null;){g=oe;var T=g.sibling,I=g.return;if(jT(g),g===p){oe=null;break}if(T!==null){T.return=I,oe=T;break}oe=I}}}var V=o.alternate;if(V!==null){var b=V.child;if(b!==null){V.child=null;do{var q=b.sibling;b.sibling=null,b=q}while(b!==null)}}oe=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,oe=a;else e:for(;oe!==null;){if(o=oe,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Qa(9,o,o.return)}var A=o.sibling;if(A!==null){A.return=o.return,oe=A;break e}oe=o.return}}var x=t.current;for(oe=x;oe!==null;){a=oe;var R=a.child;if(a.subtreeFlags&2064&&R!==null)R.return=a,oe=R;else e:for(a=x;oe!==null;){if(u=oe,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:gd(9,u)}}catch(W){at(u,u.return,W)}if(u===a){oe=null;break e}var z=u.sibling;if(z!==null){z.return=u.return,oe=z;break e}oe=u.return}}if(Le=r,vr(),ei&&typeof ei.onPostCommitFiberRoot=="function")try{ei.onPostCommitFiberRoot(ld,t)}catch{}i=!0}return i}finally{Be=n,An.transition=e}}return!1}function I_(t,e,n){e=Es(n,e),e=qT(t,e,1),t=or(t,e,1),e=$t(),t!==null&&(Ul(t,1,e),nn(t,e))}function at(t,e,n){if(t.tag===3)I_(t,t,n);else for(;e!==null;){if(e.tag===3){I_(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(sr===null||!sr.has(i))){t=Es(n,t),t=HT(e,t,1),e=or(e,t,1),t=$t(),e!==null&&(Ul(e,1,t),nn(e,t));break}}e=e.return}}function Ax(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=$t(),t.pingedLanes|=t.suspendedLanes&n,xt===t&&(kt&n)===n&&(vt===4||vt===3&&(kt&130023424)===kt&&500>ct()-Wp?Gr(t,0):Gp|=n),nn(t,e)}function uE(t,e){e===0&&(t.mode&1?(e=Ou,Ou<<=1,!(Ou&130023424)&&(Ou=4194304)):e=1);var n=$t();t=xi(t,e),t!==null&&(Ul(t,e,n),nn(t,n))}function Px(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),uE(t,n)}function Rx(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(j(314))}i!==null&&i.delete(e),uE(t,n)}var cE;cE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||en.current)jt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return jt=!1,gx(t,e,n);jt=!!(t.flags&131072)}else jt=!1,je&&e.flags&1048576&&pT(e,Vc,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;hc(t,e),t=e.pendingProps;var r=_s(e,qt.current);ls(e,n),r=Up(null,e,i,t,r,n);var o=Op();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,tn(i)?(o=!0,Lc(e)):o=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Lp(e),r.updater=md,e.stateNode=r,r._reactInternals=e,ff(e,i,t,n),e=gf(null,e,i,!0,o,n)):(e.tag=0,je&&o&&xp(e),Wt(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(hc(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=kx(i),t=Fn(i,t),r){case 0:e=mf(null,e,i,t,n);break e;case 1:e=p_(null,e,i,t,n);break e;case 11:e=h_(null,e,i,t,n);break e;case 14:e=f_(null,e,i,Fn(i.type,t),n);break e}throw Error(j(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Fn(i,r),mf(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Fn(i,r),p_(t,e,i,r,n);case 3:e:{if(KT(e),t===null)throw Error(j(387));i=e.pendingProps,o=e.memoizedState,r=o.element,TT(t,e),Uc(e,i,null,n);var a=e.memoizedState;if(i=a.element,o.isDehydrated)if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){r=Es(Error(j(423)),e),e=m_(t,e,i,n,r);break e}else if(i!==r){r=Es(Error(j(424)),e),e=m_(t,e,i,n,r);break e}else for(un=rr(e.stateNode.containerInfo.firstChild),dn=e,je=!0,On=null,n=yT(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ys(),i===r){e=Ai(t,e,n);break e}Wt(t,e,i,n)}e=e.child}return e;case 5:return ET(e),t===null&&cf(e),i=e.type,r=e.pendingProps,o=t!==null?t.memoizedProps:null,a=r.children,of(i,r)?a=null:o!==null&&of(i,o)&&(e.flags|=32),$T(t,e),Wt(t,e,a,n),e.child;case 6:return t===null&&cf(e),null;case 13:return JT(t,e,n);case 4:return Dp(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=vs(e,null,i,n):Wt(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Fn(i,r),h_(t,e,i,r,n);case 7:return Wt(t,e,e.pendingProps,n),e.child;case 8:return Wt(t,e,e.pendingProps.children,n),e.child;case 12:return Wt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,o=e.memoizedProps,a=r.value,$e(bc,i._currentValue),i._currentValue=a,o!==null)if(Hn(o.value,a)){if(o.children===r.children&&!en.current){e=Ai(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var u=o.dependencies;if(u!==null){a=o.child;for(var d=u.firstContext;d!==null;){if(d.context===i){if(o.tag===1){d=Ci(-1,n&-n),d.tag=2;var p=o.updateQueue;if(p!==null){p=p.shared;var g=p.pending;g===null?d.next=d:(d.next=g.next,g.next=d),p.pending=d}}o.lanes|=n,d=o.alternate,d!==null&&(d.lanes|=n),df(o.return,n,e),u.lanes|=n;break}d=d.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(j(341));a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),df(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}Wt(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,ls(e,n),r=Rn(r),i=i(r),e.flags|=1,Wt(t,e,i,n),e.child;case 14:return i=e.type,r=Fn(i,e.pendingProps),r=Fn(i.type,r),f_(t,e,i,r,n);case 15:return GT(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Fn(i,r),hc(t,e),e.tag=1,tn(i)?(t=!0,Lc(e)):t=!1,ls(e,n),zT(e,i,r),ff(e,i,r,n),gf(null,e,i,!0,t,n);case 19:return ZT(t,e,n);case 22:return WT(t,e,n)}throw Error(j(156,e.tag))};function dE(t,e){return U0(t,e)}function Nx(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(t,e,n,i){return new Nx(t,e,n,i)}function Zp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function kx(t){if(typeof t=="function")return Zp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===pp)return 11;if(t===mp)return 14}return 2}function lr(t,e){var n=t.alternate;return n===null?(n=xn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function mc(t,e,n,i,r,o){var a=2;if(i=t,typeof t=="function")Zp(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case $o:return Wr(n.children,r,o,e);case fp:a=8,r|=8;break;case bh:return t=xn(12,n,e,r|2),t.elementType=bh,t.lanes=o,t;case Fh:return t=xn(13,n,e,r),t.elementType=Fh,t.lanes=o,t;case Uh:return t=xn(19,n,e,r),t.elementType=Uh,t.lanes=o,t;case E0:return yd(n,r,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case v0:a=10;break e;case T0:a=9;break e;case pp:a=11;break e;case mp:a=14;break e;case Ki:a=16,i=null;break e}throw Error(j(130,t==null?t:typeof t,""))}return e=xn(a,n,e,r),e.elementType=t,e.type=i,e.lanes=o,e}function Wr(t,e,n,i){return t=xn(7,t,i,e),t.lanes=n,t}function yd(t,e,n,i){return t=xn(22,t,i,e),t.elementType=E0,t.lanes=n,t.stateNode={isHidden:!1},t}function wh(t,e,n){return t=xn(6,t,null,e),t.lanes=n,t}function Ch(t,e,n){return e=xn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Mx(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ih(0),this.expirationTimes=ih(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ih(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Yp(t,e,n,i,r,o,a,u,d){return t=new Mx(t,e,n,u,d),e===1?(e=1,o===!0&&(e|=8)):e=0,o=xn(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lp(o),t}function Lx(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wo,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function hE(t){if(!t)return fr;t=t._reactInternals;e:{if(ro(t)!==t||t.tag!==1)throw Error(j(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(tn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(j(171))}if(t.tag===1){var n=t.type;if(tn(n))return hT(t,n,e)}return e}function fE(t,e,n,i,r,o,a,u,d){return t=Yp(n,i,!0,t,r,o,a,u,d),t.context=hE(null),n=t.current,i=$t(),r=ar(n),o=Ci(i,r),o.callback=e??null,or(n,o,r),t.current.lanes=r,Ul(t,r,i),nn(t,i),t}function vd(t,e,n,i){var r=e.current,o=$t(),a=ar(r);return n=hE(n),e.context===null?e.context=n:e.pendingContext=n,e=Ci(o,a),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=or(r,e,a),t!==null&&(qn(t,r,a,o),uc(t,r,a)),a}function $c(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function S_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Qp(t,e){S_(t,e),(t=t.alternate)&&S_(t,e)}function Dx(){return null}var pE=typeof reportError=="function"?reportError:function(t){console.error(t)};function Xp(t){this._internalRoot=t}Td.prototype.render=Xp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(j(409));vd(t,e,null,null)};Td.prototype.unmount=Xp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;jr(function(){vd(null,t,null,null)}),e[Si]=null}};function Td(t){this._internalRoot=t}Td.prototype.unstable_scheduleHydration=function(t){if(t){var e=W0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Yi.length&&e!==0&&e<Yi[n].priority;n++);Yi.splice(n,0,t),n===0&&K0(t)}};function jp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ed(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function x_(){}function Vx(t,e,n,i,r){if(r){if(typeof i=="function"){var o=i;i=function(){var p=$c(a);o.call(p)}}var a=fE(e,i,t,0,null,!1,!1,"",x_);return t._reactRootContainer=a,t[Si]=a.current,pl(t.nodeType===8?t.parentNode:t),jr(),a}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var u=i;i=function(){var p=$c(d);u.call(p)}}var d=Yp(t,0,!1,null,null,!1,!1,"",x_);return t._reactRootContainer=d,t[Si]=d.current,pl(t.nodeType===8?t.parentNode:t),jr(function(){vd(e,d,n,i)}),d}function wd(t,e,n,i,r){var o=n._reactRootContainer;if(o){var a=o;if(typeof r=="function"){var u=r;r=function(){var d=$c(a);u.call(d)}}vd(e,a,t,r)}else a=Vx(n,e,t,r,i);return $c(a)}H0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Oa(e.pendingLanes);n!==0&&(yp(e,n|1),nn(e,ct()),!(Le&6)&&(ws=ct()+500,vr()))}break;case 13:jr(function(){var i=xi(t,1);if(i!==null){var r=$t();qn(i,t,1,r)}}),Qp(t,1)}};vp=function(t){if(t.tag===13){var e=xi(t,134217728);if(e!==null){var n=$t();qn(e,t,134217728,n)}Qp(t,134217728)}};G0=function(t){if(t.tag===13){var e=ar(t),n=xi(t,e);if(n!==null){var i=$t();qn(n,t,e,i)}Qp(t,e)}};W0=function(){return Be};$0=function(t,e){var n=Be;try{return Be=t,e()}finally{Be=n}};Jh=function(t,e,n){switch(e){case"input":if(zh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=hd(i);if(!r)throw Error(j(90));C0(i),zh(i,r)}}}break;case"textarea":S0(t,n);break;case"select":e=n.value,e!=null&&rs(t,!!n.multiple,e,!1)}};M0=$p;L0=jr;var bx={usingClientEntryPoint:!1,Events:[Bl,Yo,hd,N0,k0,$p]},Ma={findFiberByHostInstance:Br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Fx={bundleType:Ma.bundleType,version:Ma.version,rendererPackageName:Ma.rendererPackageName,rendererConfig:Ma.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Mi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=b0(t),t===null?null:t.stateNode},findFiberByHostInstance:Ma.findFiberByHostInstance||Dx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yu.isDisabled&&Yu.supportsFiber)try{ld=Yu.inject(Fx),ei=Yu}catch{}}fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bx;fn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jp(e))throw Error(j(200));return Lx(t,e,null,n)};fn.createRoot=function(t,e){if(!jp(t))throw Error(j(299));var n=!1,i="",r=pE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Yp(t,1,!1,null,null,n,!1,i,r),t[Si]=e.current,pl(t.nodeType===8?t.parentNode:t),new Xp(e)};fn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(j(188)):(t=Object.keys(t).join(","),Error(j(268,t)));return t=b0(e),t=t===null?null:t.stateNode,t};fn.flushSync=function(t){return jr(t)};fn.hydrate=function(t,e,n){if(!Ed(e))throw Error(j(200));return wd(null,t,e,!0,n)};fn.hydrateRoot=function(t,e,n){if(!jp(t))throw Error(j(405));var i=n!=null&&n.hydratedSources||null,r=!1,o="",a=pE;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=fE(e,null,t,1,n??null,r,!1,o,a),t[Si]=e.current,pl(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Td(e)};fn.render=function(t,e,n){if(!Ed(e))throw Error(j(200));return wd(null,t,e,!1,n)};fn.unmountComponentAtNode=function(t){if(!Ed(t))throw Error(j(40));return t._reactRootContainer?(jr(function(){wd(null,null,t,!1,function(){t._reactRootContainer=null,t[Si]=null})}),!0):!1};fn.unstable_batchedUpdates=$p;fn.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Ed(n))throw Error(j(200));if(t==null||t._reactInternals===void 0)throw Error(j(38));return wd(t,e,n,!1,i)};fn.version="18.3.1-next-f1338f8080-20240426";function mE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mE)}catch(t){console.error(t)}}mE(),m0.exports=fn;var gE=m0.exports,A_=gE;Dh.createRoot=A_.createRoot,Dh.hydrateRoot=A_.hydrateRoot;const Cd={className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2},Ux=()=>C.jsx("svg",{...Cd,children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),Ox=()=>C.jsx("svg",{...Cd,children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Bx=()=>C.jsx("svg",{...Cd,children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),zx=()=>C.jsx("svg",{...Cd,children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),_E=()=>C.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l5.447 2.724A1 1 0 0021 16.382V5.618a1 1 0 00-1.447-.894L15 7m-6 13v-6l6 3m-6-3l6-3"})}),yE=()=>C.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3h2m-4 13h2"})}),vE=()=>C.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a2 2 0 01-2-2V7a2 2 0 012-2h2m6-4v2m-6-2v2"})}),em=()=>C.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),qx=()=>C.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.79 4 4 0 2.21-1.79 4-4 4-1.742 0-3.223-.835-3.772-2M12 18v.01"})}),Hx=()=>C.jsxs("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),TE=()=>C.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[C.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),C.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),EE=()=>C.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Gx=()=>C.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),Wx=()=>C.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),$x=()=>C.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})}),Kx=()=>C.jsx("svg",{className:"w-6 h-6 transform rotate-90",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),Jx=()=>C.jsxs("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M3 9h2m14 0h2M3 15h2m14 0h2M10 21h4c1.105 0 2-.895 2-2v-2H8v2c0 1.105.895 2 2 2z"}),C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 14c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z"}),C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 9V7a2 2 0 012-2h10a2 2 0 012 2v2"})]}),wE=()=>C.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Zx=()=>C.jsxs("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:[C.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 20.25C16.5563 20.25 20.25 16.5563 20.25 12C20.25 7.44365 16.5563 3.75 12 3.75C7.44365 3.75 3.75 7.44365 3.75 12C3.75 16.5563 7.44365 20.25 12 20.25ZM12 22.5C17.799 22.5 22.5 17.799 22.5 12C22.5 6.20101 17.799 1.5 12 1.5C6.20101 1.5 1.5 6.20101 1.5 12C1.5 17.799 6.20101 22.5 12 22.5Z"}),C.jsx("path",{d:"M12 15.75C14.0711 15.75 15.75 14.0711 15.75 12C15.75 9.92893 14.0711 8.25 12 8.25C9.92893 8.25 8.25 9.92893 8.25 12C8.25 14.0711 9.92893 15.75 12 15.75Z"})]}),Yx=()=>C.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),Qx=()=>C.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Xx=()=>C.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),jx=()=>C.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),eA=()=>C.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})}),tA=()=>C.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14H5.236a2 2 0 01-1.789-2.894l3.5-7A2 2 0 018.736 3h4.018a2 2 0 01.485.06l3.76.94m-7 10v5a2 2 0 002 2h.095c.5 0 .905-.405.905-.905 0-.714.211-1.412.608-2.006L17 13V4m-7 10h2m5-10h2a2 2 0 012 2v6a2 2 0 01-2 2h-2.5"})}),nA=()=>C.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:C.jsx("path",{d:"M8 5v14l11-7z"})}),iA=()=>C.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:C.jsx("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"})}),rA=()=>C.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),P_=()=>C.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),R_=()=>C.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),oA=()=>C.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Ls={en:{appName:"Hyperlocal Navi-Assistant",welcome:"Welcome to SCB Navigation",welcomeSub:"Your AI companion for navigating tricky local roads. What would you like to do?",gettingLocation:"Getting your location...",manualLocationSet:"Location manually set to:",planRouteTitle:"Plan Smart Route",planRouteDesc:"Get the best path with AI-powered 'thinking mode'.",planRouteDescScb:"For SCB Campus navigation only",localUpdatesTitle:"Local Updates",localUpdatesDesc:"Check for real-time traffic and event news.",chatTitle:"Ask Assistant",chatDesc:"Chat with Gemini for any questions you have.",setLocationTitle:"Set Location Manually",setLocationDesc:"Override GPS and set your starting point.",reportTitle:"Report Traffic",reportDesc:"Help the community by reporting an issue.",navHome:"Home",navPlanner:"Planner",navUpdates:"Updates",navChat:"Chat",navMode:"Navigation (A to B)",dayMode:"Day Planner",campusNavTitle:"Campus Navigator",itineraryTitle:"AI Itinerary Planner",navSub:"Get interactive, step-by-step directions inside the campus.",daySub:'Plan a full day: "Visiting OPD, then blood bank, then lunch".',destLabel:"Where do you want to go?",destPlace:"e.g., Cardiology Department, Main Gate",notesLabel:"Any preferences?",notesPlace:"e.g., Avoid stairs, need wheelchair access...",dayPromptLabel:"Describe your plan:",dayPromptPlace:"e.g., I need to visit the Eye Dept at 10am, then grab lunch at 1pm, and meet a doctor at Surgery Dept at 3pm.",findPath:"Find Best Path",genPlan:"Generate Itinerary",analyzing:"Analyzing Routes...",connecting:"Gemini is connecting...",step:"Step",prev:"Previous",next:"Next",viewSummary:"View Route Summary & Sources",viewPlanText:"View Itinerary Details",planNew:"Plan New Route",createNew:"Create New Plan",savePlan:"Save Plan",savedPlans:"Saved Plans",yourItinerary:"Your Day Plan",chatWelcome:"Hello! I know the SCB campus inside out. Ask me anything!",chatInput:"Type your question...",updatesHeader:"Daily Campus Briefing",updatesSub:"Real-time checks for SCB Medical College",fetchingUpdates:"Gathering latest reports from local authorities...",noUpdates:"No major incidents reported by authorities.",yourReports:"Community Reports",noUserReports:"No active user reports.",statusTraffic:"Traffic Flow",statusOPD:"OPD Crowds",statusGate:"Main Gate",statusNormal:"Normal",statusBusy:"Busy",statusCritical:"Jammed",readAloud:"Listen to Briefing",stopReading:"Stop Audio",wisdomHeader:"Standard Campus Info",wisdomSub:"General guidelines for patients",wisdomOPD:"OPD Registration: 8:00 AM - 12:00 PM (Mon-Sat). Come early to avoid queues.",wisdomEmergency:"Emergency / Casualty is open 24/7. Use the dedicated Red Lane for ambulances.",wisdomParking:"Patient parking is available near the Playground area. Do not park on main roads.",reportHeader:"Report an Issue",reportLocation:"Location",reportLocationPlace:"e.g., Near Main Gate",reportSeverity:"Severity",sevLight:"Light Traffic",sevModerate:"Moderate Traffic",sevHeavy:"Heavy Traffic / Jam",sevAccident:"Accident / Hazard",sevClosure:"Road Closed",reportDescLabel:"Description",reportDescPlace:"e.g., Stuck for 10 mins, ambulance blocked.",cancel:"Cancel",submitReport:"Submit Report",processingReport:"AI is processing...",reportSuccess:"Report Live!",verifiedBy:"Verified by",users:"users",justNow:"Just now",minsAgo:"mins ago",hrsAgo:"hrs ago"},or:{appName:" -",welcome:"!",welcomeSub:"     AI  |    ?",gettingLocation:"   ...",manualLocationSet:"  :",planRouteTitle:"  ",planRouteDesc:"AI     |",planRouteDescScb:" SCB  ",localUpdatesTitle:" ",localUpdatesDesc:"      |",chatTitle:" ",chatDesc:"Gemini    |",setLocationTitle:" ",setLocationDesc:"      |",reportTitle:"  ",reportDesc:"      |",navHome:"",navPlanner:"",navUpdates:"",navChat:"",navMode:" (  )",dayMode:" ",campusNavTitle:" ",itineraryTitle:"AI  ",navSub:"     |",daySub:"    |",destLabel:"   ?",destPlace:",  ,  ",notesLabel:"    ?",notesPlace:",  ,   ...",dayPromptLabel:"   :",dayPromptPlace:":     ,   ,      |",findPath:" ",genPlan:"  ",analyzing:"  ...",connecting:"Gemini   ...",step:"",prev:"",next:"",viewSummary:" ",viewPlanText:"  ",planNew:"  ",createNew:"  ",savePlan:"  ",savedPlans:"  ",yourItinerary:"  ",chatWelcome:"!  SCB     |    !",chatInput:"  ...",updatesHeader:"  ",updatesSub:"SCB    - ",fetchingUpdates:"     ...",noUpdates:"     |",yourReports:" ",noUserReports:"    |",statusTraffic:" ",statusOPD:"OPD ",statusGate:" ",statusNormal:"",statusBusy:"",statusCritical:" ",readAloud:" ",stopReading:" ",wisdomHeader:" ",wisdomSub:"   ",wisdomOPD:"OPD :     (-) |     |",wisdomEmergency:"     |       |",wisdomParking:"      |      |",reportHeader:" ",reportLocation:"",reportLocationPlace:",   ",reportSeverity:"",sevLight:" ",sevModerate:" ",sevHeavy:"  / ",sevAccident:" / ",sevClosure:" ",reportDescLabel:"",reportDescPlace:":     ,   |",cancel:" ",submitReport:" ",processingReport:"AI  ...",reportSuccess:"  !",verifiedBy:" ",users:"",justNow:"",minsAgo:" ",hrsAgo:" "}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let sA,aA;function lA(){return{geminiUrl:sA,vertexUrl:aA}}function uA(t,e,n,i){var r,o;if(!(t!=null&&t.baseUrl)){const a=lA();return e?(r=a.vertexUrl)!==null&&r!==void 0?r:n:(o=a.geminiUrl)!==null&&o!==void 0?o:i}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Li{}function ie(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const o=e[r];return o!=null?String(o):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function f(t,e,n){for(let o=0;o<e.length-1;o++){const a=e[o];if(a.endsWith("[]")){const u=a.slice(0,-2);if(!(u in t))if(Array.isArray(n))t[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(t[u])){const d=t[u];if(Array.isArray(n))for(let p=0;p<d.length;p++){const g=d[p];f(g,e.slice(o+1),n[p])}else for(const p of d)f(p,e.slice(o+1),n)}return}else if(a.endsWith("[0]")){const u=a.slice(0,-3);u in t||(t[u]=[{}]);const d=t[u];f(d[0],e.slice(o+1),n);return}(!t[a]||typeof t[a]!="object")&&(t[a]={}),t=t[a]}const i=e[e.length-1],r=t[i];if(r!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===r)return;if(typeof r=="object"&&typeof n=="object"&&r!==null&&n!==null)Object.assign(r,n);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[i]=n}function c(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let i=0;i<e.length;i++){if(typeof t!="object"||t===null)return n;const r=e[i];if(r.endsWith("[]")){const o=r.slice(0,-2);if(o in t){const a=t[o];return Array.isArray(a)?a.map(u=>c(u,e.slice(i+1),n)):n}else return n}else t=t[r]}return t}catch(i){if(i instanceof TypeError)return n;throw i}}function cA(t,e){for(const[n,i]of Object.entries(e)){const r=n.split("."),o=i.split("."),a=new Set;let u=-1;for(let d=0;d<r.length;d++)if(r[d]==="*"){u=d;break}if(u!==-1&&o.length>u)for(let d=u;d<o.length;d++){const p=o[d];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&a.add(p)}Pf(t,r,o,0,a)}}function Pf(t,e,n,i,r){if(i>=e.length||typeof t!="object"||t===null)return;const o=e[i];if(o.endsWith("[]")){const a=o.slice(0,-2),u=t;if(a in u&&Array.isArray(u[a]))for(const d of u[a])Pf(d,e,n,i+1,r)}else if(o==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const a=t,u=Object.keys(a).filter(p=>!p.startsWith("_")&&!r.has(p)),d={};for(const p of u)d[p]=a[p];for(const[p,g]of Object.entries(d)){const y=[];for(const T of n.slice(i))T==="*"?y.push(p):y.push(T);f(a,y,g)}for(const p of u)delete a[p]}}else{const a=t;o in a&&Pf(a[o],e,n,i+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tm(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dA(t){const e={},n=c(t,["operationName"]);n!=null&&f(e,["operationName"],n);const i=c(t,["resourceName"]);return i!=null&&f(e,["_url","resourceName"],i),e}function hA(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const i=c(t,["metadata"]);i!=null&&f(e,["metadata"],i);const r=c(t,["done"]);r!=null&&f(e,["done"],r);const o=c(t,["error"]);o!=null&&f(e,["error"],o);const a=c(t,["response","generateVideoResponse"]);return a!=null&&f(e,["response"],pA(a)),e}function fA(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const i=c(t,["metadata"]);i!=null&&f(e,["metadata"],i);const r=c(t,["done"]);r!=null&&f(e,["done"],r);const o=c(t,["error"]);o!=null&&f(e,["error"],o);const a=c(t,["response"]);return a!=null&&f(e,["response"],mA(a)),e}function pA(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>gA(a))),f(e,["generatedVideos"],o)}const i=c(t,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const r=c(t,["raiMediaFilteredReasons"]);return r!=null&&f(e,["raiMediaFilteredReasons"],r),e}function mA(t){const e={},n=c(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>_A(a))),f(e,["generatedVideos"],o)}const i=c(t,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const r=c(t,["raiMediaFilteredReasons"]);return r!=null&&f(e,["raiMediaFilteredReasons"],r),e}function gA(t){const e={},n=c(t,["video"]);return n!=null&&f(e,["video"],CA(n)),e}function _A(t){const e={},n=c(t,["_self"]);return n!=null&&f(e,["video"],IA(n)),e}function yA(t){const e={},n=c(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function vA(t){const e={},n=c(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function TA(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const i=c(t,["metadata"]);i!=null&&f(e,["metadata"],i);const r=c(t,["done"]);r!=null&&f(e,["done"],r);const o=c(t,["error"]);o!=null&&f(e,["error"],o);const a=c(t,["response"]);return a!=null&&f(e,["response"],EA(a)),e}function EA(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["parent"]);i!=null&&f(e,["parent"],i);const r=c(t,["documentName"]);return r!=null&&f(e,["documentName"],r),e}function CE(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const i=c(t,["metadata"]);i!=null&&f(e,["metadata"],i);const r=c(t,["done"]);r!=null&&f(e,["done"],r);const o=c(t,["error"]);o!=null&&f(e,["error"],o);const a=c(t,["response"]);return a!=null&&f(e,["response"],wA(a)),e}function wA(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["parent"]);i!=null&&f(e,["parent"],i);const r=c(t,["documentName"]);return r!=null&&f(e,["documentName"],r),e}function CA(t){const e={},n=c(t,["uri"]);n!=null&&f(e,["uri"],n);const i=c(t,["encodedVideo"]);i!=null&&f(e,["videoBytes"],tm(i));const r=c(t,["encoding"]);return r!=null&&f(e,["mimeType"],r),e}function IA(t){const e={},n=c(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const i=c(t,["bytesBase64Encoded"]);i!=null&&f(e,["videoBytes"],tm(i));const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var N_;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(N_||(N_={}));var k_;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(k_||(k_={}));var M_;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(M_||(M_={}));var We;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(We||(We={}));var L_;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(L_||(L_={}));var D_;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(D_||(D_={}));var V_;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(V_||(V_={}));var b_;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(b_||(b_={}));var F_;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(F_||(F_={}));var U_;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.HIGH="HIGH"})(U_||(U_={}));var O_;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(O_||(O_={}));var B_;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(B_||(B_={}));var z_;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(z_||(z_={}));var q_;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(q_||(q_={}));var H_;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(H_||(H_={}));var G_;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(G_||(G_={}));var W_;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(W_||(W_={}));var $_;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})($_||($_={}));var K_;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(K_||(K_={}));var Kc;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Kc||(Kc={}));var J_;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(J_||(J_={}));var Z_;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Z_||(Z_={}));var Y_;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Y_||(Y_={}));var Rf;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Rf||(Rf={}));var Q_;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Q_||(Q_={}));var X_;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(X_||(X_={}));var j_;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(j_||(j_={}));var ey;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(ey||(ey={}));var ty;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(ty||(ty={}));var ny;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(ny||(ny={}));var iy;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(iy||(iy={}));var ry;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(ry||(ry={}));var oy;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(oy||(oy={}));var sy;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(sy||(sy={}));var ay;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(ay||(ay={}));var ly;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(ly||(ly={}));var uy;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(uy||(uy={}));var cy;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(cy||(cy={}));var dy;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(dy||(dy={}));var hy;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(hy||(hy={}));var fy;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(fy||(fy={}));var py;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(py||(py={}));var my;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(my||(my={}));var gy;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(gy||(gy={}));var _y;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(_y||(_y={}));var yy;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(yy||(yy={}));var vy;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(vy||(vy={}));var Ty;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Ty||(Ty={}));var Ey;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Ey||(Ey={}));var wy;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(wy||(wy={}));var Cy;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Cy||(Cy={}));var Iy;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Iy||(Iy={}));var Sy;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Sy||(Sy={}));var xy;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(xy||(xy={}));var is;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(is||(is={}));class Nf{constructor(e){const n={};for(const i of e.headers.entries())n[i[0]]=i[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class La{get text(){var e,n,i,r,o,a,u,d;if(((r=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",g=!1;const y=[];for(const T of(d=(u=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[I,V]of Object.entries(T))I!=="text"&&I!=="thought"&&I!=="thoughtSignature"&&(V!==null||V!==void 0)&&y.push(I);if(typeof T.text=="string"){if(typeof T.thought=="boolean"&&T.thought)continue;g=!0,p+=T.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?p:void 0}get data(){var e,n,i,r,o,a,u,d;if(((r=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const g=[];for(const y of(d=(u=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[T,I]of Object.entries(y))T!=="inlineData"&&(I!==null||I!==void 0)&&g.push(T);y.inlineData&&typeof y.inlineData.data=="string"&&(p+=atob(y.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,n,i,r,o,a,u,d;if(((r=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(d=(u=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,n,i,r,o,a,u,d,p;if(((r=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(d=(u=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(p=g==null?void 0:g[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,n,i,r,o,a,u,d,p;if(((r=(i=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(d=(u=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(p=g==null?void 0:g[0])===null||p===void 0?void 0:p.output}}class Ay{}class Py{}class SA{}class xA{}class AA{}class PA{}class Ry{}class Ny{}class ky{}class RA{}class Jc{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const i=new Jc;let r;const o=e;return n?r=fA(o):r=hA(o),Object.assign(i,r),i}}class My{}class Ly{}class Dy{}class Vy{}class NA{}class kA{}class MA{}class nm{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const i=new nm,o=TA(e);return Object.assign(i,o),i}}class LA{}class DA{}class VA{}class by{}class bA{get text(){var e,n,i;let r="",o=!1;const a=[];for(const u of(i=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[d,p]of Object.entries(u))d!=="text"&&d!=="thought"&&p!==null&&a.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;o=!0,r+=u.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?r:void 0}get data(){var e,n,i;let r="";const o=[];for(const a of(i=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[u,d]of Object.entries(a))u!=="inlineData"&&d!==null&&o.push(u);a.inlineData&&typeof a.inlineData.data=="string"&&(r+=atob(a.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class FA{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class im{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const i=new im,o=CE(e);return Object.assign(i,o),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function be(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function IE(t,e){const n=be(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function SE(t){return Array.isArray(t)?t.map(e=>Zc(e)):[Zc(t)]}function Zc(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function xE(t){const e=Zc(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function AE(t){const e=Zc(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Fy(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function PE(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Fy(e)):[Fy(t)]}function kf(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Uy(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Oy(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function zt(t){if(t==null)throw new Error("ContentUnion is required");return kf(t)?t:{role:"user",parts:PE(t)}}function rm(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const i=zt(n);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(t.isVertexAI()){const n=zt(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>zt(n)):[zt(e)]}function Pn(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Uy(t)||Oy(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[zt(t)]}const e=[],n=[],i=kf(t[0]);for(const r of t){const o=kf(r);if(o!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(r);else{if(Uy(r)||Oy(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(r)}}return i||e.push({role:"user",parts:PE(n)}),e}function UA(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(i=>i!=="null");if(n.length===1)e.type=Object.values(We).includes(n[0].toUpperCase())?n[0].toUpperCase():We.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of n)e.anyOf.push({type:Object.values(We).includes(i.toUpperCase())?i.toUpperCase():We.TYPE_UNSPECIFIED})}}function cs(t){const e={},n=["items"],i=["anyOf"],r=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=t.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,t=o[1]):o[1].type==="null"&&(e.nullable=!0,t=o[0])),t.type instanceof Array&&UA(t.type,e);for(const[a,u]of Object.entries(t))if(u!=null)if(a=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(We).includes(u.toUpperCase())?u.toUpperCase():We.TYPE_UNSPECIFIED}else if(n.includes(a))e[a]=cs(u);else if(i.includes(a)){const d=[];for(const p of u){if(p.type=="null"){e.nullable=!0;continue}d.push(cs(p))}e[a]=d}else if(r.includes(a)){const d={};for(const[p,g]of Object.entries(u))d[p]=cs(g);e[a]=d}else{if(a==="additionalProperties")continue;e[a]=u}return e}function om(t){return cs(t)}function sm(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function am(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Ds(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=cs(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=cs(e.response));return t}function Vs(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function OA(t,e,n,i=1){const r=!e.startsWith(`${n}/`)&&e.split("/").length===i;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:r?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:r?`${n}/${e}`:e}function Di(t,e){if(typeof e!="string")throw new Error("name must be a string");return OA(t,e,"cachedContents")}function RE(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Tr(t){return tm(t)}function BA(t){return t!=null&&typeof t=="object"&&"name"in t}function zA(t){return t!=null&&typeof t=="object"&&"video"in t}function qA(t){return t!=null&&typeof t=="object"&&"uri"in t}function NE(t){var e;let n;if(BA(t)&&(n=t.name),!(qA(t)&&(n=t.uri,n===void 0))&&!(zA(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const r=n.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${n}`);n=r[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function kE(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function ME(t){for(const e of["models","tunedModels","publisherModels"])if(HA(t,e))return t[e];return[]}function HA(t,e){return t!==null&&typeof t=="object"&&e in t}function GA(t,e={}){const n=t,i={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(i.responseJsonSchema=n.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function WA(t,e={}){const n=[],i=new Set;for(const r of t){const o=r.name;if(i.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);i.add(o);const a=GA(r,e);a.functionDeclarations&&n.push(...a.functionDeclarations)}return{functionDeclarations:n}}function LE(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const i=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,r=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function $A(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function DE(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const r=n.inlinedResponses;if(!Array.isArray(r)||r.length===0)return t;let o=!1;for(const a of r){if(typeof a!="object"||a===null)continue;const d=a.response;if(typeof d!="object"||d===null)continue;if(d.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function bs(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function VE(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KA(t){const e={},n=c(t,["responsesFile"]);n!=null&&f(e,["fileName"],n);const i=c(t,["inlinedResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>AP(a))),f(e,["inlinedResponses"],o)}const r=c(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>a)),f(e,["inlinedEmbedContentResponses"],o)}return e}function JA(t){const e={},n=c(t,["predictionsFormat"]);n!=null&&f(e,["format"],n);const i=c(t,["gcsDestination","outputUriPrefix"]);i!=null&&f(e,["gcsUri"],i);const r=c(t,["bigqueryDestination","outputUri"]);return r!=null&&f(e,["bigqueryUri"],r),e}function ZA(t){const e={},n=c(t,["format"]);n!=null&&f(e,["predictionsFormat"],n);const i=c(t,["gcsUri"]);i!=null&&f(e,["gcsDestination","outputUriPrefix"],i);const r=c(t,["bigqueryUri"]);if(r!=null&&f(e,["bigqueryDestination","outputUri"],r),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(c(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function gc(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const i=c(t,["metadata","displayName"]);i!=null&&f(e,["displayName"],i);const r=c(t,["metadata","state"]);r!=null&&f(e,["state"],VE(r));const o=c(t,["metadata","createTime"]);o!=null&&f(e,["createTime"],o);const a=c(t,["metadata","endTime"]);a!=null&&f(e,["endTime"],a);const u=c(t,["metadata","updateTime"]);u!=null&&f(e,["updateTime"],u);const d=c(t,["metadata","model"]);d!=null&&f(e,["model"],d);const p=c(t,["metadata","output"]);return p!=null&&f(e,["dest"],KA(DE(p))),e}function Mf(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const i=c(t,["displayName"]);i!=null&&f(e,["displayName"],i);const r=c(t,["state"]);r!=null&&f(e,["state"],VE(r));const o=c(t,["error"]);o!=null&&f(e,["error"],o);const a=c(t,["createTime"]);a!=null&&f(e,["createTime"],a);const u=c(t,["startTime"]);u!=null&&f(e,["startTime"],u);const d=c(t,["endTime"]);d!=null&&f(e,["endTime"],d);const p=c(t,["updateTime"]);p!=null&&f(e,["updateTime"],p);const g=c(t,["model"]);g!=null&&f(e,["model"],g);const y=c(t,["inputConfig"]);y!=null&&f(e,["src"],YA(y));const T=c(t,["outputConfig"]);T!=null&&f(e,["dest"],JA(DE(T)));const I=c(t,["completionStats"]);return I!=null&&f(e,["completionStats"],I),e}function YA(t){const e={},n=c(t,["instancesFormat"]);n!=null&&f(e,["format"],n);const i=c(t,["gcsSource","uris"]);i!=null&&f(e,["gcsUri"],i);const r=c(t,["bigquerySource","inputUri"]);return r!=null&&f(e,["bigqueryUri"],r),e}function QA(t,e){const n={};if(c(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=c(e,["fileName"]);i!=null&&f(n,["fileName"],i);const r=c(e,["inlinedRequests"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>xP(t,a))),f(n,["requests","requests"],o)}return n}function XA(t){const e={},n=c(t,["format"]);n!=null&&f(e,["instancesFormat"],n);const i=c(t,["gcsUri"]);i!=null&&f(e,["gcsSource","uris"],i);const r=c(t,["bigqueryUri"]);if(r!=null&&f(e,["bigquerySource","inputUri"],r),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function jA(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function eP(t,e){const n={},i=c(e,["name"]);return i!=null&&f(n,["_url","name"],bs(t,i)),n}function tP(t,e){const n={},i=c(e,["name"]);return i!=null&&f(n,["_url","name"],bs(t,i)),n}function nP(t){const e={},n=c(t,["content"]);n!=null&&f(e,["content"],n);const i=c(t,["citationMetadata"]);i!=null&&f(e,["citationMetadata"],iP(i));const r=c(t,["tokenCount"]);r!=null&&f(e,["tokenCount"],r);const o=c(t,["finishReason"]);o!=null&&f(e,["finishReason"],o);const a=c(t,["avgLogprobs"]);a!=null&&f(e,["avgLogprobs"],a);const u=c(t,["groundingMetadata"]);u!=null&&f(e,["groundingMetadata"],u);const d=c(t,["index"]);d!=null&&f(e,["index"],d);const p=c(t,["logprobsResult"]);p!=null&&f(e,["logprobsResult"],p);const g=c(t,["safetyRatings"]);if(g!=null){let T=g;Array.isArray(T)&&(T=T.map(I=>I)),f(e,["safetyRatings"],T)}const y=c(t,["urlContextMetadata"]);return y!=null&&f(e,["urlContextMetadata"],y),e}function iP(t){const e={},n=c(t,["citationSources"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>r)),f(e,["citations"],i)}return e}function bE(t){const e={},n=c(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>DP(o))),f(e,["parts"],r)}const i=c(t,["role"]);return i!=null&&f(e,["role"],i),e}function rP(t,e){const n={},i=c(t,["displayName"]);if(e!==void 0&&i!=null&&f(e,["batch","displayName"],i),c(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function oP(t,e){const n={},i=c(t,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const r=c(t,["dest"]);return e!==void 0&&r!=null&&f(e,["outputConfig"],ZA($A(r))),n}function By(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["src"]);r!=null&&f(n,["batch","inputConfig"],QA(t,LE(t,r)));const o=c(e,["config"]);return o!=null&&rP(o,n),n}function sP(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["model"],be(t,i));const r=c(e,["src"]);r!=null&&f(n,["inputConfig"],XA(LE(t,r)));const o=c(e,["config"]);return o!=null&&oP(o,n),n}function aP(t,e){const n={},i=c(t,["displayName"]);return e!==void 0&&i!=null&&f(e,["batch","displayName"],i),n}function lP(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["src"]);r!=null&&f(n,["batch","inputConfig"],mP(t,r));const o=c(e,["config"]);return o!=null&&aP(o,n),n}function uP(t,e){const n={},i=c(e,["name"]);return i!=null&&f(n,["_url","name"],bs(t,i)),n}function cP(t,e){const n={},i=c(e,["name"]);return i!=null&&f(n,["_url","name"],bs(t,i)),n}function dP(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["name"]);i!=null&&f(e,["name"],i);const r=c(t,["done"]);r!=null&&f(e,["done"],r);const o=c(t,["error"]);return o!=null&&f(e,["error"],o),e}function hP(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["name"]);i!=null&&f(e,["name"],i);const r=c(t,["done"]);r!=null&&f(e,["done"],r);const o=c(t,["error"]);return o!=null&&f(e,["error"],o),e}function fP(t,e){const n={},i=c(e,["contents"]);if(i!=null){let o=rm(t,i);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["requests[]","request","content"],o)}const r=c(e,["config"]);return r!=null&&(f(n,["_self"],pP(r,n)),cA(n,{"requests[].*":"requests[].request.*"})),n}function pP(t,e){const n={},i=c(t,["taskType"]);e!==void 0&&i!=null&&f(e,["requests[]","taskType"],i);const r=c(t,["title"]);e!==void 0&&r!=null&&f(e,["requests[]","title"],r);const o=c(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&f(e,["requests[]","outputDimensionality"],o),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function mP(t,e){const n={},i=c(e,["fileName"]);i!=null&&f(n,["file_name"],i);const r=c(e,["inlinedRequests"]);return r!=null&&f(n,["requests"],fP(t,r)),n}function gP(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function _P(t){const e={},n=c(t,["id"]);n!=null&&f(e,["id"],n);const i=c(t,["args"]);i!=null&&f(e,["args"],i);const r=c(t,["name"]);if(r!=null&&f(e,["name"],r),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function yP(t){const e={},n=c(t,["mode"]);n!=null&&f(e,["mode"],n);const i=c(t,["allowedFunctionNames"]);if(i!=null&&f(e,["allowedFunctionNames"],i),c(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function vP(t,e,n){const i={},r=c(e,["systemInstruction"]);n!==void 0&&r!=null&&f(n,["systemInstruction"],bE(zt(r)));const o=c(e,["temperature"]);o!=null&&f(i,["temperature"],o);const a=c(e,["topP"]);a!=null&&f(i,["topP"],a);const u=c(e,["topK"]);u!=null&&f(i,["topK"],u);const d=c(e,["candidateCount"]);d!=null&&f(i,["candidateCount"],d);const p=c(e,["maxOutputTokens"]);p!=null&&f(i,["maxOutputTokens"],p);const g=c(e,["stopSequences"]);g!=null&&f(i,["stopSequences"],g);const y=c(e,["responseLogprobs"]);y!=null&&f(i,["responseLogprobs"],y);const T=c(e,["logprobs"]);T!=null&&f(i,["logprobs"],T);const I=c(e,["presencePenalty"]);I!=null&&f(i,["presencePenalty"],I);const V=c(e,["frequencyPenalty"]);V!=null&&f(i,["frequencyPenalty"],V);const b=c(e,["seed"]);b!=null&&f(i,["seed"],b);const q=c(e,["responseMimeType"]);q!=null&&f(i,["responseMimeType"],q);const A=c(e,["responseSchema"]);A!=null&&f(i,["responseSchema"],om(A));const x=c(e,["responseJsonSchema"]);if(x!=null&&f(i,["responseJsonSchema"],x),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const R=c(e,["safetySettings"]);if(n!==void 0&&R!=null){let U=R;Array.isArray(U)&&(U=U.map(M=>VP(M))),f(n,["safetySettings"],U)}const z=c(e,["tools"]);if(n!==void 0&&z!=null){let U=Vs(z);Array.isArray(U)&&(U=U.map(M=>FP(Ds(M)))),f(n,["tools"],U)}const W=c(e,["toolConfig"]);if(n!==void 0&&W!=null&&f(n,["toolConfig"],bP(W)),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const J=c(e,["cachedContent"]);n!==void 0&&J!=null&&f(n,["cachedContent"],Di(t,J));const k=c(e,["responseModalities"]);k!=null&&f(i,["responseModalities"],k);const N=c(e,["mediaResolution"]);N!=null&&f(i,["mediaResolution"],N);const D=c(e,["speechConfig"]);if(D!=null&&f(i,["speechConfig"],sm(D)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const F=c(e,["thinkingConfig"]);F!=null&&f(i,["thinkingConfig"],F);const B=c(e,["imageConfig"]);return B!=null&&f(i,["imageConfig"],SP(B)),i}function TP(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["candidates"]);if(i!=null){let d=i;Array.isArray(d)&&(d=d.map(p=>nP(p))),f(e,["candidates"],d)}const r=c(t,["modelVersion"]);r!=null&&f(e,["modelVersion"],r);const o=c(t,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const a=c(t,["responseId"]);a!=null&&f(e,["responseId"],a);const u=c(t,["usageMetadata"]);return u!=null&&f(e,["usageMetadata"],u),e}function EP(t,e){const n={},i=c(e,["name"]);return i!=null&&f(n,["_url","name"],bs(t,i)),n}function wP(t,e){const n={},i=c(e,["name"]);return i!=null&&f(n,["_url","name"],bs(t,i)),n}function CP(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function IP(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function SP(t){const e={},n=c(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const i=c(t,["imageSize"]);if(i!=null&&f(e,["imageSize"],i),c(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(c(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function xP(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["request","model"],be(t,i));const r=c(e,["contents"]);if(r!=null){let u=Pn(r);Array.isArray(u)&&(u=u.map(d=>bE(d))),f(n,["request","contents"],u)}const o=c(e,["metadata"]);o!=null&&f(n,["metadata"],o);const a=c(e,["config"]);return a!=null&&f(n,["request","generationConfig"],vP(t,a,c(n,["request"],{}))),n}function AP(t){const e={},n=c(t,["response"]);n!=null&&f(e,["response"],TP(n));const i=c(t,["error"]);return i!=null&&f(e,["error"],i),e}function PP(t,e){const n={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(t,["pageToken"]);if(e!==void 0&&r!=null&&f(e,["_query","pageToken"],r),c(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function RP(t,e){const n={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(t,["pageToken"]);e!==void 0&&r!=null&&f(e,["_query","pageToken"],r);const o=c(t,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),n}function NP(t){const e={},n=c(t,["config"]);return n!=null&&PP(n,e),e}function kP(t){const e={},n=c(t,["config"]);return n!=null&&RP(n,e),e}function MP(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(t,["operations"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>gc(a))),f(e,["batchJobs"],o)}return e}function LP(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(t,["batchPredictionJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>Mf(a))),f(e,["batchJobs"],o)}return e}function DP(t){const e={},n=c(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const i=c(t,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const r=c(t,["executableCode"]);r!=null&&f(e,["executableCode"],r);const o=c(t,["fileData"]);o!=null&&f(e,["fileData"],gP(o));const a=c(t,["functionCall"]);a!=null&&f(e,["functionCall"],_P(a));const u=c(t,["functionResponse"]);u!=null&&f(e,["functionResponse"],u);const d=c(t,["inlineData"]);d!=null&&f(e,["inlineData"],jA(d));const p=c(t,["text"]);p!=null&&f(e,["text"],p);const g=c(t,["thought"]);g!=null&&f(e,["thought"],g);const y=c(t,["thoughtSignature"]);y!=null&&f(e,["thoughtSignature"],y);const T=c(t,["videoMetadata"]);return T!=null&&f(e,["videoMetadata"],T),e}function VP(t){const e={},n=c(t,["category"]);if(n!=null&&f(e,["category"],n),c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=c(t,["threshold"]);return i!=null&&f(e,["threshold"],i),e}function bP(t){const e={},n=c(t,["functionCallingConfig"]);n!=null&&f(e,["functionCallingConfig"],yP(n));const i=c(t,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],i),e}function FP(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let g=n;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["functionDeclarations"],g)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=c(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const r=c(t,["computerUse"]);r!=null&&f(e,["computerUse"],r);const o=c(t,["fileSearch"]);o!=null&&f(e,["fileSearch"],o);const a=c(t,["codeExecution"]);if(a!=null&&f(e,["codeExecution"],a),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=c(t,["googleMaps"]);u!=null&&f(e,["googleMaps"],CP(u));const d=c(t,["googleSearch"]);d!=null&&f(e,["googleSearch"],IP(d));const p=c(t,["urlContext"]);return p!=null&&f(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Pi;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(Pi||(Pi={}));class oo{constructor(e,n,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,i,r)}init(e,n,i){var r,o;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let a={config:{}};!i||Object.keys(i).length===0?a={config:{}}:typeof i=="object"?a=Object.assign({},i):a=i,a.config&&(a.config.pageToken=n.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(o=(r=a.config)===null||r===void 0?void 0:r.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UP extends Li{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new oo(Pi.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=By(this.apiClient,e),i=n._url,r=ie("{model}:batchGenerateContent",i),u=n.batch.inputConfig.requests,d=u.requests,p=[];for(const g of d){const y=Object.assign({},g);if(y.systemInstruction){const T=y.systemInstruction;delete y.systemInstruction;const I=y.request;I.systemInstruction=T,y.request=I}p.push(y)}return u.requests=p,delete n.config,delete n._url,delete n._query,{path:r,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const i=n?Object.assign({},n):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){const o=this.getGcsUri(e),a=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?i.dest=`${o.slice(0,-6)}/dest`:i.dest=`${o}_dest_${r}`;else if(a)i.dest=`${a}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=sP(this.apiClient,e);return u=ie("batchPredictionJobs",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>Mf(g))}else{const p=By(this.apiClient,e);return u=ie("{model}:batchGenerateContent",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),a.then(g=>gc(g))}}async createEmbeddingsInternal(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=lP(this.apiClient,e);return o=ie("{model}:asyncBatchEmbedContent",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>gc(d))}}async get(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=wP(this.apiClient,e);return u=ie("batchPredictionJobs/{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>Mf(g))}else{const p=EP(this.apiClient,e);return u=ie("batches/{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),a.then(g=>gc(g))}}async cancel(e){var n,i,r,o;let a="",u={};if(this.apiClient.isVertexAI()){const d=tP(this.apiClient,e);a=ie("batchPredictionJobs/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const d=eP(this.apiClient,e);a=ie("batches/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=kP(e);return u=ie("batchPredictionJobs",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=LP(g),T=new by;return Object.assign(T,y),T})}else{const p=NP(e);return u=ie("batches",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=MP(g),T=new by;return Object.assign(T,y),T})}}async delete(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=cP(this.apiClient,e);return u=ie("batchPredictionJobs/{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>hP(g))}else{const p=uP(this.apiClient,e);return u=ie("batches/{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>dP(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OP(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function zy(t){const e={},n=c(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>lR(o))),f(e,["parts"],r)}const i=c(t,["role"]);return i!=null&&f(e,["role"],i),e}function BP(t,e){const n={},i=c(t,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const r=c(t,["expireTime"]);e!==void 0&&r!=null&&f(e,["expireTime"],r);const o=c(t,["displayName"]);e!==void 0&&o!=null&&f(e,["displayName"],o);const a=c(t,["contents"]);if(e!==void 0&&a!=null){let g=Pn(a);Array.isArray(g)&&(g=g.map(y=>zy(y))),f(e,["contents"],g)}const u=c(t,["systemInstruction"]);e!==void 0&&u!=null&&f(e,["systemInstruction"],zy(zt(u)));const d=c(t,["tools"]);if(e!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(y=>cR(y))),f(e,["tools"],g)}const p=c(t,["toolConfig"]);if(e!==void 0&&p!=null&&f(e,["toolConfig"],uR(p)),c(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function zP(t,e){const n={},i=c(t,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const r=c(t,["expireTime"]);e!==void 0&&r!=null&&f(e,["expireTime"],r);const o=c(t,["displayName"]);e!==void 0&&o!=null&&f(e,["displayName"],o);const a=c(t,["contents"]);if(e!==void 0&&a!=null){let y=Pn(a);Array.isArray(y)&&(y=y.map(T=>T)),f(e,["contents"],y)}const u=c(t,["systemInstruction"]);e!==void 0&&u!=null&&f(e,["systemInstruction"],zt(u));const d=c(t,["tools"]);if(e!==void 0&&d!=null){let y=d;Array.isArray(y)&&(y=y.map(T=>dR(T))),f(e,["tools"],y)}const p=c(t,["toolConfig"]);e!==void 0&&p!=null&&f(e,["toolConfig"],p);const g=c(t,["kmsKeyName"]);return e!==void 0&&g!=null&&f(e,["encryption_spec","kmsKeyName"],g),n}function qP(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["model"],IE(t,i));const r=c(e,["config"]);return r!=null&&BP(r,n),n}function HP(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["model"],IE(t,i));const r=c(e,["config"]);return r!=null&&zP(r,n),n}function GP(t,e){const n={},i=c(e,["name"]);return i!=null&&f(n,["_url","name"],Di(t,i)),n}function WP(t,e){const n={},i=c(e,["name"]);return i!=null&&f(n,["_url","name"],Di(t,i)),n}function $P(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function KP(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function JP(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function ZP(t){const e={},n=c(t,["id"]);n!=null&&f(e,["id"],n);const i=c(t,["args"]);i!=null&&f(e,["args"],i);const r=c(t,["name"]);if(r!=null&&f(e,["name"],r),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function YP(t){const e={},n=c(t,["mode"]);n!=null&&f(e,["mode"],n);const i=c(t,["allowedFunctionNames"]);if(i!=null&&f(e,["allowedFunctionNames"],i),c(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function QP(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&f(e,["description"],n);const i=c(t,["name"]);i!=null&&f(e,["name"],i);const r=c(t,["parameters"]);r!=null&&f(e,["parameters"],r);const o=c(t,["parametersJsonSchema"]);o!=null&&f(e,["parametersJsonSchema"],o);const a=c(t,["response"]);a!=null&&f(e,["response"],a);const u=c(t,["responseJsonSchema"]);return u!=null&&f(e,["responseJsonSchema"],u),e}function XP(t,e){const n={},i=c(e,["name"]);return i!=null&&f(n,["_url","name"],Di(t,i)),n}function jP(t,e){const n={},i=c(e,["name"]);return i!=null&&f(n,["_url","name"],Di(t,i)),n}function eR(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function tR(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function nR(t,e){const n={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(t,["pageToken"]);return e!==void 0&&r!=null&&f(e,["_query","pageToken"],r),n}function iR(t,e){const n={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(t,["pageToken"]);return e!==void 0&&r!=null&&f(e,["_query","pageToken"],r),n}function rR(t){const e={},n=c(t,["config"]);return n!=null&&nR(n,e),e}function oR(t){const e={},n=c(t,["config"]);return n!=null&&iR(n,e),e}function sR(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(t,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>a)),f(e,["cachedContents"],o)}return e}function aR(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(t,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>a)),f(e,["cachedContents"],o)}return e}function lR(t){const e={},n=c(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const i=c(t,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const r=c(t,["executableCode"]);r!=null&&f(e,["executableCode"],r);const o=c(t,["fileData"]);o!=null&&f(e,["fileData"],JP(o));const a=c(t,["functionCall"]);a!=null&&f(e,["functionCall"],ZP(a));const u=c(t,["functionResponse"]);u!=null&&f(e,["functionResponse"],u);const d=c(t,["inlineData"]);d!=null&&f(e,["inlineData"],OP(d));const p=c(t,["text"]);p!=null&&f(e,["text"],p);const g=c(t,["thought"]);g!=null&&f(e,["thought"],g);const y=c(t,["thoughtSignature"]);y!=null&&f(e,["thoughtSignature"],y);const T=c(t,["videoMetadata"]);return T!=null&&f(e,["videoMetadata"],T),e}function uR(t){const e={},n=c(t,["functionCallingConfig"]);n!=null&&f(e,["functionCallingConfig"],YP(n));const i=c(t,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],i),e}function cR(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let g=n;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["functionDeclarations"],g)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=c(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const r=c(t,["computerUse"]);r!=null&&f(e,["computerUse"],r);const o=c(t,["fileSearch"]);o!=null&&f(e,["fileSearch"],o);const a=c(t,["codeExecution"]);if(a!=null&&f(e,["codeExecution"],a),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=c(t,["googleMaps"]);u!=null&&f(e,["googleMaps"],eR(u));const d=c(t,["googleSearch"]);d!=null&&f(e,["googleSearch"],tR(d));const p=c(t,["urlContext"]);return p!=null&&f(e,["urlContext"],p),e}function dR(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(T=>QP(T))),f(e,["functionDeclarations"],y)}const i=c(t,["retrieval"]);i!=null&&f(e,["retrieval"],i);const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const o=c(t,["computerUse"]);if(o!=null&&f(e,["computerUse"],o),c(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=c(t,["codeExecution"]);a!=null&&f(e,["codeExecution"],a);const u=c(t,["enterpriseWebSearch"]);u!=null&&f(e,["enterpriseWebSearch"],u);const d=c(t,["googleMaps"]);d!=null&&f(e,["googleMaps"],d);const p=c(t,["googleSearch"]);p!=null&&f(e,["googleSearch"],p);const g=c(t,["urlContext"]);return g!=null&&f(e,["urlContext"],g),e}function hR(t,e){const n={},i=c(t,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const r=c(t,["expireTime"]);return e!==void 0&&r!=null&&f(e,["expireTime"],r),n}function fR(t,e){const n={},i=c(t,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const r=c(t,["expireTime"]);return e!==void 0&&r!=null&&f(e,["expireTime"],r),n}function pR(t,e){const n={},i=c(e,["name"]);i!=null&&f(n,["_url","name"],Di(t,i));const r=c(e,["config"]);return r!=null&&hR(r,n),n}function mR(t,e){const n={},i=c(e,["name"]);i!=null&&f(n,["_url","name"],Di(t,i));const r=c(e,["config"]);return r!=null&&fR(r,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gR extends Li{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new oo(Pi.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(n),n)}async create(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=HP(this.apiClient,e);return u=ie("cachedContents",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>g)}else{const p=qP(this.apiClient,e);return u=ie("cachedContents",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),a.then(g=>g)}}async get(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=jP(this.apiClient,e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>g)}else{const p=XP(this.apiClient,e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),a.then(g=>g)}}async delete(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=WP(this.apiClient,e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=KP(g),T=new Dy;return Object.assign(T,y),T})}else{const p=GP(this.apiClient,e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=$P(g),T=new Dy;return Object.assign(T,y),T})}}async update(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=mR(this.apiClient,e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>g)}else{const p=pR(this.apiClient,e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),a.then(g=>g)}}async listInternal(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=oR(e);return u=ie("cachedContents",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=aR(g),T=new Vy;return Object.assign(T,y),T})}else{const p=rR(e);return u=ie("cachedContents",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=sR(g),T=new Vy;return Object.assign(T,y),T})}}}function qy(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Je(t){return this instanceof Je?(this.v=t,this):new Je(t)}function ds(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(I){return function(V){return Promise.resolve(V).then(I,y)}}function u(I,V){i[I]&&(r[I]=function(b){return new Promise(function(q,A){o.push([I,b,q,A])>1||d(I,b)})},V&&(r[I]=V(r[I])))}function d(I,V){try{p(i[I](V))}catch(b){T(o[0][3],b)}}function p(I){I.value instanceof Je?Promise.resolve(I.value.v).then(g,y):T(o[0][2],I)}function g(I){d("next",I)}function y(I){d("throw",I)}function T(I,V){I(V),o.shift(),o.length&&d(o[0][0],o[0][1])}}function el(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof qy=="function"?qy(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(o){n[o]=t[o]&&function(a){return new Promise(function(u,d){a=t[o](a),r(u,d,a.done,a.value)})}}function r(o,a,u,d){Promise.resolve(d).then(function(p){o({value:p,done:u})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _R(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:FE(n)}function FE(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function yR(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Hy(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let i=0;for(;i<n;)if(t[i].role==="user")e.push(t[i]),i++;else{const r=[];let o=!0;for(;i<n&&t[i].role==="model";)r.push(t[i]),o&&!FE(t[i])&&(o=!1),i++;o?e.push(...r):e.pop()}return e}class vR{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new TR(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class TR{constructor(e,n,i,r={},o=[]){this.apiClient=e,this.modelsModule=n,this.model=i,this.config=r,this.history=o,this.sendPromise=Promise.resolve(),yR(o)}async sendMessage(e){var n;await this.sendPromise;const i=zt(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,a,u;const d=await r,p=(a=(o=d.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content,g=d.automaticFunctionCallingHistory,y=this.getHistory(!0).length;let T=[];g!=null&&(T=(u=g.slice(y))!==null&&u!==void 0?u:[]);const I=p?[p]:[];this.recordHistory(i,I,T)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var n;await this.sendPromise;const i=zt(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const o=await r;return this.processStreamResponse(o,i)}getHistory(e=!1){const n=e?Hy(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var i,r;return ds(this,arguments,function*(){var a,u,d,p;const g=[];try{for(var y=!0,T=el(e),I;I=yield Je(T.next()),a=I.done,!a;y=!0){p=I.value,y=!1;const V=p;if(_R(V)){const b=(r=(i=V.candidates)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.content;b!==void 0&&g.push(b)}yield yield Je(V)}}catch(V){u={error:V}}finally{try{!y&&!a&&(d=T.return)&&(yield Je(d.call(T)))}finally{if(u)throw u.error}}this.recordHistory(n,g)})}recordHistory(e,n,i){let r=[];n.length>0&&n.every(o=>o.role!==void 0)?r=n:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...Hy(i)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Id extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Id.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ER(t){const e={},n=c(t,["file"]);return n!=null&&f(e,["file"],n),e}function wR(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function CR(t){const e={},n=c(t,["name"]);return n!=null&&f(e,["_url","file"],NE(n)),e}function IR(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function SR(t){const e={},n=c(t,["name"]);return n!=null&&f(e,["_url","file"],NE(n)),e}function xR(t,e){const n={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(t,["pageToken"]);return e!==void 0&&r!=null&&f(e,["_query","pageToken"],r),n}function AR(t){const e={},n=c(t,["config"]);return n!=null&&xR(n,e),e}function PR(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(t,["files"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>a)),f(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RR extends Li{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new oo(Pi.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=AR(e);return o=ie("files",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:d.headers},g})),r.then(d=>{const p=PR(d),g=new LA;return Object.assign(g,p),g})}}async createInternal(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ER(e);return o=ie("upload/v1beta/files",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const p=wR(d),g=new DA;return Object.assign(g,p),g})}}async get(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=SR(e);return o=ie("files/{file}",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async delete(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=CR(e);return o=ie("files/{file}",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:d.headers},g})),r.then(d=>{const p=IR(d),g=new VA;return Object.assign(g,p),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _c(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function NR(t){const e={},n=c(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>$R(o))),f(e,["parts"],r)}const i=c(t,["role"]);return i!=null&&f(e,["role"],i),e}function kR(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function MR(t){const e={},n=c(t,["id"]);n!=null&&f(e,["id"],n);const i=c(t,["args"]);i!=null&&f(e,["args"],i);const r=c(t,["name"]);if(r!=null&&f(e,["name"],r),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function LR(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&f(e,["description"],n);const i=c(t,["name"]);i!=null&&f(e,["name"],i);const r=c(t,["parameters"]);r!=null&&f(e,["parameters"],r);const o=c(t,["parametersJsonSchema"]);o!=null&&f(e,["parametersJsonSchema"],o);const a=c(t,["response"]);a!=null&&f(e,["response"],a);const u=c(t,["responseJsonSchema"]);return u!=null&&f(e,["responseJsonSchema"],u),e}function DR(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const i=c(t,["responseJsonSchema"]);i!=null&&f(e,["responseJsonSchema"],i);const r=c(t,["audioTimestamp"]);r!=null&&f(e,["audioTimestamp"],r);const o=c(t,["candidateCount"]);o!=null&&f(e,["candidateCount"],o);const a=c(t,["enableAffectiveDialog"]);a!=null&&f(e,["enableAffectiveDialog"],a);const u=c(t,["frequencyPenalty"]);u!=null&&f(e,["frequencyPenalty"],u);const d=c(t,["logprobs"]);d!=null&&f(e,["logprobs"],d);const p=c(t,["maxOutputTokens"]);p!=null&&f(e,["maxOutputTokens"],p);const g=c(t,["mediaResolution"]);g!=null&&f(e,["mediaResolution"],g);const y=c(t,["presencePenalty"]);y!=null&&f(e,["presencePenalty"],y);const T=c(t,["responseLogprobs"]);T!=null&&f(e,["responseLogprobs"],T);const I=c(t,["responseMimeType"]);I!=null&&f(e,["responseMimeType"],I);const V=c(t,["responseModalities"]);V!=null&&f(e,["responseModalities"],V);const b=c(t,["responseSchema"]);b!=null&&f(e,["responseSchema"],b);const q=c(t,["routingConfig"]);q!=null&&f(e,["routingConfig"],q);const A=c(t,["seed"]);A!=null&&f(e,["seed"],A);const x=c(t,["speechConfig"]);x!=null&&f(e,["speechConfig"],UE(x));const R=c(t,["stopSequences"]);R!=null&&f(e,["stopSequences"],R);const z=c(t,["temperature"]);z!=null&&f(e,["temperature"],z);const W=c(t,["thinkingConfig"]);W!=null&&f(e,["thinkingConfig"],W);const J=c(t,["topK"]);J!=null&&f(e,["topK"],J);const k=c(t,["topP"]);if(k!=null&&f(e,["topP"],k),c(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function VR(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function bR(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function FR(t,e){const n={},i=c(t,["generationConfig"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig"],i);const r=c(t,["responseModalities"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig","responseModalities"],r);const o=c(t,["temperature"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","temperature"],o);const a=c(t,["topP"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topP"],a);const u=c(t,["topK"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","topK"],u);const d=c(t,["maxOutputTokens"]);e!==void 0&&d!=null&&f(e,["setup","generationConfig","maxOutputTokens"],d);const p=c(t,["mediaResolution"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","mediaResolution"],p);const g=c(t,["seed"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","seed"],g);const y=c(t,["speechConfig"]);e!==void 0&&y!=null&&f(e,["setup","generationConfig","speechConfig"],am(y));const T=c(t,["thinkingConfig"]);e!==void 0&&T!=null&&f(e,["setup","generationConfig","thinkingConfig"],T);const I=c(t,["enableAffectiveDialog"]);e!==void 0&&I!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],I);const V=c(t,["systemInstruction"]);e!==void 0&&V!=null&&f(e,["setup","systemInstruction"],NR(zt(V)));const b=c(t,["tools"]);if(e!==void 0&&b!=null){let J=Vs(b);Array.isArray(J)&&(J=J.map(k=>JR(Ds(k)))),f(e,["setup","tools"],J)}const q=c(t,["sessionResumption"]);e!==void 0&&q!=null&&f(e,["setup","sessionResumption"],KR(q));const A=c(t,["inputAudioTranscription"]);e!==void 0&&A!=null&&f(e,["setup","inputAudioTranscription"],A);const x=c(t,["outputAudioTranscription"]);e!==void 0&&x!=null&&f(e,["setup","outputAudioTranscription"],x);const R=c(t,["realtimeInputConfig"]);e!==void 0&&R!=null&&f(e,["setup","realtimeInputConfig"],R);const z=c(t,["contextWindowCompression"]);e!==void 0&&z!=null&&f(e,["setup","contextWindowCompression"],z);const W=c(t,["proactivity"]);return e!==void 0&&W!=null&&f(e,["setup","proactivity"],W),n}function UR(t,e){const n={},i=c(t,["generationConfig"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig"],DR(i));const r=c(t,["responseModalities"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig","responseModalities"],r);const o=c(t,["temperature"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","temperature"],o);const a=c(t,["topP"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topP"],a);const u=c(t,["topK"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","topK"],u);const d=c(t,["maxOutputTokens"]);e!==void 0&&d!=null&&f(e,["setup","generationConfig","maxOutputTokens"],d);const p=c(t,["mediaResolution"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","mediaResolution"],p);const g=c(t,["seed"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","seed"],g);const y=c(t,["speechConfig"]);e!==void 0&&y!=null&&f(e,["setup","generationConfig","speechConfig"],UE(am(y)));const T=c(t,["thinkingConfig"]);e!==void 0&&T!=null&&f(e,["setup","generationConfig","thinkingConfig"],T);const I=c(t,["enableAffectiveDialog"]);e!==void 0&&I!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],I);const V=c(t,["systemInstruction"]);e!==void 0&&V!=null&&f(e,["setup","systemInstruction"],zt(V));const b=c(t,["tools"]);if(e!==void 0&&b!=null){let J=Vs(b);Array.isArray(J)&&(J=J.map(k=>ZR(Ds(k)))),f(e,["setup","tools"],J)}const q=c(t,["sessionResumption"]);e!==void 0&&q!=null&&f(e,["setup","sessionResumption"],q);const A=c(t,["inputAudioTranscription"]);e!==void 0&&A!=null&&f(e,["setup","inputAudioTranscription"],A);const x=c(t,["outputAudioTranscription"]);e!==void 0&&x!=null&&f(e,["setup","outputAudioTranscription"],x);const R=c(t,["realtimeInputConfig"]);e!==void 0&&R!=null&&f(e,["setup","realtimeInputConfig"],R);const z=c(t,["contextWindowCompression"]);e!==void 0&&z!=null&&f(e,["setup","contextWindowCompression"],z);const W=c(t,["proactivity"]);return e!==void 0&&W!=null&&f(e,["setup","proactivity"],W),n}function OR(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["setup","model"],be(t,i));const r=c(e,["config"]);return r!=null&&f(n,["config"],FR(r,n)),n}function BR(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["setup","model"],be(t,i));const r=c(e,["config"]);return r!=null&&f(n,["config"],UR(r,n)),n}function zR(t){const e={},n=c(t,["musicGenerationConfig"]);return n!=null&&f(e,["musicGenerationConfig"],n),e}function qR(t){const e={},n=c(t,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>r)),f(e,["weightedPrompts"],i)}return e}function HR(t){const e={},n=c(t,["media"]);if(n!=null){let p=SE(n);Array.isArray(p)&&(p=p.map(g=>_c(g))),f(e,["mediaChunks"],p)}const i=c(t,["audio"]);i!=null&&f(e,["audio"],_c(AE(i)));const r=c(t,["audioStreamEnd"]);r!=null&&f(e,["audioStreamEnd"],r);const o=c(t,["video"]);o!=null&&f(e,["video"],_c(xE(o)));const a=c(t,["text"]);a!=null&&f(e,["text"],a);const u=c(t,["activityStart"]);u!=null&&f(e,["activityStart"],u);const d=c(t,["activityEnd"]);return d!=null&&f(e,["activityEnd"],d),e}function GR(t){const e={},n=c(t,["media"]);if(n!=null){let p=SE(n);Array.isArray(p)&&(p=p.map(g=>g)),f(e,["mediaChunks"],p)}const i=c(t,["audio"]);i!=null&&f(e,["audio"],AE(i));const r=c(t,["audioStreamEnd"]);r!=null&&f(e,["audioStreamEnd"],r);const o=c(t,["video"]);o!=null&&f(e,["video"],xE(o));const a=c(t,["text"]);a!=null&&f(e,["text"],a);const u=c(t,["activityStart"]);u!=null&&f(e,["activityStart"],u);const d=c(t,["activityEnd"]);return d!=null&&f(e,["activityEnd"],d),e}function WR(t){const e={},n=c(t,["setupComplete"]);n!=null&&f(e,["setupComplete"],n);const i=c(t,["serverContent"]);i!=null&&f(e,["serverContent"],i);const r=c(t,["toolCall"]);r!=null&&f(e,["toolCall"],r);const o=c(t,["toolCallCancellation"]);o!=null&&f(e,["toolCallCancellation"],o);const a=c(t,["usageMetadata"]);a!=null&&f(e,["usageMetadata"],YR(a));const u=c(t,["goAway"]);u!=null&&f(e,["goAway"],u);const d=c(t,["sessionResumptionUpdate"]);return d!=null&&f(e,["sessionResumptionUpdate"],d),e}function $R(t){const e={},n=c(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const i=c(t,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const r=c(t,["executableCode"]);r!=null&&f(e,["executableCode"],r);const o=c(t,["fileData"]);o!=null&&f(e,["fileData"],kR(o));const a=c(t,["functionCall"]);a!=null&&f(e,["functionCall"],MR(a));const u=c(t,["functionResponse"]);u!=null&&f(e,["functionResponse"],u);const d=c(t,["inlineData"]);d!=null&&f(e,["inlineData"],_c(d));const p=c(t,["text"]);p!=null&&f(e,["text"],p);const g=c(t,["thought"]);g!=null&&f(e,["thought"],g);const y=c(t,["thoughtSignature"]);y!=null&&f(e,["thoughtSignature"],y);const T=c(t,["videoMetadata"]);return T!=null&&f(e,["videoMetadata"],T),e}function KR(t){const e={},n=c(t,["handle"]);if(n!=null&&f(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function UE(t){const e={},n=c(t,["languageCode"]);n!=null&&f(e,["languageCode"],n);const i=c(t,["voiceConfig"]);if(i!=null&&f(e,["voiceConfig"],i),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function JR(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let g=n;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["functionDeclarations"],g)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=c(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const r=c(t,["computerUse"]);r!=null&&f(e,["computerUse"],r);const o=c(t,["fileSearch"]);o!=null&&f(e,["fileSearch"],o);const a=c(t,["codeExecution"]);if(a!=null&&f(e,["codeExecution"],a),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=c(t,["googleMaps"]);u!=null&&f(e,["googleMaps"],VR(u));const d=c(t,["googleSearch"]);d!=null&&f(e,["googleSearch"],bR(d));const p=c(t,["urlContext"]);return p!=null&&f(e,["urlContext"],p),e}function ZR(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(T=>LR(T))),f(e,["functionDeclarations"],y)}const i=c(t,["retrieval"]);i!=null&&f(e,["retrieval"],i);const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const o=c(t,["computerUse"]);if(o!=null&&f(e,["computerUse"],o),c(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=c(t,["codeExecution"]);a!=null&&f(e,["codeExecution"],a);const u=c(t,["enterpriseWebSearch"]);u!=null&&f(e,["enterpriseWebSearch"],u);const d=c(t,["googleMaps"]);d!=null&&f(e,["googleMaps"],d);const p=c(t,["googleSearch"]);p!=null&&f(e,["googleSearch"],p);const g=c(t,["urlContext"]);return g!=null&&f(e,["urlContext"],g),e}function YR(t){const e={},n=c(t,["promptTokenCount"]);n!=null&&f(e,["promptTokenCount"],n);const i=c(t,["cachedContentTokenCount"]);i!=null&&f(e,["cachedContentTokenCount"],i);const r=c(t,["candidatesTokenCount"]);r!=null&&f(e,["responseTokenCount"],r);const o=c(t,["toolUsePromptTokenCount"]);o!=null&&f(e,["toolUsePromptTokenCount"],o);const a=c(t,["thoughtsTokenCount"]);a!=null&&f(e,["thoughtsTokenCount"],a);const u=c(t,["totalTokenCount"]);u!=null&&f(e,["totalTokenCount"],u);const d=c(t,["promptTokensDetails"]);if(d!=null){let I=d;Array.isArray(I)&&(I=I.map(V=>V)),f(e,["promptTokensDetails"],I)}const p=c(t,["cacheTokensDetails"]);if(p!=null){let I=p;Array.isArray(I)&&(I=I.map(V=>V)),f(e,["cacheTokensDetails"],I)}const g=c(t,["candidatesTokensDetails"]);if(g!=null){let I=g;Array.isArray(I)&&(I=I.map(V=>V)),f(e,["responseTokensDetails"],I)}const y=c(t,["toolUsePromptTokensDetails"]);if(y!=null){let I=y;Array.isArray(I)&&(I=I.map(V=>V)),f(e,["toolUsePromptTokensDetails"],I)}const T=c(t,["trafficType"]);return T!=null&&f(e,["trafficType"],T),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QR(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function XR(t){const e={},n=c(t,["content"]);n!=null&&f(e,["content"],n);const i=c(t,["citationMetadata"]);i!=null&&f(e,["citationMetadata"],jR(i));const r=c(t,["tokenCount"]);r!=null&&f(e,["tokenCount"],r);const o=c(t,["finishReason"]);o!=null&&f(e,["finishReason"],o);const a=c(t,["avgLogprobs"]);a!=null&&f(e,["avgLogprobs"],a);const u=c(t,["groundingMetadata"]);u!=null&&f(e,["groundingMetadata"],u);const d=c(t,["index"]);d!=null&&f(e,["index"],d);const p=c(t,["logprobsResult"]);p!=null&&f(e,["logprobsResult"],p);const g=c(t,["safetyRatings"]);if(g!=null){let T=g;Array.isArray(T)&&(T=T.map(I=>I)),f(e,["safetyRatings"],T)}const y=c(t,["urlContextMetadata"]);return y!=null&&f(e,["urlContextMetadata"],y),e}function jR(t){const e={},n=c(t,["citationSources"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>r)),f(e,["citations"],i)}return e}function eN(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["contents"]);if(r!=null){let o=Pn(r);Array.isArray(o)&&(o=o.map(a=>a)),f(n,["contents"],o)}return n}function tN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["tokensInfo"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["tokensInfo"],r)}return e}function nN(t){const e={},n=c(t,["values"]);n!=null&&f(e,["values"],n);const i=c(t,["statistics"]);return i!=null&&f(e,["statistics"],iN(i)),e}function iN(t){const e={},n=c(t,["truncated"]);n!=null&&f(e,["truncated"],n);const i=c(t,["token_count"]);return i!=null&&f(e,["tokenCount"],i),e}function Sd(t){const e={},n=c(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>h1(o))),f(e,["parts"],r)}const i=c(t,["role"]);return i!=null&&f(e,["role"],i),e}function rN(t){const e={},n=c(t,["controlType"]);n!=null&&f(e,["controlType"],n);const i=c(t,["enableControlImageComputation"]);return i!=null&&f(e,["computeControl"],i),e}function oN(t){const e={};if(c(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function sN(t,e){const n={},i=c(t,["systemInstruction"]);e!==void 0&&i!=null&&f(e,["systemInstruction"],zt(i));const r=c(t,["tools"]);if(e!==void 0&&r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>HE(u))),f(e,["tools"],a)}const o=c(t,["generationConfig"]);return e!==void 0&&o!=null&&f(e,["generationConfig"],QN(o)),n}function aN(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["contents"]);if(r!=null){let a=Pn(r);Array.isArray(a)&&(a=a.map(u=>Sd(u))),f(n,["contents"],a)}const o=c(e,["config"]);return o!=null&&oN(o),n}function lN(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["contents"]);if(r!=null){let a=Pn(r);Array.isArray(a)&&(a=a.map(u=>u)),f(n,["contents"],a)}const o=c(e,["config"]);return o!=null&&sN(o,n),n}function uN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["totalTokens"]);i!=null&&f(e,["totalTokens"],i);const r=c(t,["cachedContentTokenCount"]);return r!=null&&f(e,["cachedContentTokenCount"],r),e}function cN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["totalTokens"]);return i!=null&&f(e,["totalTokens"],i),e}function dN(t,e){const n={},i=c(e,["model"]);return i!=null&&f(n,["_url","name"],be(t,i)),n}function hN(t,e){const n={},i=c(e,["model"]);return i!=null&&f(n,["_url","name"],be(t,i)),n}function fN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function pN(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function mN(t,e){const n={},i=c(t,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const r=c(t,["negativePrompt"]);e!==void 0&&r!=null&&f(e,["parameters","negativePrompt"],r);const o=c(t,["numberOfImages"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const a=c(t,["aspectRatio"]);e!==void 0&&a!=null&&f(e,["parameters","aspectRatio"],a);const u=c(t,["guidanceScale"]);e!==void 0&&u!=null&&f(e,["parameters","guidanceScale"],u);const d=c(t,["seed"]);e!==void 0&&d!=null&&f(e,["parameters","seed"],d);const p=c(t,["safetyFilterLevel"]);e!==void 0&&p!=null&&f(e,["parameters","safetySetting"],p);const g=c(t,["personGeneration"]);e!==void 0&&g!=null&&f(e,["parameters","personGeneration"],g);const y=c(t,["includeSafetyAttributes"]);e!==void 0&&y!=null&&f(e,["parameters","includeSafetyAttributes"],y);const T=c(t,["includeRaiReason"]);e!==void 0&&T!=null&&f(e,["parameters","includeRaiReason"],T);const I=c(t,["language"]);e!==void 0&&I!=null&&f(e,["parameters","language"],I);const V=c(t,["outputMimeType"]);e!==void 0&&V!=null&&f(e,["parameters","outputOptions","mimeType"],V);const b=c(t,["outputCompressionQuality"]);e!==void 0&&b!=null&&f(e,["parameters","outputOptions","compressionQuality"],b);const q=c(t,["addWatermark"]);e!==void 0&&q!=null&&f(e,["parameters","addWatermark"],q);const A=c(t,["labels"]);e!==void 0&&A!=null&&f(e,["labels"],A);const x=c(t,["editMode"]);e!==void 0&&x!=null&&f(e,["parameters","editMode"],x);const R=c(t,["baseSteps"]);return e!==void 0&&R!=null&&f(e,["parameters","editConfig","baseSteps"],R),n}function gN(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["prompt"]);r!=null&&f(n,["instances[0]","prompt"],r);const o=c(e,["referenceImages"]);if(o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>y1(d))),f(n,["instances[0]","referenceImages"],u)}const a=c(e,["config"]);return a!=null&&mN(a,n),n}function _N(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>xd(o))),f(e,["generatedImages"],r)}return e}function yN(t,e){const n={},i=c(t,["taskType"]);e!==void 0&&i!=null&&f(e,["requests[]","taskType"],i);const r=c(t,["title"]);e!==void 0&&r!=null&&f(e,["requests[]","title"],r);const o=c(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&f(e,["requests[]","outputDimensionality"],o),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function vN(t,e){const n={},i=c(t,["taskType"]);e!==void 0&&i!=null&&f(e,["instances[]","task_type"],i);const r=c(t,["title"]);e!==void 0&&r!=null&&f(e,["instances[]","title"],r);const o=c(t,["outputDimensionality"]);e!==void 0&&o!=null&&f(e,["parameters","outputDimensionality"],o);const a=c(t,["mimeType"]);e!==void 0&&a!=null&&f(e,["instances[]","mimeType"],a);const u=c(t,["autoTruncate"]);return e!==void 0&&u!=null&&f(e,["parameters","autoTruncate"],u),n}function TN(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["contents"]);if(r!=null){let u=rm(t,r);Array.isArray(u)&&(u=u.map(d=>d)),f(n,["requests[]","content"],u)}const o=c(e,["config"]);o!=null&&yN(o,n);const a=c(e,["model"]);return a!==void 0&&f(n,["requests[]","model"],be(t,a)),n}function EN(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["contents"]);if(r!=null){let a=rm(t,r);Array.isArray(a)&&(a=a.map(u=>u)),f(n,["instances[]","content"],a)}const o=c(e,["config"]);return o!=null&&vN(o,n),n}function wN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>a)),f(e,["embeddings"],o)}const r=c(t,["metadata"]);return r!=null&&f(e,["metadata"],r),e}function CN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["predictions[]","embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>nN(a))),f(e,["embeddings"],o)}const r=c(t,["metadata"]);return r!=null&&f(e,["metadata"],r),e}function IN(t){const e={},n=c(t,["endpoint"]);n!=null&&f(e,["name"],n);const i=c(t,["deployedModelId"]);return i!=null&&f(e,["deployedModelId"],i),e}function SN(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function xN(t){const e={},n=c(t,["id"]);n!=null&&f(e,["id"],n);const i=c(t,["args"]);i!=null&&f(e,["args"],i);const r=c(t,["name"]);if(r!=null&&f(e,["name"],r),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function AN(t){const e={},n=c(t,["mode"]);n!=null&&f(e,["mode"],n);const i=c(t,["allowedFunctionNames"]);if(i!=null&&f(e,["allowedFunctionNames"],i),c(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function PN(t){const e={};if(c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(t,["description"]);n!=null&&f(e,["description"],n);const i=c(t,["name"]);i!=null&&f(e,["name"],i);const r=c(t,["parameters"]);r!=null&&f(e,["parameters"],r);const o=c(t,["parametersJsonSchema"]);o!=null&&f(e,["parametersJsonSchema"],o);const a=c(t,["response"]);a!=null&&f(e,["response"],a);const u=c(t,["responseJsonSchema"]);return u!=null&&f(e,["responseJsonSchema"],u),e}function RN(t,e,n){const i={},r=c(e,["systemInstruction"]);n!==void 0&&r!=null&&f(n,["systemInstruction"],Sd(zt(r)));const o=c(e,["temperature"]);o!=null&&f(i,["temperature"],o);const a=c(e,["topP"]);a!=null&&f(i,["topP"],a);const u=c(e,["topK"]);u!=null&&f(i,["topK"],u);const d=c(e,["candidateCount"]);d!=null&&f(i,["candidateCount"],d);const p=c(e,["maxOutputTokens"]);p!=null&&f(i,["maxOutputTokens"],p);const g=c(e,["stopSequences"]);g!=null&&f(i,["stopSequences"],g);const y=c(e,["responseLogprobs"]);y!=null&&f(i,["responseLogprobs"],y);const T=c(e,["logprobs"]);T!=null&&f(i,["logprobs"],T);const I=c(e,["presencePenalty"]);I!=null&&f(i,["presencePenalty"],I);const V=c(e,["frequencyPenalty"]);V!=null&&f(i,["frequencyPenalty"],V);const b=c(e,["seed"]);b!=null&&f(i,["seed"],b);const q=c(e,["responseMimeType"]);q!=null&&f(i,["responseMimeType"],q);const A=c(e,["responseSchema"]);A!=null&&f(i,["responseSchema"],om(A));const x=c(e,["responseJsonSchema"]);if(x!=null&&f(i,["responseJsonSchema"],x),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const R=c(e,["safetySettings"]);if(n!==void 0&&R!=null){let U=R;Array.isArray(U)&&(U=U.map(M=>v1(M))),f(n,["safetySettings"],U)}const z=c(e,["tools"]);if(n!==void 0&&z!=null){let U=Vs(z);Array.isArray(U)&&(U=U.map(M=>x1(Ds(M)))),f(n,["tools"],U)}const W=c(e,["toolConfig"]);if(n!==void 0&&W!=null&&f(n,["toolConfig"],S1(W)),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const J=c(e,["cachedContent"]);n!==void 0&&J!=null&&f(n,["cachedContent"],Di(t,J));const k=c(e,["responseModalities"]);k!=null&&f(i,["responseModalities"],k);const N=c(e,["mediaResolution"]);N!=null&&f(i,["mediaResolution"],N);const D=c(e,["speechConfig"]);if(D!=null&&f(i,["speechConfig"],sm(D)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const F=c(e,["thinkingConfig"]);F!=null&&f(i,["thinkingConfig"],F);const B=c(e,["imageConfig"]);return B!=null&&f(i,["imageConfig"],n1(B)),i}function NN(t,e,n){const i={},r=c(e,["systemInstruction"]);n!==void 0&&r!=null&&f(n,["systemInstruction"],zt(r));const o=c(e,["temperature"]);o!=null&&f(i,["temperature"],o);const a=c(e,["topP"]);a!=null&&f(i,["topP"],a);const u=c(e,["topK"]);u!=null&&f(i,["topK"],u);const d=c(e,["candidateCount"]);d!=null&&f(i,["candidateCount"],d);const p=c(e,["maxOutputTokens"]);p!=null&&f(i,["maxOutputTokens"],p);const g=c(e,["stopSequences"]);g!=null&&f(i,["stopSequences"],g);const y=c(e,["responseLogprobs"]);y!=null&&f(i,["responseLogprobs"],y);const T=c(e,["logprobs"]);T!=null&&f(i,["logprobs"],T);const I=c(e,["presencePenalty"]);I!=null&&f(i,["presencePenalty"],I);const V=c(e,["frequencyPenalty"]);V!=null&&f(i,["frequencyPenalty"],V);const b=c(e,["seed"]);b!=null&&f(i,["seed"],b);const q=c(e,["responseMimeType"]);q!=null&&f(i,["responseMimeType"],q);const A=c(e,["responseSchema"]);A!=null&&f(i,["responseSchema"],om(A));const x=c(e,["responseJsonSchema"]);x!=null&&f(i,["responseJsonSchema"],x);const R=c(e,["routingConfig"]);R!=null&&f(i,["routingConfig"],R);const z=c(e,["modelSelectionConfig"]);z!=null&&f(i,["modelConfig"],z);const W=c(e,["safetySettings"]);if(n!==void 0&&W!=null){let we=W;Array.isArray(we)&&(we=we.map(Fe=>Fe)),f(n,["safetySettings"],we)}const J=c(e,["tools"]);if(n!==void 0&&J!=null){let we=Vs(J);Array.isArray(we)&&(we=we.map(Fe=>HE(Ds(Fe)))),f(n,["tools"],we)}const k=c(e,["toolConfig"]);n!==void 0&&k!=null&&f(n,["toolConfig"],k);const N=c(e,["labels"]);n!==void 0&&N!=null&&f(n,["labels"],N);const D=c(e,["cachedContent"]);n!==void 0&&D!=null&&f(n,["cachedContent"],Di(t,D));const F=c(e,["responseModalities"]);F!=null&&f(i,["responseModalities"],F);const B=c(e,["mediaResolution"]);B!=null&&f(i,["mediaResolution"],B);const U=c(e,["speechConfig"]);U!=null&&f(i,["speechConfig"],qE(sm(U)));const M=c(e,["audioTimestamp"]);M!=null&&f(i,["audioTimestamp"],M);const le=c(e,["thinkingConfig"]);le!=null&&f(i,["thinkingConfig"],le);const De=c(e,["imageConfig"]);return De!=null&&f(i,["imageConfig"],i1(De)),i}function Gy(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["contents"]);if(r!=null){let a=Pn(r);Array.isArray(a)&&(a=a.map(u=>Sd(u))),f(n,["contents"],a)}const o=c(e,["config"]);return o!=null&&f(n,["generationConfig"],RN(t,o,n)),n}function Wy(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["contents"]);if(r!=null){let a=Pn(r);Array.isArray(a)&&(a=a.map(u=>u)),f(n,["contents"],a)}const o=c(e,["config"]);return o!=null&&f(n,["generationConfig"],NN(t,o,n)),n}function $y(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["candidates"]);if(i!=null){let d=i;Array.isArray(d)&&(d=d.map(p=>XR(p))),f(e,["candidates"],d)}const r=c(t,["modelVersion"]);r!=null&&f(e,["modelVersion"],r);const o=c(t,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const a=c(t,["responseId"]);a!=null&&f(e,["responseId"],a);const u=c(t,["usageMetadata"]);return u!=null&&f(e,["usageMetadata"],u),e}function Ky(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(g=>g)),f(e,["candidates"],p)}const r=c(t,["createTime"]);r!=null&&f(e,["createTime"],r);const o=c(t,["modelVersion"]);o!=null&&f(e,["modelVersion"],o);const a=c(t,["promptFeedback"]);a!=null&&f(e,["promptFeedback"],a);const u=c(t,["responseId"]);u!=null&&f(e,["responseId"],u);const d=c(t,["usageMetadata"]);return d!=null&&f(e,["usageMetadata"],d),e}function kN(t,e){const n={};if(c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=c(t,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const r=c(t,["aspectRatio"]);e!==void 0&&r!=null&&f(e,["parameters","aspectRatio"],r);const o=c(t,["guidanceScale"]);if(e!==void 0&&o!=null&&f(e,["parameters","guidanceScale"],o),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=c(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&f(e,["parameters","safetySetting"],a);const u=c(t,["personGeneration"]);e!==void 0&&u!=null&&f(e,["parameters","personGeneration"],u);const d=c(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&f(e,["parameters","includeSafetyAttributes"],d);const p=c(t,["includeRaiReason"]);e!==void 0&&p!=null&&f(e,["parameters","includeRaiReason"],p);const g=c(t,["language"]);e!==void 0&&g!=null&&f(e,["parameters","language"],g);const y=c(t,["outputMimeType"]);e!==void 0&&y!=null&&f(e,["parameters","outputOptions","mimeType"],y);const T=c(t,["outputCompressionQuality"]);if(e!==void 0&&T!=null&&f(e,["parameters","outputOptions","compressionQuality"],T),c(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const I=c(t,["imageSize"]);if(e!==void 0&&I!=null&&f(e,["parameters","sampleImageSize"],I),c(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function MN(t,e){const n={},i=c(t,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const r=c(t,["negativePrompt"]);e!==void 0&&r!=null&&f(e,["parameters","negativePrompt"],r);const o=c(t,["numberOfImages"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const a=c(t,["aspectRatio"]);e!==void 0&&a!=null&&f(e,["parameters","aspectRatio"],a);const u=c(t,["guidanceScale"]);e!==void 0&&u!=null&&f(e,["parameters","guidanceScale"],u);const d=c(t,["seed"]);e!==void 0&&d!=null&&f(e,["parameters","seed"],d);const p=c(t,["safetyFilterLevel"]);e!==void 0&&p!=null&&f(e,["parameters","safetySetting"],p);const g=c(t,["personGeneration"]);e!==void 0&&g!=null&&f(e,["parameters","personGeneration"],g);const y=c(t,["includeSafetyAttributes"]);e!==void 0&&y!=null&&f(e,["parameters","includeSafetyAttributes"],y);const T=c(t,["includeRaiReason"]);e!==void 0&&T!=null&&f(e,["parameters","includeRaiReason"],T);const I=c(t,["language"]);e!==void 0&&I!=null&&f(e,["parameters","language"],I);const V=c(t,["outputMimeType"]);e!==void 0&&V!=null&&f(e,["parameters","outputOptions","mimeType"],V);const b=c(t,["outputCompressionQuality"]);e!==void 0&&b!=null&&f(e,["parameters","outputOptions","compressionQuality"],b);const q=c(t,["addWatermark"]);e!==void 0&&q!=null&&f(e,["parameters","addWatermark"],q);const A=c(t,["labels"]);e!==void 0&&A!=null&&f(e,["labels"],A);const x=c(t,["imageSize"]);e!==void 0&&x!=null&&f(e,["parameters","sampleImageSize"],x);const R=c(t,["enhancePrompt"]);return e!==void 0&&R!=null&&f(e,["parameters","enhancePrompt"],R),n}function LN(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["prompt"]);r!=null&&f(n,["instances[0]","prompt"],r);const o=c(e,["config"]);return o!=null&&kN(o,n),n}function DN(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["prompt"]);r!=null&&f(n,["instances[0]","prompt"],r);const o=c(e,["config"]);return o!=null&&MN(o,n),n}function VN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>KN(a))),f(e,["generatedImages"],o)}const r=c(t,["positivePromptSafetyAttributes"]);return r!=null&&f(e,["positivePromptSafetyAttributes"],BE(r)),e}function bN(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>xd(a))),f(e,["generatedImages"],o)}const r=c(t,["positivePromptSafetyAttributes"]);return r!=null&&f(e,["positivePromptSafetyAttributes"],zE(r)),e}function FN(t,e){const n={},i=c(t,["numberOfVideos"]);if(e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i),c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=c(t,["durationSeconds"]);if(e!==void 0&&r!=null&&f(e,["parameters","durationSeconds"],r),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const a=c(t,["resolution"]);e!==void 0&&a!=null&&f(e,["parameters","resolution"],a);const u=c(t,["personGeneration"]);if(e!==void 0&&u!=null&&f(e,["parameters","personGeneration"],u),c(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=c(t,["negativePrompt"]);e!==void 0&&d!=null&&f(e,["parameters","negativePrompt"],d);const p=c(t,["enhancePrompt"]);if(e!==void 0&&p!=null&&f(e,["parameters","enhancePrompt"],p),c(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const g=c(t,["lastFrame"]);e!==void 0&&g!=null&&f(e,["instances[0]","lastFrame"],Ad(g));const y=c(t,["referenceImages"]);if(e!==void 0&&y!=null){let T=y;Array.isArray(T)&&(T=T.map(I=>O1(I))),f(e,["instances[0]","referenceImages"],T)}if(c(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(c(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function UN(t,e){const n={},i=c(t,["numberOfVideos"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const o=c(t,["fps"]);e!==void 0&&o!=null&&f(e,["parameters","fps"],o);const a=c(t,["durationSeconds"]);e!==void 0&&a!=null&&f(e,["parameters","durationSeconds"],a);const u=c(t,["seed"]);e!==void 0&&u!=null&&f(e,["parameters","seed"],u);const d=c(t,["aspectRatio"]);e!==void 0&&d!=null&&f(e,["parameters","aspectRatio"],d);const p=c(t,["resolution"]);e!==void 0&&p!=null&&f(e,["parameters","resolution"],p);const g=c(t,["personGeneration"]);e!==void 0&&g!=null&&f(e,["parameters","personGeneration"],g);const y=c(t,["pubsubTopic"]);e!==void 0&&y!=null&&f(e,["parameters","pubsubTopic"],y);const T=c(t,["negativePrompt"]);e!==void 0&&T!=null&&f(e,["parameters","negativePrompt"],T);const I=c(t,["enhancePrompt"]);e!==void 0&&I!=null&&f(e,["parameters","enhancePrompt"],I);const V=c(t,["generateAudio"]);e!==void 0&&V!=null&&f(e,["parameters","generateAudio"],V);const b=c(t,["lastFrame"]);e!==void 0&&b!=null&&f(e,["instances[0]","lastFrame"],Wn(b));const q=c(t,["referenceImages"]);if(e!==void 0&&q!=null){let R=q;Array.isArray(R)&&(R=R.map(z=>B1(z))),f(e,["instances[0]","referenceImages"],R)}const A=c(t,["mask"]);e!==void 0&&A!=null&&f(e,["instances[0]","mask"],U1(A));const x=c(t,["compressionQuality"]);return e!==void 0&&x!=null&&f(e,["parameters","compressionQuality"],x),n}function ON(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const i=c(t,["metadata"]);i!=null&&f(e,["metadata"],i);const r=c(t,["done"]);r!=null&&f(e,["done"],r);const o=c(t,["error"]);o!=null&&f(e,["error"],o);const a=c(t,["response","generateVideoResponse"]);return a!=null&&f(e,["response"],HN(a)),e}function BN(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const i=c(t,["metadata"]);i!=null&&f(e,["metadata"],i);const r=c(t,["done"]);r!=null&&f(e,["done"],r);const o=c(t,["error"]);o!=null&&f(e,["error"],o);const a=c(t,["response"]);return a!=null&&f(e,["response"],GN(a)),e}function zN(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["prompt"]);r!=null&&f(n,["instances[0]","prompt"],r);const o=c(e,["image"]);o!=null&&f(n,["instances[0]","image"],Ad(o));const a=c(e,["video"]);a!=null&&f(n,["instances[0]","video"],GE(a));const u=c(e,["source"]);u!=null&&WN(u,n);const d=c(e,["config"]);return d!=null&&FN(d,n),n}function qN(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["prompt"]);r!=null&&f(n,["instances[0]","prompt"],r);const o=c(e,["image"]);o!=null&&f(n,["instances[0]","image"],Wn(o));const a=c(e,["video"]);a!=null&&f(n,["instances[0]","video"],WE(a));const u=c(e,["source"]);u!=null&&$N(u,n);const d=c(e,["config"]);return d!=null&&UN(d,n),n}function HN(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>ZN(a))),f(e,["generatedVideos"],o)}const i=c(t,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const r=c(t,["raiMediaFilteredReasons"]);return r!=null&&f(e,["raiMediaFilteredReasons"],r),e}function GN(t){const e={},n=c(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(a=>YN(a))),f(e,["generatedVideos"],o)}const i=c(t,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const r=c(t,["raiMediaFilteredReasons"]);return r!=null&&f(e,["raiMediaFilteredReasons"],r),e}function WN(t,e){const n={},i=c(t,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const r=c(t,["image"]);e!==void 0&&r!=null&&f(e,["instances[0]","image"],Ad(r));const o=c(t,["video"]);return e!==void 0&&o!=null&&f(e,["instances[0]","video"],GE(o)),n}function $N(t,e){const n={},i=c(t,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const r=c(t,["image"]);e!==void 0&&r!=null&&f(e,["instances[0]","image"],Wn(r));const o=c(t,["video"]);return e!==void 0&&o!=null&&f(e,["instances[0]","video"],WE(o)),n}function KN(t){const e={},n=c(t,["_self"]);n!=null&&f(e,["image"],r1(n));const i=c(t,["raiFilteredReason"]);i!=null&&f(e,["raiFilteredReason"],i);const r=c(t,["_self"]);return r!=null&&f(e,["safetyAttributes"],BE(r)),e}function xd(t){const e={},n=c(t,["_self"]);n!=null&&f(e,["image"],OE(n));const i=c(t,["raiFilteredReason"]);i!=null&&f(e,["raiFilteredReason"],i);const r=c(t,["_self"]);r!=null&&f(e,["safetyAttributes"],zE(r));const o=c(t,["prompt"]);return o!=null&&f(e,["enhancedPrompt"],o),e}function JN(t){const e={},n=c(t,["_self"]);n!=null&&f(e,["mask"],OE(n));const i=c(t,["labels"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["labels"],r)}return e}function ZN(t){const e={},n=c(t,["video"]);return n!=null&&f(e,["video"],b1(n)),e}function YN(t){const e={},n=c(t,["_self"]);return n!=null&&f(e,["video"],F1(n)),e}function QN(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const i=c(t,["responseJsonSchema"]);i!=null&&f(e,["responseJsonSchema"],i);const r=c(t,["audioTimestamp"]);r!=null&&f(e,["audioTimestamp"],r);const o=c(t,["candidateCount"]);o!=null&&f(e,["candidateCount"],o);const a=c(t,["enableAffectiveDialog"]);a!=null&&f(e,["enableAffectiveDialog"],a);const u=c(t,["frequencyPenalty"]);u!=null&&f(e,["frequencyPenalty"],u);const d=c(t,["logprobs"]);d!=null&&f(e,["logprobs"],d);const p=c(t,["maxOutputTokens"]);p!=null&&f(e,["maxOutputTokens"],p);const g=c(t,["mediaResolution"]);g!=null&&f(e,["mediaResolution"],g);const y=c(t,["presencePenalty"]);y!=null&&f(e,["presencePenalty"],y);const T=c(t,["responseLogprobs"]);T!=null&&f(e,["responseLogprobs"],T);const I=c(t,["responseMimeType"]);I!=null&&f(e,["responseMimeType"],I);const V=c(t,["responseModalities"]);V!=null&&f(e,["responseModalities"],V);const b=c(t,["responseSchema"]);b!=null&&f(e,["responseSchema"],b);const q=c(t,["routingConfig"]);q!=null&&f(e,["routingConfig"],q);const A=c(t,["seed"]);A!=null&&f(e,["seed"],A);const x=c(t,["speechConfig"]);x!=null&&f(e,["speechConfig"],qE(x));const R=c(t,["stopSequences"]);R!=null&&f(e,["stopSequences"],R);const z=c(t,["temperature"]);z!=null&&f(e,["temperature"],z);const W=c(t,["thinkingConfig"]);W!=null&&f(e,["thinkingConfig"],W);const J=c(t,["topK"]);J!=null&&f(e,["topK"],J);const k=c(t,["topP"]);if(k!=null&&f(e,["topP"],k),c(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function XN(t,e){const n={},i=c(e,["model"]);return i!=null&&f(n,["_url","name"],be(t,i)),n}function jN(t,e){const n={},i=c(e,["model"]);return i!=null&&f(n,["_url","name"],be(t,i)),n}function e1(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function t1(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function n1(t){const e={},n=c(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const i=c(t,["imageSize"]);if(i!=null&&f(e,["imageSize"],i),c(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(c(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function i1(t){const e={},n=c(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const i=c(t,["imageSize"]);i!=null&&f(e,["imageSize"],i);const r=c(t,["outputMimeType"]);r!=null&&f(e,["imageOutputOptions","mimeType"],r);const o=c(t,["outputCompressionQuality"]);return o!=null&&f(e,["imageOutputOptions","compressionQuality"],o),e}function r1(t){const e={},n=c(t,["bytesBase64Encoded"]);n!=null&&f(e,["imageBytes"],Tr(n));const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function OE(t){const e={},n=c(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const i=c(t,["bytesBase64Encoded"]);i!=null&&f(e,["imageBytes"],Tr(i));const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Ad(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(t,["imageBytes"]);n!=null&&f(e,["bytesBase64Encoded"],Tr(n));const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function Wn(t){const e={},n=c(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const i=c(t,["imageBytes"]);i!=null&&f(e,["bytesBase64Encoded"],Tr(i));const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function o1(t,e,n){const i={},r=c(e,["pageSize"]);n!==void 0&&r!=null&&f(n,["_query","pageSize"],r);const o=c(e,["pageToken"]);n!==void 0&&o!=null&&f(n,["_query","pageToken"],o);const a=c(e,["filter"]);n!==void 0&&a!=null&&f(n,["_query","filter"],a);const u=c(e,["queryBase"]);return n!==void 0&&u!=null&&f(n,["_url","models_url"],kE(t,u)),i}function s1(t,e,n){const i={},r=c(e,["pageSize"]);n!==void 0&&r!=null&&f(n,["_query","pageSize"],r);const o=c(e,["pageToken"]);n!==void 0&&o!=null&&f(n,["_query","pageToken"],o);const a=c(e,["filter"]);n!==void 0&&a!=null&&f(n,["_query","filter"],a);const u=c(e,["queryBase"]);return n!==void 0&&u!=null&&f(n,["_url","models_url"],kE(t,u)),i}function a1(t,e){const n={},i=c(e,["config"]);return i!=null&&o1(t,i,n),n}function l1(t,e){const n={},i=c(e,["config"]);return i!=null&&s1(t,i,n),n}function u1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(t,["_self"]);if(r!=null){let o=ME(r);Array.isArray(o)&&(o=o.map(a=>Lf(a))),f(e,["models"],o)}return e}function c1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(t,["_self"]);if(r!=null){let o=ME(r);Array.isArray(o)&&(o=o.map(a=>Df(a))),f(e,["models"],o)}return e}function d1(t){const e={},n=c(t,["maskMode"]);n!=null&&f(e,["maskMode"],n);const i=c(t,["segmentationClasses"]);i!=null&&f(e,["maskClasses"],i);const r=c(t,["maskDilation"]);return r!=null&&f(e,["dilation"],r),e}function Lf(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const i=c(t,["displayName"]);i!=null&&f(e,["displayName"],i);const r=c(t,["description"]);r!=null&&f(e,["description"],r);const o=c(t,["version"]);o!=null&&f(e,["version"],o);const a=c(t,["_self"]);a!=null&&f(e,["tunedModelInfo"],A1(a));const u=c(t,["inputTokenLimit"]);u!=null&&f(e,["inputTokenLimit"],u);const d=c(t,["outputTokenLimit"]);d!=null&&f(e,["outputTokenLimit"],d);const p=c(t,["supportedGenerationMethods"]);p!=null&&f(e,["supportedActions"],p);const g=c(t,["temperature"]);g!=null&&f(e,["temperature"],g);const y=c(t,["maxTemperature"]);y!=null&&f(e,["maxTemperature"],y);const T=c(t,["topP"]);T!=null&&f(e,["topP"],T);const I=c(t,["topK"]);I!=null&&f(e,["topK"],I);const V=c(t,["thinking"]);return V!=null&&f(e,["thinking"],V),e}function Df(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const i=c(t,["displayName"]);i!=null&&f(e,["displayName"],i);const r=c(t,["description"]);r!=null&&f(e,["description"],r);const o=c(t,["versionId"]);o!=null&&f(e,["version"],o);const a=c(t,["deployedModels"]);if(a!=null){let y=a;Array.isArray(y)&&(y=y.map(T=>IN(T))),f(e,["endpoints"],y)}const u=c(t,["labels"]);u!=null&&f(e,["labels"],u);const d=c(t,["_self"]);d!=null&&f(e,["tunedModelInfo"],P1(d));const p=c(t,["defaultCheckpointId"]);p!=null&&f(e,["defaultCheckpointId"],p);const g=c(t,["checkpoints"]);if(g!=null){let y=g;Array.isArray(y)&&(y=y.map(T=>T)),f(e,["checkpoints"],y)}return e}function h1(t){const e={},n=c(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const i=c(t,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const r=c(t,["executableCode"]);r!=null&&f(e,["executableCode"],r);const o=c(t,["fileData"]);o!=null&&f(e,["fileData"],SN(o));const a=c(t,["functionCall"]);a!=null&&f(e,["functionCall"],xN(a));const u=c(t,["functionResponse"]);u!=null&&f(e,["functionResponse"],u);const d=c(t,["inlineData"]);d!=null&&f(e,["inlineData"],QR(d));const p=c(t,["text"]);p!=null&&f(e,["text"],p);const g=c(t,["thought"]);g!=null&&f(e,["thought"],g);const y=c(t,["thoughtSignature"]);y!=null&&f(e,["thoughtSignature"],y);const T=c(t,["videoMetadata"]);return T!=null&&f(e,["videoMetadata"],T),e}function f1(t){const e={},n=c(t,["productImage"]);return n!=null&&f(e,["image"],Wn(n)),e}function p1(t,e){const n={},i=c(t,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const r=c(t,["baseSteps"]);e!==void 0&&r!=null&&f(e,["parameters","baseSteps"],r);const o=c(t,["outputGcsUri"]);e!==void 0&&o!=null&&f(e,["parameters","storageUri"],o);const a=c(t,["seed"]);e!==void 0&&a!=null&&f(e,["parameters","seed"],a);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const d=c(t,["personGeneration"]);e!==void 0&&d!=null&&f(e,["parameters","personGeneration"],d);const p=c(t,["addWatermark"]);e!==void 0&&p!=null&&f(e,["parameters","addWatermark"],p);const g=c(t,["outputMimeType"]);e!==void 0&&g!=null&&f(e,["parameters","outputOptions","mimeType"],g);const y=c(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&f(e,["parameters","outputOptions","compressionQuality"],y);const T=c(t,["enhancePrompt"]);e!==void 0&&T!=null&&f(e,["parameters","enhancePrompt"],T);const I=c(t,["labels"]);return e!==void 0&&I!=null&&f(e,["labels"],I),n}function m1(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["source"]);r!=null&&_1(r,n);const o=c(e,["config"]);return o!=null&&p1(o,n),n}function g1(t){const e={},n=c(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>xd(r))),f(e,["generatedImages"],i)}return e}function _1(t,e){const n={},i=c(t,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const r=c(t,["personImage"]);e!==void 0&&r!=null&&f(e,["instances[0]","personImage","image"],Wn(r));const o=c(t,["productImages"]);if(e!==void 0&&o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>f1(u))),f(e,["instances[0]","productImages"],a)}return n}function y1(t){const e={},n=c(t,["referenceImage"]);n!=null&&f(e,["referenceImage"],Wn(n));const i=c(t,["referenceId"]);i!=null&&f(e,["referenceId"],i);const r=c(t,["referenceType"]);r!=null&&f(e,["referenceType"],r);const o=c(t,["maskImageConfig"]);o!=null&&f(e,["maskImageConfig"],d1(o));const a=c(t,["controlImageConfig"]);a!=null&&f(e,["controlImageConfig"],rN(a));const u=c(t,["styleImageConfig"]);u!=null&&f(e,["styleImageConfig"],u);const d=c(t,["subjectImageConfig"]);return d!=null&&f(e,["subjectImageConfig"],d),e}function BE(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const i=c(t,["safetyAttributes","scores"]);i!=null&&f(e,["scores"],i);const r=c(t,["contentType"]);return r!=null&&f(e,["contentType"],r),e}function zE(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const i=c(t,["safetyAttributes","scores"]);i!=null&&f(e,["scores"],i);const r=c(t,["contentType"]);return r!=null&&f(e,["contentType"],r),e}function v1(t){const e={},n=c(t,["category"]);if(n!=null&&f(e,["category"],n),c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=c(t,["threshold"]);return i!=null&&f(e,["threshold"],i),e}function T1(t){const e={},n=c(t,["image"]);return n!=null&&f(e,["image"],Wn(n)),e}function E1(t,e){const n={},i=c(t,["mode"]);e!==void 0&&i!=null&&f(e,["parameters","mode"],i);const r=c(t,["maxPredictions"]);e!==void 0&&r!=null&&f(e,["parameters","maxPredictions"],r);const o=c(t,["confidenceThreshold"]);e!==void 0&&o!=null&&f(e,["parameters","confidenceThreshold"],o);const a=c(t,["maskDilation"]);e!==void 0&&a!=null&&f(e,["parameters","maskDilation"],a);const u=c(t,["binaryColorThreshold"]);e!==void 0&&u!=null&&f(e,["parameters","binaryColorThreshold"],u);const d=c(t,["labels"]);return e!==void 0&&d!=null&&f(e,["labels"],d),n}function w1(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["source"]);r!=null&&I1(r,n);const o=c(e,["config"]);return o!=null&&E1(o,n),n}function C1(t){const e={},n=c(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>JN(r))),f(e,["generatedMasks"],i)}return e}function I1(t,e){const n={},i=c(t,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const r=c(t,["image"]);e!==void 0&&r!=null&&f(e,["instances[0]","image"],Wn(r));const o=c(t,["scribbleImage"]);return e!==void 0&&o!=null&&f(e,["instances[0]","scribble"],T1(o)),n}function qE(t){const e={},n=c(t,["languageCode"]);n!=null&&f(e,["languageCode"],n);const i=c(t,["voiceConfig"]);if(i!=null&&f(e,["voiceConfig"],i),c(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function S1(t){const e={},n=c(t,["functionCallingConfig"]);n!=null&&f(e,["functionCallingConfig"],AN(n));const i=c(t,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],i),e}function x1(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let g=n;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["functionDeclarations"],g)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=c(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const r=c(t,["computerUse"]);r!=null&&f(e,["computerUse"],r);const o=c(t,["fileSearch"]);o!=null&&f(e,["fileSearch"],o);const a=c(t,["codeExecution"]);if(a!=null&&f(e,["codeExecution"],a),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=c(t,["googleMaps"]);u!=null&&f(e,["googleMaps"],e1(u));const d=c(t,["googleSearch"]);d!=null&&f(e,["googleSearch"],t1(d));const p=c(t,["urlContext"]);return p!=null&&f(e,["urlContext"],p),e}function HE(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(T=>PN(T))),f(e,["functionDeclarations"],y)}const i=c(t,["retrieval"]);i!=null&&f(e,["retrieval"],i);const r=c(t,["googleSearchRetrieval"]);r!=null&&f(e,["googleSearchRetrieval"],r);const o=c(t,["computerUse"]);if(o!=null&&f(e,["computerUse"],o),c(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=c(t,["codeExecution"]);a!=null&&f(e,["codeExecution"],a);const u=c(t,["enterpriseWebSearch"]);u!=null&&f(e,["enterpriseWebSearch"],u);const d=c(t,["googleMaps"]);d!=null&&f(e,["googleMaps"],d);const p=c(t,["googleSearch"]);p!=null&&f(e,["googleSearch"],p);const g=c(t,["urlContext"]);return g!=null&&f(e,["urlContext"],g),e}function A1(t){const e={},n=c(t,["baseModel"]);n!=null&&f(e,["baseModel"],n);const i=c(t,["createTime"]);i!=null&&f(e,["createTime"],i);const r=c(t,["updateTime"]);return r!=null&&f(e,["updateTime"],r),e}function P1(t){const e={},n=c(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&f(e,["baseModel"],n);const i=c(t,["createTime"]);i!=null&&f(e,["createTime"],i);const r=c(t,["updateTime"]);return r!=null&&f(e,["updateTime"],r),e}function R1(t,e){const n={},i=c(t,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const r=c(t,["description"]);e!==void 0&&r!=null&&f(e,["description"],r);const o=c(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&f(e,["defaultCheckpointId"],o),n}function N1(t,e){const n={},i=c(t,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const r=c(t,["description"]);e!==void 0&&r!=null&&f(e,["description"],r);const o=c(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&f(e,["defaultCheckpointId"],o),n}function k1(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","name"],be(t,i));const r=c(e,["config"]);return r!=null&&R1(r,n),n}function M1(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["config"]);return r!=null&&N1(r,n),n}function L1(t,e){const n={},i=c(t,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const r=c(t,["safetyFilterLevel"]);e!==void 0&&r!=null&&f(e,["parameters","safetySetting"],r);const o=c(t,["personGeneration"]);e!==void 0&&o!=null&&f(e,["parameters","personGeneration"],o);const a=c(t,["includeRaiReason"]);e!==void 0&&a!=null&&f(e,["parameters","includeRaiReason"],a);const u=c(t,["outputMimeType"]);e!==void 0&&u!=null&&f(e,["parameters","outputOptions","mimeType"],u);const d=c(t,["outputCompressionQuality"]);e!==void 0&&d!=null&&f(e,["parameters","outputOptions","compressionQuality"],d);const p=c(t,["enhanceInputImage"]);e!==void 0&&p!=null&&f(e,["parameters","upscaleConfig","enhanceInputImage"],p);const g=c(t,["imagePreservationFactor"]);e!==void 0&&g!=null&&f(e,["parameters","upscaleConfig","imagePreservationFactor"],g);const y=c(t,["labels"]);e!==void 0&&y!=null&&f(e,["labels"],y);const T=c(t,["numberOfImages"]);e!==void 0&&T!=null&&f(e,["parameters","sampleCount"],T);const I=c(t,["mode"]);return e!==void 0&&I!=null&&f(e,["parameters","mode"],I),n}function D1(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["_url","model"],be(t,i));const r=c(e,["image"]);r!=null&&f(n,["instances[0]","image"],Wn(r));const o=c(e,["upscaleFactor"]);o!=null&&f(n,["parameters","upscaleConfig","upscaleFactor"],o);const a=c(e,["config"]);return a!=null&&L1(a,n),n}function V1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>xd(o))),f(e,["generatedImages"],r)}return e}function b1(t){const e={},n=c(t,["uri"]);n!=null&&f(e,["uri"],n);const i=c(t,["encodedVideo"]);i!=null&&f(e,["videoBytes"],Tr(i));const r=c(t,["encoding"]);return r!=null&&f(e,["mimeType"],r),e}function F1(t){const e={},n=c(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const i=c(t,["bytesBase64Encoded"]);i!=null&&f(e,["videoBytes"],Tr(i));const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function U1(t){const e={},n=c(t,["image"]);n!=null&&f(e,["_self"],Wn(n));const i=c(t,["maskMode"]);return i!=null&&f(e,["maskMode"],i),e}function O1(t){const e={},n=c(t,["image"]);n!=null&&f(e,["image"],Ad(n));const i=c(t,["referenceType"]);return i!=null&&f(e,["referenceType"],i),e}function B1(t){const e={},n=c(t,["image"]);n!=null&&f(e,["image"],Wn(n));const i=c(t,["referenceType"]);return i!=null&&f(e,["referenceType"],i),e}function GE(t){const e={},n=c(t,["uri"]);n!=null&&f(e,["uri"],n);const i=c(t,["videoBytes"]);i!=null&&f(e,["encodedVideo"],Tr(i));const r=c(t,["mimeType"]);return r!=null&&f(e,["encoding"],r),e}function WE(t){const e={},n=c(t,["uri"]);n!=null&&f(e,["gcsUri"],n);const i=c(t,["videoBytes"]);i!=null&&f(e,["bytesBase64Encoded"],Tr(i));const r=c(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function z1(t,e){const n={},i=c(t,["displayName"]);return e!==void 0&&i!=null&&f(e,["displayName"],i),n}function q1(t){const e={},n=c(t,["config"]);return n!=null&&z1(n,e),e}function H1(t,e){const n={},i=c(t,["force"]);return e!==void 0&&i!=null&&f(e,["_query","force"],i),n}function G1(t){const e={},n=c(t,["name"]);n!=null&&f(e,["_url","name"],n);const i=c(t,["config"]);return i!=null&&H1(i,e),e}function W1(t){const e={},n=c(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function $1(t,e){const n={},i=c(t,["customMetadata"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>a)),f(e,["customMetadata"],o)}const r=c(t,["chunkingConfig"]);return e!==void 0&&r!=null&&f(e,["chunkingConfig"],r),n}function K1(t){const e={},n=c(t,["name"]);n!=null&&f(e,["name"],n);const i=c(t,["metadata"]);i!=null&&f(e,["metadata"],i);const r=c(t,["done"]);r!=null&&f(e,["done"],r);const o=c(t,["error"]);o!=null&&f(e,["error"],o);const a=c(t,["response"]);return a!=null&&f(e,["response"],Z1(a)),e}function J1(t){const e={},n=c(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const i=c(t,["fileName"]);i!=null&&f(e,["fileName"],i);const r=c(t,["config"]);return r!=null&&$1(r,e),e}function Z1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["parent"]);i!=null&&f(e,["parent"],i);const r=c(t,["documentName"]);return r!=null&&f(e,["documentName"],r),e}function Y1(t,e){const n={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(t,["pageToken"]);return e!==void 0&&r!=null&&f(e,["_query","pageToken"],r),n}function Q1(t){const e={},n=c(t,["config"]);return n!=null&&Y1(n,e),e}function X1(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(t,["fileSearchStores"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>a)),f(e,["fileSearchStores"],o)}return e}function $E(t,e){const n={},i=c(t,["mimeType"]);e!==void 0&&i!=null&&f(e,["mimeType"],i);const r=c(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const o=c(t,["customMetadata"]);if(e!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>d)),f(e,["customMetadata"],u)}const a=c(t,["chunkingConfig"]);return e!==void 0&&a!=null&&f(e,["chunkingConfig"],a),n}function j1(t){const e={},n=c(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const i=c(t,["config"]);return i!=null&&$E(i,e),e}function ek(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tk="Content-Type",nk="X-Server-Timeout",ik="User-Agent",Vf="x-goog-api-client",rk="1.31.0",ok=`google-genai-sdk/${rk}`,sk="v1beta1",ak="v1beta",Jy=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class lk{constructor(e){var n,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:sk,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:ak,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,i){const r=[this.getRequestUrlInternal(n)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,n,i);if(e.queryParams)for(const[a,u]of Object.entries(e.queryParams))r.searchParams.append(a,String(u));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,r.toString(),e.abortSignal),this.unaryApiCall(r,o,e.httpMethod)}patchHttpOptions(e,n){const i=JSON.parse(JSON.stringify(e));for(const[r,o]of Object.entries(n))typeof o=="object"?i[r]=Object.assign(Object.assign({},i[r]),o):o!==void 0&&(i[r]=o);return i}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,n,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,r.toString(),e.abortSignal),this.streamApiCall(r,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,i,r){if(n&&n.timeout||r){const o=new AbortController,a=o.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const u=setTimeout(()=>o.abort(),n.timeout);u&&typeof u.unref=="function"&&u.unref()}r&&r.addEventListener("abort",()=>{o.abort()}),e.signal=a}return n&&n.extraBody!==null&&uk(e,n.extraBody),e.headers=await this.getHeadersInternal(n,i),e}async unaryApiCall(e,n,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:i})).then(async r=>(await Zy(r),new Nf(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,n,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:i})).then(async r=>(await Zy(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var n;return ds(this,arguments,function*(){const r=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),o=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let a="";for(;;){const{done:u,value:d}=yield Je(r.read());if(u){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=o.decode(d,{stream:!0});try{const y=JSON.parse(p);if("error"in y){const T=JSON.parse(JSON.stringify(y.error)),I=T.status,V=T.code,b=`got status: ${I}. ${JSON.stringify(y)}`;if(V>=400&&V<600)throw new Id({message:b,status:V})}}catch(y){if(y.name==="ApiError")throw y}a+=p;let g=a.match(Jy);for(;g;){const y=g[1];try{const T=new Response(y,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Je(new Nf(T)),a=a.slice(g[0].length),g=a.match(Jy)}catch(T){throw new Error(`exception parsing stream chunk ${y}. ${T}`)}}}}finally{r.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},n=ok+" "+this.clientOptions.userAgentExtra;return e[ik]=n,e[Vf]=n,e[tk]="application/json",e}async getHeadersInternal(e,n){const i=new Headers;if(e&&e.headers){for(const[r,o]of Object.entries(e.headers))i.append(r,o);e.timeout&&e.timeout>0&&i.append(nk,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,n),i}getFileName(e){var n;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(n=i.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),i}async uploadFile(e,n){var i;const r={};n!=null&&(r.mimeType=n.mimeType,r.name=n.name,r.displayName=n.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const o=this.clientOptions.uploader,a=await o.stat(e);r.sizeBytes=String(a.size);const u=(i=n==null?void 0:n.mimeType)!==null&&i!==void 0?i:a.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=u;const d={file:r},p=this.getFileName(e),g=ie("upload/v1beta/files",d._url),y=await this.fetchUploadUrl(g,r.sizeBytes,r.mimeType,p,d,n==null?void 0:n.httpOptions);return o.upload(e,y,this)}async uploadFileToFileSearchStore(e,n,i){var r;const o=this.clientOptions.uploader,a=await o.stat(n),u=String(a.size),d=(r=i==null?void 0:i.mimeType)!==null&&r!==void 0?r:a.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,g=this.getFileName(n),y={};i!=null&&$E(i,y);const T=await this.fetchUploadUrl(p,u,d,g,y,i==null?void 0:i.httpOptions);return o.uploadToFileSearchStore(n,T,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,i,r,o,a){var u;let d={};a?d=a:d={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};const p=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:d});if(!p||!(p!=null&&p.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const g=(u=p==null?void 0:p.headers)===null||u===void 0?void 0:u["x-goog-upload-url"];if(g===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return g}}async function Zy(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let i;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await t.json():i={error:{message:await t.text(),code:t.status,status:t.statusText}};const r=JSON.stringify(i);throw n>=400&&n<600?new Id({message:r,status:n}):new Error(r)}}function uk(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const o=JSON.parse(t.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))n=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(o,a){const u=Object.assign({},o);for(const d in a)if(Object.prototype.hasOwnProperty.call(a,d)){const p=a[d],g=u[d];p&&typeof p=="object"&&!Array.isArray(p)&&g&&typeof g=="object"&&!Array.isArray(g)?u[d]=i(g,p):(g&&p&&typeof g!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof g}, New type: ${typeof p}. Overwriting.`),u[d]=p)}return u}const r=i(n,e);t.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ck="mcp_used/unknown";let dk=!1;function KE(t){for(const e of t)if(hk(e)||typeof e=="object"&&"inputSchema"in e)return!0;return dk}function JE(t){var e;const n=(e=t[Vf])!==null&&e!==void 0?e:"";t[Vf]=(n+` ${ck}`).trimStart()}function hk(t){return t!==null&&typeof t=="object"&&t instanceof lm}function fk(t,e=100){return ds(this,arguments,function*(){let i,r=0;for(;r<e;){const o=yield Je(t.listTools({cursor:i}));for(const a of o.tools)yield yield Je(a),r++;if(!o.nextCursor)break;i=o.nextCursor}})}class lm{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new lm(e,n)}async initialize(){var e,n,i,r;if(this.mcpTools.length>0)return;const o={},a=[];for(const g of this.mcpClients)try{for(var u=!0,d=(n=void 0,el(fk(g))),p;p=await d.next(),e=p.done,!e;u=!0){r=p.value,u=!1;const y=r;a.push(y);const T=y.name;if(o[T])throw new Error(`Duplicate function name ${T} found in MCP tools. Please ensure function names are unique.`);o[T]=g}}catch(y){n={error:y}}finally{try{!u&&!e&&(i=d.return)&&await i.call(d)}finally{if(n)throw n.error}}this.mcpTools=a,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),WA(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const a=await r.callTool({name:i.name,arguments:i.args},void 0,o);n.push({functionResponse:{name:i.name,response:a.isError?{error:a}:a}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function pk(t,e,n){const i=new FA;let r;n.data instanceof Blob?r=JSON.parse(await n.data.text()):r=JSON.parse(n.data),Object.assign(i,r),e(i)}class mk{constructor(e,n,i){this.apiClient=e,this.auth=n,this.webSocketFactory=i}async connect(e){var n,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),a=yk(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${r}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${u}`;let p=()=>{};const g=new Promise(R=>{p=R}),y=e.callbacks,T=function(){p({})},I=this.apiClient,V={onopen:T,onmessage:R=>{pk(I,y.onmessage,R)},onerror:(n=y==null?void 0:y.onerror)!==null&&n!==void 0?n:function(R){},onclose:(i=y==null?void 0:y.onclose)!==null&&i!==void 0?i:function(R){}},b=this.webSocketFactory.create(d,_k(a),V);b.connect(),await g;const x={setup:{model:be(this.apiClient,e.model)}};return b.send(JSON.stringify(x)),new gk(b,this.apiClient)}}class gk{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=qR(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=zR(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(is.PLAY)}pause(){this.sendPlaybackControl(is.PAUSE)}stop(){this.sendPlaybackControl(is.STOP)}resetContext(){this.sendPlaybackControl(is.RESET_CONTEXT)}close(){this.conn.close()}}function _k(t){const e={};return t.forEach((n,i)=>{e[i]=n}),e}function yk(t){const e=new Headers;for(const[n,i]of Object.entries(t))e.append(n,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const vk="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Tk(t,e,n){const i=new bA;let r;n.data instanceof Blob?r=await n.data.text():n.data instanceof ArrayBuffer?r=new TextDecoder().decode(n.data):r=n.data;const o=JSON.parse(r);if(t.isVertexAI()){const a=WR(o);Object.assign(i,a)}else Object.assign(i,o);e(i)}class Ek{constructor(e,n,i){this.apiClient=e,this.auth=n,this.webSocketFactory=i,this.music=new mk(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,i,r,o,a,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let g;const y=this.apiClient.getHeaders();e.config&&e.config.tools&&KE(e.config.tools)&&JE(y);const T=Sk(y);if(this.apiClient.isVertexAI())g=`${d}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(T,g);else{const D=this.apiClient.getApiKey();let F="BidiGenerateContent",B="key";D!=null&&D.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),F="BidiGenerateContentConstrained",B="access_token"),g=`${d}/ws/google.ai.generativelanguage.${p}.GenerativeService.${F}?${B}=${D}`}let I=()=>{};const V=new Promise(D=>{I=D}),b=e.callbacks,q=function(){var D;(D=b==null?void 0:b.onopen)===null||D===void 0||D.call(b),I({})},A=this.apiClient,x={onopen:q,onmessage:D=>{Tk(A,b.onmessage,D)},onerror:(n=b==null?void 0:b.onerror)!==null&&n!==void 0?n:function(D){},onclose:(i=b==null?void 0:b.onclose)!==null&&i!==void 0?i:function(D){}},R=this.webSocketFactory.create(g,Ik(T),x);R.connect(),await V;let z=be(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&z.startsWith("publishers/")){const D=this.apiClient.getProject(),F=this.apiClient.getLocation();z=`projects/${D}/locations/${F}/`+z}let W={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Kc.AUDIO]}:e.config.responseModalities=[Kc.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const J=(u=(a=e.config)===null||a===void 0?void 0:a.tools)!==null&&u!==void 0?u:[],k=[];for(const D of J)if(this.isCallableTool(D)){const F=D;k.push(await F.tool())}else k.push(D);k.length>0&&(e.config.tools=k);const N={model:z,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?W=BR(this.apiClient,N):W=OR(this.apiClient,N),delete W.config,R.send(JSON.stringify(W)),new Ck(R,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const wk={turnComplete:!0};class Ck{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let i=[];try{i=Pn(n.turns),e.isVertexAI()||(i=i.map(r=>Sd(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:i,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let i=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?i=n.functionResponses:i=[n.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const o of i){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(vk)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},wk),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:GR(e)}:n={realtimeInput:HR(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function Ik(t){const e={};return t.forEach((n,i)=>{e[i]=n}),e}function Sk(t){const e=new Headers;for(const[n,i]of Object.entries(t))e.append(n,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Yy=10;function Qy(t){var e,n,i;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const a of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(hs(a)){r=!0;break}if(!r)return!0;const o=(i=t==null?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function hs(t){return"callTool"in t&&typeof t.callTool=="function"}function xk(t){var e,n,i;return(i=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(r=>hs(r)))!==null&&i!==void 0?i:!1}function Xy(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((i,r)=>{if(hs(i))return;const o=i;o.functionDeclarations&&o.functionDeclarations.length>0&&n.push(r)}),n}function jy(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ak extends Li{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var i,r,o,a,u;const d=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!xk(n)||Qy(n.config))return await this.generateContentInternal(d);const p=Xy(n);if(p.length>0){const b=p.map(q=>`tools[${q}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${b}.`)}let g,y;const T=Pn(d.contents),I=(o=(r=(i=d.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&o!==void 0?o:Yy;let V=0;for(;V<I&&(g=await this.generateContentInternal(d),!(!g.functionCalls||g.functionCalls.length===0));){const b=g.candidates[0].content,q=[];for(const A of(u=(a=n.config)===null||a===void 0?void 0:a.tools)!==null&&u!==void 0?u:[])if(hs(A)){const R=await A.callTool(g.functionCalls);q.push(...R)}V++,y={role:"user",parts:q},d.contents=Pn(d.contents),d.contents.push(b),d.contents.push(y),jy(d.config)&&(T.push(b),T.push(y))}return jy(d.config)&&(g.automaticFunctionCallingHistory=T),g},this.generateContentStream=async n=>{var i,r,o,a,u;if(this.maybeMoveToResponseJsonSchem(n),Qy(n.config)){const y=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(y)}const d=Xy(n);if(d.length>0){const y=d.map(T=>`tools[${T}]`).join(", ");throw new Error(`Incompatible tools found at ${y}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(o=(r=(i=n==null?void 0:n.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,g=(u=(a=n==null?void 0:n.config)===null||a===void 0?void 0:a.automaticFunctionCalling)===null||u===void 0?void 0:u.disable;if(p&&!g)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(i=>{var r;let o;const a=[];if(i!=null&&i.generatedImages)for(const d of i.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((r=d==null?void 0:d.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?o=d==null?void 0:d.safetyAttributes:a.push(d);let u;return o?u={generatedImages:a,positivePromptSafetyAttributes:o,sdkHttpResponse:i.sdkHttpResponse}:u={generatedImages:a,sdkHttpResponse:i.sdkHttpResponse},u}),this.list=async n=>{var i;const a={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((i=a.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new oo(Pi.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(a),a)},this.editImage=async n=>{const i={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(i.referenceImages=n.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async n=>{let i={numberOfImages:1,mode:"upscale"};n.config&&(i=Object.assign(Object.assign({},i),n.config));const r={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async n=>{var i,r,o,a,u,d;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=n.video)===null||i===void 0)&&i.uri&&(!((r=n.video)===null||r===void 0)&&r.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((a=(o=n.source)===null||o===void 0?void 0:o.video)===null||a===void 0)&&a.uri&&(!((d=(u=n.source)===null||u===void 0?void 0:u.video)===null||d===void 0)&&d.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,i,r;const o=(n=e.config)===null||n===void 0?void 0:n.tools;if(!o)return e;const a=await Promise.all(o.map(async d=>hs(d)?await d.tool():d)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:a})};if(u.config.tools=a,e.config&&e.config.tools&&KE(e.config.tools)){const d=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let p=Object.assign({},d);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),JE(p),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return u}async initAfcToolsMap(e){var n,i,r;const o=new Map;for(const a of(i=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&i!==void 0?i:[])if(hs(a)){const u=a,d=await u.tool();for(const p of(r=d.functionDeclarations)!==null&&r!==void 0?r:[]){if(!p.name)throw new Error("Function declaration name is required.");if(o.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);o.set(p.name,u)}}return o}async processAfcStream(e){var n,i,r;const o=(r=(i=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:Yy;let a=!1,u=0;const d=await this.initAfcToolsMap(e);return function(p,g,y){var T,I;return ds(this,arguments,function*(){for(var V,b,q,A;u<o;){a&&(u++,a=!1);const W=yield Je(p.processParamsMaybeAddMcpUsage(y)),J=yield Je(p.generateContentStreamInternal(W)),k=[],N=[];try{for(var x=!0,R=(b=void 0,el(J)),z;z=yield Je(R.next()),V=z.done,!V;x=!0){A=z.value,x=!1;const D=A;if(yield yield Je(D),D.candidates&&(!((T=D.candidates[0])===null||T===void 0)&&T.content)){N.push(D.candidates[0].content);for(const F of(I=D.candidates[0].content.parts)!==null&&I!==void 0?I:[])if(u<o&&F.functionCall){if(!F.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(F.functionCall.name)){const B=yield Je(g.get(F.functionCall.name).callTool([F.functionCall]));k.push(...B)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${F.functionCall.name}`)}}}}catch(D){b={error:D}}finally{try{!x&&!V&&(q=R.return)&&(yield Je(q.call(R)))}finally{if(b)throw b.error}}if(k.length>0){a=!0;const D=new La;D.candidates=[{content:{role:"user",parts:k}}],yield yield Je(D);const F=[];F.push(...N),F.push({role:"user",parts:k});const B=Pn(y.contents).concat(F);y.contents=B}else break}})}(this,d,e)}async generateContentInternal(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=Wy(this.apiClient,e);return u=ie("{model}:generateContent",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=Ky(g),T=new La;return Object.assign(T,y),T})}else{const p=Gy(this.apiClient,e);return u=ie("{model}:generateContent",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=$y(g),T=new La;return Object.assign(T,y),T})}}async generateContentStreamInternal(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=Wy(this.apiClient,e);return u=ie("{model}:streamGenerateContent?alt=sse",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),a.then(function(y){return ds(this,arguments,function*(){var T,I,V,b;try{for(var q=!0,A=el(y),x;x=yield Je(A.next()),T=x.done,!T;q=!0){b=x.value,q=!1;const R=b,z=Ky(yield Je(R.json()));z.sdkHttpResponse={headers:R.headers};const W=new La;Object.assign(W,z),yield yield Je(W)}}catch(R){I={error:R}}finally{try{!q&&!T&&(V=A.return)&&(yield Je(V.call(A)))}finally{if(I)throw I.error}}})})}else{const p=Gy(this.apiClient,e);return u=ie("{model}:streamGenerateContent?alt=sse",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),a.then(function(y){return ds(this,arguments,function*(){var T,I,V,b;try{for(var q=!0,A=el(y),x;x=yield Je(A.next()),T=x.done,!T;q=!0){b=x.value,q=!1;const R=b,z=$y(yield Je(R.json()));z.sdkHttpResponse={headers:R.headers};const W=new La;Object.assign(W,z),yield yield Je(W)}}catch(R){I={error:R}}finally{try{!q&&!T&&(V=A.return)&&(yield Je(V.call(A)))}finally{if(I)throw I.error}}})})}}async embedContent(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=EN(this.apiClient,e);return u=ie("{model}:predict",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=CN(g),T=new Ay;return Object.assign(T,y),T})}else{const p=TN(this.apiClient,e);return u=ie("{model}:batchEmbedContents",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=wN(g),T=new Ay;return Object.assign(T,y),T})}}async generateImagesInternal(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=DN(this.apiClient,e);return u=ie("{model}:predict",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=bN(g),T=new Py;return Object.assign(T,y),T})}else{const p=LN(this.apiClient,e);return u=ie("{model}:predict",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=VN(g),T=new Py;return Object.assign(T,y),T})}}async editImageInternal(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const u=gN(this.apiClient,e);return o=ie("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:d.headers},g})),r.then(d=>{const p=_N(d),g=new SA;return Object.assign(g,p),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const u=D1(this.apiClient,e);return o=ie("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:d.headers},g})),r.then(d=>{const p=V1(d),g=new xA;return Object.assign(g,p),g})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const u=m1(this.apiClient,e);return o=ie("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const p=g1(d),g=new AA;return Object.assign(g,p),g})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const u=w1(this.apiClient,e);return o=ie("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const p=C1(d),g=new PA;return Object.assign(g,p),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=jN(this.apiClient,e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>Df(g))}else{const p=XN(this.apiClient,e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),a.then(g=>Lf(g))}}async listInternal(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=l1(this.apiClient,e);return u=ie("{models_url}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=c1(g),T=new Ry;return Object.assign(T,y),T})}else{const p=a1(this.apiClient,e);return u=ie("{models_url}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=u1(g),T=new Ry;return Object.assign(T,y),T})}}async update(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=M1(this.apiClient,e);return u=ie("{model}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>Df(g))}else{const p=k1(this.apiClient,e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),a.then(g=>Lf(g))}}async delete(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=hN(this.apiClient,e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=pN(g),T=new Ny;return Object.assign(T,y),T})}else{const p=dN(this.apiClient,e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=fN(g),T=new Ny;return Object.assign(T,y),T})}}async countTokens(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=lN(this.apiClient,e);return u=ie("{model}:countTokens",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=cN(g),T=new ky;return Object.assign(T,y),T})}else{const p=aN(this.apiClient,e);return u=ie("{model}:countTokens",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=uN(g),T=new ky;return Object.assign(T,y),T})}}async computeTokens(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const u=eN(this.apiClient,e);return o=ie("{model}:computeTokens",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:d.headers},g})),r.then(d=>{const p=tN(d),g=new RA;return Object.assign(g,p),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=qN(this.apiClient,e);return u=ie("{model}:predictLongRunning",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>{const y=BN(g),T=new Jc;return Object.assign(T,y),T})}else{const p=zN(this.apiClient,e);return u=ie("{model}:predictLongRunning",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),a.then(g=>{const y=ON(g),T=new Jc;return Object.assign(T,y),T})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Pk extends Li{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,i=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=n.name.split("/operations/")[0];let o;i&&"httpOptions"in i&&(o=i.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:r,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:n.name,config:i});return n._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){const n=e.operation,i=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=n.name.split("/operations/")[0];let o;i&&"httpOptions"in i&&(o=i.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:r,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:n.name,config:i});return n._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=vA(e);return u=ie("{operationName}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a}else{const p=yA(e);return u=ie("{operationName}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),a}}async fetchPredictVideosOperationInternal(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const u=dA(e);return o=ie("{resourceName}:fetchPredictOperation",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Rk(t){const e={},n=c(t,["data"]);if(n!=null&&f(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function Nk(t){const e={},n=c(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>Ok(o))),f(e,["parts"],r)}const i=c(t,["role"]);return i!=null&&f(e,["role"],i),e}function kk(t,e,n){const i={},r=c(e,["expireTime"]);n!==void 0&&r!=null&&f(n,["expireTime"],r);const o=c(e,["newSessionExpireTime"]);n!==void 0&&o!=null&&f(n,["newSessionExpireTime"],o);const a=c(e,["uses"]);n!==void 0&&a!=null&&f(n,["uses"],a);const u=c(e,["liveConnectConstraints"]);n!==void 0&&u!=null&&f(n,["bidiGenerateContentSetup"],Uk(t,u));const d=c(e,["lockAdditionalFields"]);return n!==void 0&&d!=null&&f(n,["fieldMask"],d),i}function Mk(t,e){const n={},i=c(e,["config"]);return i!=null&&f(n,["config"],kk(t,i,n)),n}function Lk(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const i=c(t,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function Dk(t){const e={},n=c(t,["id"]);n!=null&&f(e,["id"],n);const i=c(t,["args"]);i!=null&&f(e,["args"],i);const r=c(t,["name"]);if(r!=null&&f(e,["name"],r),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Vk(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function bk(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function Fk(t,e){const n={},i=c(t,["generationConfig"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig"],i);const r=c(t,["responseModalities"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig","responseModalities"],r);const o=c(t,["temperature"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","temperature"],o);const a=c(t,["topP"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topP"],a);const u=c(t,["topK"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","topK"],u);const d=c(t,["maxOutputTokens"]);e!==void 0&&d!=null&&f(e,["setup","generationConfig","maxOutputTokens"],d);const p=c(t,["mediaResolution"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","mediaResolution"],p);const g=c(t,["seed"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","seed"],g);const y=c(t,["speechConfig"]);e!==void 0&&y!=null&&f(e,["setup","generationConfig","speechConfig"],am(y));const T=c(t,["thinkingConfig"]);e!==void 0&&T!=null&&f(e,["setup","generationConfig","thinkingConfig"],T);const I=c(t,["enableAffectiveDialog"]);e!==void 0&&I!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],I);const V=c(t,["systemInstruction"]);e!==void 0&&V!=null&&f(e,["setup","systemInstruction"],Nk(zt(V)));const b=c(t,["tools"]);if(e!==void 0&&b!=null){let J=Vs(b);Array.isArray(J)&&(J=J.map(k=>zk(Ds(k)))),f(e,["setup","tools"],J)}const q=c(t,["sessionResumption"]);e!==void 0&&q!=null&&f(e,["setup","sessionResumption"],Bk(q));const A=c(t,["inputAudioTranscription"]);e!==void 0&&A!=null&&f(e,["setup","inputAudioTranscription"],A);const x=c(t,["outputAudioTranscription"]);e!==void 0&&x!=null&&f(e,["setup","outputAudioTranscription"],x);const R=c(t,["realtimeInputConfig"]);e!==void 0&&R!=null&&f(e,["setup","realtimeInputConfig"],R);const z=c(t,["contextWindowCompression"]);e!==void 0&&z!=null&&f(e,["setup","contextWindowCompression"],z);const W=c(t,["proactivity"]);return e!==void 0&&W!=null&&f(e,["setup","proactivity"],W),n}function Uk(t,e){const n={},i=c(e,["model"]);i!=null&&f(n,["setup","model"],be(t,i));const r=c(e,["config"]);return r!=null&&f(n,["config"],Fk(r,n)),n}function Ok(t){const e={},n=c(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const i=c(t,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const r=c(t,["executableCode"]);r!=null&&f(e,["executableCode"],r);const o=c(t,["fileData"]);o!=null&&f(e,["fileData"],Lk(o));const a=c(t,["functionCall"]);a!=null&&f(e,["functionCall"],Dk(a));const u=c(t,["functionResponse"]);u!=null&&f(e,["functionResponse"],u);const d=c(t,["inlineData"]);d!=null&&f(e,["inlineData"],Rk(d));const p=c(t,["text"]);p!=null&&f(e,["text"],p);const g=c(t,["thought"]);g!=null&&f(e,["thought"],g);const y=c(t,["thoughtSignature"]);y!=null&&f(e,["thoughtSignature"],y);const T=c(t,["videoMetadata"]);return T!=null&&f(e,["videoMetadata"],T),e}function Bk(t){const e={},n=c(t,["handle"]);if(n!=null&&f(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function zk(t){const e={},n=c(t,["functionDeclarations"]);if(n!=null){let g=n;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["functionDeclarations"],g)}if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=c(t,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const r=c(t,["computerUse"]);r!=null&&f(e,["computerUse"],r);const o=c(t,["fileSearch"]);o!=null&&f(e,["fileSearch"],o);const a=c(t,["codeExecution"]);if(a!=null&&f(e,["codeExecution"],a),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=c(t,["googleMaps"]);u!=null&&f(e,["googleMaps"],Vk(u));const d=c(t,["googleSearch"]);d!=null&&f(e,["googleSearch"],bk(d));const p=c(t,["urlContext"]);return p!=null&&f(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qk(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const i=t[n];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(o=>`${n}.${o}`);e.push(...r)}else e.push(n)}return e.join(",")}function Hk(t,e){let n=null;const i=t.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const o=i.setup;typeof o=="object"&&o!==null?(t.bidiGenerateContentSetup=o,n=o):delete t.bidiGenerateContentSetup}else i!==void 0&&delete t.bidiGenerateContentSetup;const r=t.fieldMask;if(n){const o=qk(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?t.fieldMask=o:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const a=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];r.length>0&&(u=r.map(p=>a.includes(p)?`generationConfig.${p}`:p));const d=[];o&&d.push(o),u.length>0&&d.push(...u),d.length>0?t.fieldMask=d.join(","):delete t.fieldMask}else delete t.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?t.fieldMask=r.join(","):delete t.fieldMask;return t}class Gk extends Li{constructor(e){super(),this.apiClient=e}async create(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=Mk(this.apiClient,e);o=ie("auth_tokens",u._url),a=u._query,delete u.config,delete u._url,delete u._query;const d=Hk(u,e.config);return r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>p)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wk(t,e){const n={},i=c(t,["force"]);return e!==void 0&&i!=null&&f(e,["_query","force"],i),n}function $k(t){const e={},n=c(t,["name"]);n!=null&&f(e,["_url","name"],n);const i=c(t,["config"]);return i!=null&&Wk(i,e),e}function Kk(t){const e={},n=c(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function Jk(t,e){const n={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(t,["pageToken"]);return e!==void 0&&r!=null&&f(e,["_query","pageToken"],r),n}function Zk(t){const e={},n=c(t,["parent"]);n!=null&&f(e,["_url","parent"],n);const i=c(t,["config"]);return i!=null&&Jk(i,e),e}function Yk(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const i=c(t,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(t,["documents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>a)),f(e,["documents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qk extends Li{constructor(e){super(),this.apiClient=e,this.list=async n=>new oo(Pi.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:n.parent,config:i.config}),await this.listInternal(n),n)}async get(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Kk(e);return o=ie("{name}",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async delete(e){var n,i;let r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=$k(e);r=ie("{name}",a._url),o=a._query,delete a._url,delete a._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Zk(e);return o=ie("{parent}/documents",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const p=Yk(d),g=new NA;return Object.assign(g,p),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xk extends Li{constructor(e,n=new Qk(e)){super(),this.apiClient=e,this.documents=n,this.list=async(i={})=>new oo(Pi.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=q1(e);return o=ie("fileSearchStores",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async get(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=W1(e);return o=ie("{name}",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async delete(e){var n,i;let r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=G1(e);r=ie("{name}",a._url),o=a._query,delete a._url,delete a._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Q1(e);return o=ie("fileSearchStores",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const p=X1(d),g=new kA;return Object.assign(g,p),g})}}async uploadToFileSearchStoreInternal(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=j1(e);return o=ie("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const p=ek(d),g=new MA;return Object.assign(g,p),g})}}async importFile(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=J1(e);return o=ie("{file_search_store_name}:importFile",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{const p=K1(d),g=new nm;return Object.assign(g,p),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jk(t,e){const n={},i=c(t,["name"]);return i!=null&&f(n,["_url","name"],i),n}function eM(t,e){const n={},i=c(t,["name"]);return i!=null&&f(n,["_url","name"],i),n}function tM(t,e){const n={},i=c(t,["sdkHttpResponse"]);return i!=null&&f(n,["sdkHttpResponse"],i),n}function nM(t,e){const n={},i=c(t,["sdkHttpResponse"]);return i!=null&&f(n,["sdkHttpResponse"],i),n}function iM(t,e,n){const i={};if(c(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=c(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&f(e,["displayName"],r),c(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=c(t,["epochCount"]);e!==void 0&&o!=null&&f(e,["tuningTask","hyperparameters","epochCount"],o);const a=c(t,["learningRateMultiplier"]);if(a!=null&&f(i,["tuningTask","hyperparameters","learningRateMultiplier"],a),c(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(c(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=c(t,["batchSize"]);e!==void 0&&u!=null&&f(e,["tuningTask","hyperparameters","batchSize"],u);const d=c(t,["learningRate"]);if(e!==void 0&&d!=null&&f(e,["tuningTask","hyperparameters","learningRate"],d),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(c(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function rM(t,e,n){const i={};let r=c(n,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const I=c(t,["validationDataset"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec"],ev(I))}else if(r==="PREFERENCE_TUNING"){const I=c(t,["validationDataset"]);e!==void 0&&I!=null&&f(e,["preferenceOptimizationSpec"],ev(I))}const o=c(t,["tunedModelDisplayName"]);e!==void 0&&o!=null&&f(e,["tunedModelDisplayName"],o);const a=c(t,["description"]);e!==void 0&&a!=null&&f(e,["description"],a);let u=c(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const I=c(t,["epochCount"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec","hyperParameters","epochCount"],I)}else if(u==="PREFERENCE_TUNING"){const I=c(t,["epochCount"]);e!==void 0&&I!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],I)}let d=c(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const I=c(t,["learningRateMultiplier"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],I)}else if(d==="PREFERENCE_TUNING"){const I=c(t,["learningRateMultiplier"]);e!==void 0&&I!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],I)}let p=c(n,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const I=c(t,["exportLastCheckpointOnly"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec","exportLastCheckpointOnly"],I)}else if(p==="PREFERENCE_TUNING"){const I=c(t,["exportLastCheckpointOnly"]);e!==void 0&&I!=null&&f(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],I)}let g=c(n,["config","method"]);if(g===void 0&&(g="SUPERVISED_FINE_TUNING"),g==="SUPERVISED_FINE_TUNING"){const I=c(t,["adapterSize"]);e!==void 0&&I!=null&&f(e,["supervisedTuningSpec","hyperParameters","adapterSize"],I)}else if(g==="PREFERENCE_TUNING"){const I=c(t,["adapterSize"]);e!==void 0&&I!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],I)}if(c(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const y=c(t,["labels"]);e!==void 0&&y!=null&&f(e,["labels"],y);const T=c(t,["beta"]);return e!==void 0&&T!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","beta"],T),i}function oM(t,e){const n={},i=c(t,["baseModel"]);i!=null&&f(n,["baseModel"],i);const r=c(t,["preTunedModel"]);r!=null&&f(n,["preTunedModel"],r);const o=c(t,["trainingDataset"]);o!=null&&gM(o);const a=c(t,["config"]);return a!=null&&iM(a,n),n}function sM(t,e){const n={},i=c(t,["baseModel"]);i!=null&&f(n,["baseModel"],i);const r=c(t,["preTunedModel"]);r!=null&&f(n,["preTunedModel"],r);const o=c(t,["trainingDataset"]);o!=null&&_M(o,n,e);const a=c(t,["config"]);return a!=null&&rM(a,n,e),n}function aM(t,e){const n={},i=c(t,["name"]);return i!=null&&f(n,["_url","name"],i),n}function lM(t,e){const n={},i=c(t,["name"]);return i!=null&&f(n,["_url","name"],i),n}function uM(t,e,n){const i={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const o=c(t,["pageToken"]);e!==void 0&&o!=null&&f(e,["_query","pageToken"],o);const a=c(t,["filter"]);return e!==void 0&&a!=null&&f(e,["_query","filter"],a),i}function cM(t,e,n){const i={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const o=c(t,["pageToken"]);e!==void 0&&o!=null&&f(e,["_query","pageToken"],o);const a=c(t,["filter"]);return e!==void 0&&a!=null&&f(e,["_query","filter"],a),i}function dM(t,e){const n={},i=c(t,["config"]);return i!=null&&uM(i,n),n}function hM(t,e){const n={},i=c(t,["config"]);return i!=null&&cM(i,n),n}function fM(t,e){const n={},i=c(t,["sdkHttpResponse"]);i!=null&&f(n,["sdkHttpResponse"],i);const r=c(t,["nextPageToken"]);r!=null&&f(n,["nextPageToken"],r);const o=c(t,["tunedModels"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>ZE(u))),f(n,["tuningJobs"],a)}return n}function pM(t,e){const n={},i=c(t,["sdkHttpResponse"]);i!=null&&f(n,["sdkHttpResponse"],i);const r=c(t,["nextPageToken"]);r!=null&&f(n,["nextPageToken"],r);const o=c(t,["tuningJobs"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>bf(u))),f(n,["tuningJobs"],a)}return n}function mM(t,e){const n={},i=c(t,["name"]);i!=null&&f(n,["model"],i);const r=c(t,["name"]);return r!=null&&f(n,["endpoint"],r),n}function gM(t,e){const n={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=c(t,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),f(n,["examples","examples"],r)}return n}function _M(t,e,n){const i={};let r=c(n,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const a=c(t,["gcsUri"]);e!==void 0&&a!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(r==="PREFERENCE_TUNING"){const a=c(t,["gcsUri"]);e!==void 0&&a!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}let o=c(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const a=c(t,["vertexDatasetResource"]);e!==void 0&&a!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(o==="PREFERENCE_TUNING"){const a=c(t,["vertexDatasetResource"]);e!==void 0&&a!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}if(c(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function ZE(t,e){const n={},i=c(t,["sdkHttpResponse"]);i!=null&&f(n,["sdkHttpResponse"],i);const r=c(t,["name"]);r!=null&&f(n,["name"],r);const o=c(t,["state"]);o!=null&&f(n,["state"],RE(o));const a=c(t,["createTime"]);a!=null&&f(n,["createTime"],a);const u=c(t,["tuningTask","startTime"]);u!=null&&f(n,["startTime"],u);const d=c(t,["tuningTask","completeTime"]);d!=null&&f(n,["endTime"],d);const p=c(t,["updateTime"]);p!=null&&f(n,["updateTime"],p);const g=c(t,["description"]);g!=null&&f(n,["description"],g);const y=c(t,["baseModel"]);y!=null&&f(n,["baseModel"],y);const T=c(t,["_self"]);return T!=null&&f(n,["tunedModel"],mM(T)),n}function bf(t,e){const n={},i=c(t,["sdkHttpResponse"]);i!=null&&f(n,["sdkHttpResponse"],i);const r=c(t,["name"]);r!=null&&f(n,["name"],r);const o=c(t,["state"]);o!=null&&f(n,["state"],RE(o));const a=c(t,["createTime"]);a!=null&&f(n,["createTime"],a);const u=c(t,["startTime"]);u!=null&&f(n,["startTime"],u);const d=c(t,["endTime"]);d!=null&&f(n,["endTime"],d);const p=c(t,["updateTime"]);p!=null&&f(n,["updateTime"],p);const g=c(t,["error"]);g!=null&&f(n,["error"],g);const y=c(t,["description"]);y!=null&&f(n,["description"],y);const T=c(t,["baseModel"]);T!=null&&f(n,["baseModel"],T);const I=c(t,["tunedModel"]);I!=null&&f(n,["tunedModel"],I);const V=c(t,["preTunedModel"]);V!=null&&f(n,["preTunedModel"],V);const b=c(t,["supervisedTuningSpec"]);b!=null&&f(n,["supervisedTuningSpec"],b);const q=c(t,["preferenceOptimizationSpec"]);q!=null&&f(n,["preferenceOptimizationSpec"],q);const A=c(t,["tuningDataStats"]);A!=null&&f(n,["tuningDataStats"],A);const x=c(t,["encryptionSpec"]);x!=null&&f(n,["encryptionSpec"],x);const R=c(t,["partnerModelTuningSpec"]);R!=null&&f(n,["partnerModelTuningSpec"],R);const z=c(t,["customBaseModel"]);z!=null&&f(n,["customBaseModel"],z);const W=c(t,["experiment"]);W!=null&&f(n,["experiment"],W);const J=c(t,["labels"]);J!=null&&f(n,["labels"],J);const k=c(t,["outputUri"]);k!=null&&f(n,["outputUri"],k);const N=c(t,["pipelineJob"]);N!=null&&f(n,["pipelineJob"],N);const D=c(t,["serviceAccount"]);D!=null&&f(n,["serviceAccount"],D);const F=c(t,["tunedModelDisplayName"]);F!=null&&f(n,["tunedModelDisplayName"],F);const B=c(t,["veoTuningSpec"]);return B!=null&&f(n,["veoTuningSpec"],B),n}function yM(t,e){const n={},i=c(t,["sdkHttpResponse"]);i!=null&&f(n,["sdkHttpResponse"],i);const r=c(t,["name"]);r!=null&&f(n,["name"],r);const o=c(t,["metadata"]);o!=null&&f(n,["metadata"],o);const a=c(t,["done"]);a!=null&&f(n,["done"],a);const u=c(t,["error"]);return u!=null&&f(n,["error"],u),n}function ev(t,e){const n={},i=c(t,["gcsUri"]);i!=null&&f(n,["validationDatasetUri"],i);const r=c(t,["vertexDatasetResource"]);return r!=null&&f(n,["validationDatasetUri"],r),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vM extends Li{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new oo(Pi.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var i;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const r={tunedModelName:n.baseModel};!((i=n.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=n.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},n),{preTunedModel:r});return o.baseModel=void 0,await this.tuneInternal(o)}else{const r=Object.assign({},n);return await this.tuneInternal(r)}else{const r=Object.assign({},n),o=await this.tuneMldevInternal(r);let a="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?a=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(a=o.name.split("/operations/")[0]),{name:a,state:Rf.JOB_STATE_QUEUED}}}}async getInternal(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=lM(e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>bf(g))}else{const p=aM(e);return u=ie("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>ZE(g))}}async listInternal(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=hM(e);return u=ie("tuningJobs",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=pM(g),T=new My;return Object.assign(T,y),T})}else{const p=dM(e);return u=ie("tunedModels",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=fM(g),T=new My;return Object.assign(T,y),T})}}async cancel(e){var n,i,r,o;let a,u="",d={};if(this.apiClient.isVertexAI()){const p=eM(e);return u=ie("{name}:cancel",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=nM(g),T=new Ly;return Object.assign(T,y),T})}else{const p=jk(e);return u=ie("{name}:cancel",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const T=y;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const y=tM(g),T=new Ly;return Object.assign(T,y),T})}}async tuneInternal(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI()){const u=sM(e,e);return o=ie("tuningJobs",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:d.headers},g})),r.then(d=>bf(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=oM(e);return o=ie("tunedModels",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:d.headers},g})),r.then(d=>yM(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class TM{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const EM=1024*1024*8,wM=3,CM=1e3,IM=2,Yc="x-goog-upload-status";async function SM(t,e,n){var i;const r=await YE(t,e,n),o=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Yc])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function xM(t,e,n){var i;const r=await YE(t,e,n),o=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Yc])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const a=CE(o),u=new im;return Object.assign(u,a),u}async function YE(t,e,n){var i,r;let o=0,a=0,u=new Nf(new Response),d="upload";for(o=t.size;a<o;){const p=Math.min(EM,o-a),g=t.slice(a,a+p);a+p>=o&&(d+=", finalize");let y=0,T=CM;for(;y<wM&&(u=await n.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(a),"Content-Length":String(p)}}}),!(!((i=u==null?void 0:u.headers)===null||i===void 0)&&i[Yc]));)y++,await PM(T),T=T*IM;if(a+=p,((r=u==null?void 0:u.headers)===null||r===void 0?void 0:r[Yc])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return u}async function AM(t){return{size:t.size,type:t.type}}function PM(t){return new Promise(e=>setTimeout(e,t))}class RM{async upload(e,n,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await SM(e,n,i)}async uploadToFileSearchStore(e,n,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await xM(e,n,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await AM(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NM{create(e,n,i){return new kM(e,n,i)}}class kM{constructor(e,n,i){this.url=e,this.headers=n,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tv="x-goog-api-key";class MM{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(tv)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(tv,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const LM="gl-node/";class DM{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const i=uA(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const r=new MM(this.apiKey);this.apiClient=new lk({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:LM+"web",uploader:new RM,downloader:new TM}),this.models=new Ak(this.apiClient),this.live=new Ek(this.apiClient,r,new NM),this.batches=new UP(this.apiClient),this.chats=new vR(this.models,this.apiClient),this.caches=new gR(this.apiClient),this.files=new RR(this.apiClient),this.operations=new Pk(this.apiClient),this.authTokens=new Gk(this.apiClient),this.tunings=new vM(this.apiClient),this.fileSearchStores=new Xk(this.apiClient)}}const tl=t=>typeof t=="number"&&!isNaN(t),Bn=t=>typeof t=="string",QE=t=>Array.isArray(t),Cl=t=>t&&tl(t.lat)&&tl(t.lng),VM=t=>t&&Bn(t.description)&&QE(t.path)&&t.path.every(Cl),bM=t=>t&&Bn(t.name)&&Cl(t.position),FM=t=>t&&QE(t.path)&&t.path.every(Cl)&&Bn(t.level)&&["light","moderate","heavy"].includes(t.level)&&Bn(t.description),UM=t=>t&&Bn(t.name)&&Bn(t.description)&&tl(t.lat)&&tl(t.lng)&&(t.time===void 0||Bn(t.time))&&(t.duration===void 0||Bn(t.duration))&&(t.sequence===void 0||tl(t.sequence)),OM=t=>t&&Bn(t.name)&&Cl(t.start)&&Cl(t.end)&&(t.transport===void 0||Bn(t.transport))&&(t.travelTime===void 0||Bn(t.travelTime));let Qu=null;const Fs=()=>{if(Qu)return Qu;const t="AIzaSyDgaYVoqpLioABK9Wvjq88KF9ByiEnyX6U";return Qu=new DM({apiKey:t}),Qu},BM={name:"location",parameters:{type:We.OBJECT,description:"Geographic coordinates of a location on the SCB Medical College Campus.",properties:{name:{type:We.STRING,description:"Name of the location."},description:{type:We.STRING,description:"Description of activity at this location."},lat:{type:We.NUMBER,description:"Latitude of the location."},lng:{type:We.NUMBER,description:"Longitude of the location."},time:{type:We.STRING,description:'Time of day to visit (e.g., "09:00").'},duration:{type:We.STRING,description:'Duration of stay (e.g., "45 minutes").'},sequence:{type:We.NUMBER,description:"Order in the day itinerary (1 = first stop)."}},required:["name","description","lat","lng"]}},zM={name:"line",parameters:{type:We.OBJECT,description:"Connection between two locations.",properties:{name:{type:We.STRING,description:"Name of the route segment."},start:{type:We.OBJECT,properties:{lat:{type:We.NUMBER},lng:{type:We.NUMBER}}},end:{type:We.OBJECT,properties:{lat:{type:We.NUMBER},lng:{type:We.NUMBER}}},transport:{type:We.STRING,description:"Mode of transport (Walking, Wheelchair, etc.)."},travelTime:{type:We.STRING,description:"Estimated travel time."}},required:["name","start","end"]}},ql=t=>{let e="";if(t.candidates&&t.candidates.length>0&&t.candidates[0].content&&t.candidates[0].content.parts)for(const n of t.candidates[0].content.parts)n.text&&(e+=n.text);return e},qM=async t=>{try{const e=Fs(),n=`Based on your knowledge, is the location "${t}" part of, or inside, the SCB Medical College & Hospital campus in Cuttack, India? Answer with a single word: "yes" or "no".`,i=await e.models.generateContent({model:"gemini-2.5-flash",contents:n});return ql(i).trim().toLowerCase().includes("yes")}catch(e){return console.error("Error checking location context:",e),!0}},HM=async(t,e="en")=>{var n,i,r,o;try{const a=Fs(),d=`
      You are an expert Day Planner for the SCB Medical College & Hospital Campus in Cuttack.
      Your goal is to create a logical, sequential day plan for a user visiting the campus (e.g., for treatment, visiting a student, or medical formalities).
      
      ${e==="or"?"IMPORTANT: Provide all names, descriptions, and summaries in Odia (Oriya) language. The user speaks Odia.":""}

      **Constraints:**
      1. All coordinates MUST be strictly within the campus bounds: Latitude ~20.478 to 20.486, Longitude ~85.872 to 85.883.
      2. If the user asks for something outside the campus, politely explain you only cover the campus area.
      3. Use the 'location' tool to mark stops with times and sequence numbers.
      4. Use the 'line' tool to connect these stops.
      5. Create a realistic schedule (walking times, waiting times at OPDs).
    `,p=await a.models.generateContent({model:"gemini-2.5-flash",contents:t,config:{systemInstruction:d,temperature:.5,tools:[{functionDeclarations:[BM,zM]}]}}),g=[],y=[];if(p.functionCalls)for(const I of p.functionCalls){const V=I.args;if(V){if(I.name==="location"){const b={name:V.name,description:V.description,lat:Number(V.lat),lng:Number(V.lng),time:V.time,duration:V.duration,sequence:Number(V.sequence)};UM(b)&&g.push(b)}else if(I.name==="line"){const b={name:V.name,start:{lat:Number((n=V.start)==null?void 0:n.lat),lng:Number((i=V.start)==null?void 0:i.lng)},end:{lat:Number((r=V.end)==null?void 0:r.lat),lng:Number((o=V.end)==null?void 0:o.lng)},transport:V.transport,travelTime:V.travelTime};OM(b)&&y.push(b)}}}const T=ql(p);return g.sort((I,V)=>(I.sequence||0)-(V.sequence||0)),{locations:g,lines:y,summaryText:T}}catch(a){throw console.error("Error generating itinerary:",a),a}},GM=async(t,e,n,i,r="en")=>{var o,a,u;try{const d=Fs(),g=`
      You are a hyperlocal navigation expert for the SCB Medical College campus in Cuttack, India. Your primary function is to provide detailed, step-by-step navigation *within this campus*.
      A user needs directions from "${t}" to "${e}".
      
      ${r==="or"?"IMPORTANT: Provide all step descriptions, landmarks names, traffic descriptions, and the final summary in Odia (Oriya) language. The user speaks Odia.":""}

      **IMPORTANT CONTEXT CHECK:**
      1.  **If the route is within the SCB campus:** Proceed to generate a detailed, interactive route plan. The user will be viewing a specific digital map of the campus, so your directions must be precise and reference landmarks visible on that map. The JSON output is critical.
      2.  **If the start or destination is clearly outside the SCB campus (e.g., "Bhubaneswar Airport", another city, etc.):** You MUST respond differently. First, state clearly that your expertise is limited to the SCB campus and you cannot provide an interactive map for their requested route. Then, provide general, high-level text-based directions for their query. In this specific case, the JSON object you generate MUST have empty arrays for "steps", "landmarks", and "traffic".

      The user has provided these notes: "${n}".
      Current user location is approximately latitude: ${i==null?void 0:i.latitude}, longitude: ${i==null?void 0:i.longitude}.
      
      **JSON Object Specification (ONLY FOR ON-CAMPUS ROUTES):**
      The JSON object MUST be in a fenced code block and have the following structure. If the route is off-campus, this object must contain empty arrays as specified above.
      {
        "steps": [
          {
            "description": "A short, clear instruction for this step. e.g., 'Walk from the main gate towards the Department of Surgery.'",
            "path": [{"lat": 20.481, "lng": 85.876}, {"lat": 20.482, "lng": 85.877}]
          }
        ],
        "landmarks": [
          {
            "name": "A key landmark mentioned in the steps. e.g., 'Department of Surgery SCB'",
            "position": {"lat": 20.482, "lng": 85.877}
          }
        ],
        "traffic": [
          {
            "level": "moderate",
            "description": "Reason for congestion. e.g., 'Crowded near OPD building.'",
            "path": [{"lat": 20.482, "lng": 85.877}, {"lat": 20.4825, "lng": 85.8775}]
          }
        ]
      }

      **GUIDELINES (ONLY FOR ON-CAMPUS ROUTES):**
      1.  **Steps**: Break the route into small, logical steps. Each step must have a clear 'description' and a 'path' with an array of coordinates. The path for one step should connect to the next.
      2.  **Landmarks**: Identify key landmarks (e.g., 'Department of Surgery SCB', 'Overhead Water Tank', 'College of Nursing') and provide their precise coordinates in the 'landmarks' array. This is crucial for plotting them on the map.
      3.  **Coordinates**: All coordinates MUST fall within the approximate bounds of the SCB campus (latitude ~20.478 to 20.486, longitude ~85.872 to 85.883).
      4.  **Traffic**: Use your knowledge and tools to identify potential areas of congestion (e.g., near the main entrance, outpatient departments) and add them to the 'traffic' array.
      
      After the JSON block, provide a summary of the route in Markdown. For off-campus routes, this summary will be your main response.
    `,y=await d.models.generateContent({model:"gemini-2.5-pro",contents:g,config:{thinkingConfig:{thinkingBudget:16384},tools:[{googleSearch:{}},{googleMaps:{}}],toolConfig:i?{retrievalConfig:{latLng:{latitude:i.latitude,longitude:i.longitude}}}:void 0}}),T=ql(y);let I=[],V=[],b=[],q=T;const A=/```json\s*([\s\S]*?)\s*```/,x=T.match(A);if(x&&x[1])try{const z=JSON.parse(x[1]);z.steps&&Array.isArray(z.steps)&&(I=z.steps.filter(VM)),z.landmarks&&Array.isArray(z.landmarks)&&(V=z.landmarks.filter(bM)),z.traffic&&Array.isArray(z.traffic)&&(b=z.traffic.filter(FM)),q=T.replace(A,"").trim()}catch(z){console.error("Failed to parse or validate route JSON:",z)}const R=((u=(a=(o=y.candidates)==null?void 0:o[0])==null?void 0:a.groundingMetadata)==null?void 0:u.groundingChunks)||[];return{text:q,groundingChunks:R,steps:I,landmarks:V,trafficSegments:b}}catch(d){return console.error("Error planning route:",d),{text:"Sorry, I couldn't plan a route. Check your API Key.",groundingChunks:[],steps:[],landmarks:[],trafficSegments:[]}}},WM=async(t,e="en")=>{var n,i,r;try{const o=Fs();let a="";typeof t=="string"&&t.trim()!==""?a=`in the area around "${t}"`:typeof t=="object"&&(t!=null&&t.latitude)&&t.longitude?a=`around latitude: ${t.latitude}, longitude: ${t.longitude}`:a="in the general Cuttack area";const d=`
            You are a kind, empathetic, and authoritative Hospital Guide for SCB Medical College, Cuttack.
            A patient or their relative is looking for the "Daily Situation Report" to navigate the campus.

            **YOUR TASK:**
            Search Google for the VERY LATEST updates (last 24 hours) from:
            1. Commissionerate Police Cuttack-Bhubaneswar (Traffic updates)
            2. Cuttack Municipal Corporation (CMC) or Collector Cuttack (Road works/Closures)
            3. SCB Medical College Official Notices (Hospital admin news)
            4. Local news (Weather, Strikes/Bandhs)
            
            ${e==="or"?"OUTPUT MUST BE IN ODIA (ORIYA) SCRIPT.":""}

            **TONE:** 
            Kind, Clear, and Explanatory. Like a helpful volunteer speaking to a worried patient.
            Avoid "police jargon" or dry lists. Explain *what it means* for the patient.

            **STRUCTURE OF RESPONSE:**
            1. **Headline:** A 3-5 word summary of the current status (e.g., "Normal Traffic Flow Today" or "Heavy Rain Alert").
            2. **The Situation Report:** Write 2-3 sentences summarizing the key events. If there is a traffic diversion, explain *where* to go instead. 
            
            **CRITICAL RULES:**
            *   **NO FAKE NEWS:** If you find NO recent updates, state clearly: "We have checked with local authorities and there are no major incidents reported at this time."
            *   **NO BULLET POINTS:** Write in natural, comforting sentences.
            *   **INTEGRITY:** If you mention a specific road closure or event, ensure it is based on a real recent source.
        `,p=await o.models.generateContent({model:"gemini-2.5-flash",contents:d,config:{tools:[{googleSearch:{}}]}}),g=ql(p)||"No major alerts.",y=((r=(i=(n=p.candidates)==null?void 0:n[0])==null?void 0:i.groundingMetadata)==null?void 0:r.groundingChunks)||[];return{text:g,groundingChunks:y}}catch(o){return console.error("Error fetching local updates:",o),{text:"Could not fetch local updates. Check connection.",groundingChunks:[]}}};let Ih=null,nv="en";const $M=(t="en")=>{const e=Fs();if(!Ih||nv!==t){nv=t;const n=t==="or"?"You MUST reply in Odia (Oriya) language.":"";Ih=e.chats.create({model:"gemini-2.5-flash",config:{systemInstruction:`You are a helpful assistant for the Hyperlocal Navi-Assistant app. Answer questions about navigation, local places, or general topics concisely. ${n}`}})}return Ih},KM=async(t,e)=>{try{return await t.sendMessageStream({message:e})}catch(n){throw console.error("Error sending message to chat:",n),new Error("Failed to get a response from the assistant. Check API Key.")}},JM=async(t,e)=>{try{const n=Fs(),r=`
            A user has submitted a traffic report: "${t}".
            Rewrite this to be ultra-concise (under 10 words) for a dashboard ticker. 
            Do not add new facts.
            ${e==="or"?"The output MUST be in Odia (Oriya) language.":"The output MUST be in English."}
        `,o=await n.models.generateContent({model:"gemini-2.5-flash",contents:r});return ql(o).trim()}catch(n){return console.error("Error enhancing report:",n),t}};var iv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},ZM=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const o=t[n++];e[i++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){const o=t[n++],a=t[n++],u=t[n++],d=((r&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[i++]=String.fromCharCode(55296+(d>>10)),e[i++]=String.fromCharCode(56320+(d&1023))}else{const o=t[n++],a=t[n++];e[i++]=String.fromCharCode((r&15)<<12|(o&63)<<6|a&63)}}return e.join("")},jE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<t.length;r+=3){const o=t[r],a=r+1<t.length,u=a?t[r+1]:0,d=r+2<t.length,p=d?t[r+2]:0,g=o>>2,y=(o&3)<<4|u>>4;let T=(u&15)<<2|p>>6,I=p&63;d||(I=64,a||(T=64)),i.push(n[g],n[y],n[T],n[I])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(XE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ZM(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<t.length;){const o=n[t.charAt(r++)],u=r<t.length?n[t.charAt(r)]:0;++r;const p=r<t.length?n[t.charAt(r)]:64;++r;const y=r<t.length?n[t.charAt(r)]:64;if(++r,o==null||u==null||p==null||y==null)throw new YM;const T=o<<2|u>>4;if(i.push(T),p!==64){const I=u<<4&240|p>>2;if(i.push(I),y!==64){const V=p<<6&192|y;i.push(V)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class YM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const QM=function(t){const e=XE(t);return jE.encodeByteArray(e,!0)},Qc=function(t){return QM(t).replace(/\./g,"")},XM=function(t){try{return jE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eL=()=>jM().__FIREBASE_DEFAULTS__,tL=()=>{if(typeof process>"u"||typeof iv>"u")return;const t=iv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},nL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&XM(t[1]);return e&&JSON.parse(e)},um=()=>{try{return eL()||tL()||nL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},iL=t=>{var e,n;return(n=(e=um())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},rL=t=>{const e=iL(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},ew=()=>{var t;return(t=um())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sL(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",r=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Qc(JSON.stringify(n)),Qc(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aL(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function lL(){var t;const e=(t=um())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uL(){return!lL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cL(){try{return typeof indexedDB=="object"}catch{return!1}}function dL(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var o;e(((o=r.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hL="FirebaseError";class Us extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=hL,Object.setPrototypeOf(this,Us.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,tw.prototype.create)}}class tw{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},r=`${this.service}/${e}`,o=this.errors[e],a=o?fL(o,i):"Error",u=`${this.serviceName}: ${a} (${r}).`;return new Us(r,u,i)}}function fL(t,e){return t.replace(pL,(n,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const pL=/\{\$([^}]+)}/g;function Ff(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const o=t[r],a=e[r];if(rv(o)&&rv(a)){if(!Ff(o,a))return!1}else if(o!==a)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function rv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(t){return t&&t._delegate?t._delegate:t}class Il{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Or="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new oL;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_L(e))try{this.getOrInitializeService({instanceIdentifier:Or})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:r});i.resolve(o)}catch{}}}}clearInstance(e=Or){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Or){return this.instances.has(e)}getOptions(e=Or){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[o,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);i===u&&a.resolve(r)}return r}onInit(e,n){var i;const r=this.normalizeInstanceIdentifier(n),o=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(r,o);const a=this.instances.get(r);return a&&e(a,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const r of i)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:gL(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Or){return this.component?this.component.multipleInstances?e:Or:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function gL(t){return t===Or?void 0:t}function _L(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new mL(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Me;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Me||(Me={}));const vL={debug:Me.DEBUG,verbose:Me.VERBOSE,info:Me.INFO,warn:Me.WARN,error:Me.ERROR,silent:Me.SILENT},TL=Me.INFO,EL={[Me.DEBUG]:"log",[Me.VERBOSE]:"log",[Me.INFO]:"info",[Me.WARN]:"warn",[Me.ERROR]:"error"},wL=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),r=EL[e];if(r)console[r](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class nw{constructor(e){this.name=e,this._logLevel=TL,this._logHandler=wL,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Me))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Me.DEBUG,...e),this._logHandler(this,Me.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Me.VERBOSE,...e),this._logHandler(this,Me.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Me.INFO,...e),this._logHandler(this,Me.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Me.WARN,...e),this._logHandler(this,Me.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Me.ERROR,...e),this._logHandler(this,Me.ERROR,...e)}}const CL=(t,e)=>e.some(n=>t instanceof n);let ov,sv;function IL(){return ov||(ov=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function SL(){return sv||(sv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iw=new WeakMap,Uf=new WeakMap,rw=new WeakMap,Sh=new WeakMap,cm=new WeakMap;function xL(t){const e=new Promise((n,i)=>{const r=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{n(ur(t.result)),r()},a=()=>{i(t.error),r()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&iw.set(n,t)}).catch(()=>{}),cm.set(e,t),e}function AL(t){if(Uf.has(t))return;const e=new Promise((n,i)=>{const r=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{n(),r()},a=()=>{i(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});Uf.set(t,e)}let Of={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Uf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||rw.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ur(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function PL(t){Of=t(Of)}function RL(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(xh(this),e,...n);return rw.set(i,e.sort?e.sort():[e]),ur(i)}:SL().includes(t)?function(...e){return t.apply(xh(this),e),ur(iw.get(this))}:function(...e){return ur(t.apply(xh(this),e))}}function NL(t){return typeof t=="function"?RL(t):(t instanceof IDBTransaction&&AL(t),CL(t,IL())?new Proxy(t,Of):t)}function ur(t){if(t instanceof IDBRequest)return xL(t);if(Sh.has(t))return Sh.get(t);const e=NL(t);return e!==t&&(Sh.set(t,e),cm.set(e,t)),e}const xh=t=>cm.get(t);function kL(t,e,{blocked:n,upgrade:i,blocking:r,terminated:o}={}){const a=indexedDB.open(t,e),u=ur(a);return i&&a.addEventListener("upgradeneeded",d=>{i(ur(a.result),d.oldVersion,d.newVersion,ur(a.transaction),d)}),n&&a.addEventListener("blocked",d=>n(d.oldVersion,d.newVersion,d)),u.then(d=>{o&&d.addEventListener("close",()=>o()),r&&d.addEventListener("versionchange",p=>r(p.oldVersion,p.newVersion,p))}).catch(()=>{}),u}const ML=["get","getKey","getAll","getAllKeys","count"],LL=["put","add","delete","clear"],Ah=new Map;function av(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ah.get(e))return Ah.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=LL.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||ML.includes(n)))return;const o=async function(a,...u){const d=this.transaction(a,r?"readwrite":"readonly");let p=d.store;return i&&(p=p.index(u.shift())),(await Promise.all([p[n](...u),r&&d.done]))[0]};return Ah.set(e,o),o}PL(t=>({...t,get:(e,n,i)=>av(e,n)||t.get(e,n,i),has:(e,n)=>!!av(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DL{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(VL(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function VL(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Bf="@firebase/app",lv="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri=new nw("@firebase/app"),bL="@firebase/app-compat",FL="@firebase/analytics-compat",UL="@firebase/analytics",OL="@firebase/app-check-compat",BL="@firebase/app-check",zL="@firebase/auth",qL="@firebase/auth-compat",HL="@firebase/database",GL="@firebase/data-connect",WL="@firebase/database-compat",$L="@firebase/functions",KL="@firebase/functions-compat",JL="@firebase/installations",ZL="@firebase/installations-compat",YL="@firebase/messaging",QL="@firebase/messaging-compat",XL="@firebase/performance",jL="@firebase/performance-compat",e2="@firebase/remote-config",t2="@firebase/remote-config-compat",n2="@firebase/storage",i2="@firebase/storage-compat",r2="@firebase/firestore",o2="@firebase/vertexai-preview",s2="@firebase/firestore-compat",a2="firebase",l2="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf="[DEFAULT]",u2={[Bf]:"fire-core",[bL]:"fire-core-compat",[UL]:"fire-analytics",[FL]:"fire-analytics-compat",[BL]:"fire-app-check",[OL]:"fire-app-check-compat",[zL]:"fire-auth",[qL]:"fire-auth-compat",[HL]:"fire-rtdb",[GL]:"fire-data-connect",[WL]:"fire-rtdb-compat",[$L]:"fire-fn",[KL]:"fire-fn-compat",[JL]:"fire-iid",[ZL]:"fire-iid-compat",[YL]:"fire-fcm",[QL]:"fire-fcm-compat",[XL]:"fire-perf",[jL]:"fire-perf-compat",[e2]:"fire-rc",[t2]:"fire-rc-compat",[n2]:"fire-gcs",[i2]:"fire-gcs-compat",[r2]:"fire-fst",[s2]:"fire-fst-compat",[o2]:"fire-vertex","fire-js":"fire-js",[a2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc=new Map,c2=new Map,qf=new Map;function uv(t,e){try{t.container.addComponent(e)}catch(n){Ri.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function jc(t){const e=t.name;if(qf.has(e))return Ri.debug(`There were multiple attempts to register component ${e}.`),!1;qf.set(e,t);for(const n of Xc.values())uv(n,t);for(const n of c2.values())uv(n,t);return!0}function d2(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cr=new tw("app","Firebase",h2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(e,n,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Il("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2=l2;function ow(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i=Object.assign({name:zf,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw cr.create("bad-app-name",{appName:String(r)});if(n||(n=ew()),!n)throw cr.create("no-options");const o=Xc.get(r);if(o){if(Ff(n,o.options)&&Ff(i,o.config))return o;throw cr.create("duplicate-app",{appName:r})}const a=new yL(r);for(const d of qf.values())a.addComponent(d);const u=new f2(n,i,a);return Xc.set(r,u),u}function m2(t=zf){const e=Xc.get(t);if(!e&&t===zf&&ew())return ow();if(!e)throw cr.create("no-app",{appName:t});return e}function fs(t,e,n){var i;let r=(i=u2[t])!==null&&i!==void 0?i:t;n&&(r+=`-${n}`);const o=r.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const u=[`Unable to register library "${r}" with version "${e}":`];o&&u.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ri.warn(u.join(" "));return}jc(new Il(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2="firebase-heartbeat-database",_2=1,Sl="firebase-heartbeat-store";let Ph=null;function sw(){return Ph||(Ph=kL(g2,_2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Sl)}catch(n){console.warn(n)}}}}).catch(t=>{throw cr.create("idb-open",{originalErrorMessage:t.message})})),Ph}async function y2(t){try{const n=(await sw()).transaction(Sl),i=await n.objectStore(Sl).get(aw(t));return await n.done,i}catch(e){if(e instanceof Us)Ri.warn(e.message);else{const n=cr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ri.warn(n.message)}}}async function cv(t,e){try{const i=(await sw()).transaction(Sl,"readwrite");await i.objectStore(Sl).put(e,aw(t)),await i.done}catch(n){if(n instanceof Us)Ri.warn(n.message);else{const i=cr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ri.warn(i.message)}}}function aw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2=1024,T2=30*24*60*60*1e3;class E2{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new C2(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=dv();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const u=new Date(a.date).valueOf();return Date.now()-u<=T2}),this._storage.overwrite(this._heartbeatsCache))}catch(i){Ri.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=dv(),{heartbeatsToSend:i,unsentEntries:r}=w2(this._heartbeatsCache.heartbeats),o=Qc(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return Ri.warn(n),""}}}function dv(){return new Date().toISOString().substring(0,10)}function w2(t,e=v2){const n=[];let i=t.slice();for(const r of t){const o=n.find(a=>a.agent===r.agent);if(o){if(o.dates.push(r.date),hv(n)>e){o.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),hv(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class C2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return cL()?dL().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await y2(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return cv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return cv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function hv(t){return Qc(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I2(t){jc(new Il("platform-logger",e=>new DL(e),"PRIVATE")),jc(new Il("heartbeat",e=>new E2(e),"PRIVATE")),fs(Bf,lv,t),fs(Bf,lv,"esm2017"),fs("fire-js","")}I2("");var S2="firebase",x2="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fs(S2,x2,"app");var fv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $r,lw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,N){function D(){}D.prototype=N.prototype,k.D=N.prototype,k.prototype=new D,k.prototype.constructor=k,k.C=function(F,B,U){for(var M=Array(arguments.length-2),le=2;le<arguments.length;le++)M[le-2]=arguments[le];return N.prototype[B].apply(F,M)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,n),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,N,D){D||(D=0);var F=Array(16);if(typeof N=="string")for(var B=0;16>B;++B)F[B]=N.charCodeAt(D++)|N.charCodeAt(D++)<<8|N.charCodeAt(D++)<<16|N.charCodeAt(D++)<<24;else for(B=0;16>B;++B)F[B]=N[D++]|N[D++]<<8|N[D++]<<16|N[D++]<<24;N=k.g[0],D=k.g[1],B=k.g[2];var U=k.g[3],M=N+(U^D&(B^U))+F[0]+3614090360&4294967295;N=D+(M<<7&4294967295|M>>>25),M=U+(B^N&(D^B))+F[1]+3905402710&4294967295,U=N+(M<<12&4294967295|M>>>20),M=B+(D^U&(N^D))+F[2]+606105819&4294967295,B=U+(M<<17&4294967295|M>>>15),M=D+(N^B&(U^N))+F[3]+3250441966&4294967295,D=B+(M<<22&4294967295|M>>>10),M=N+(U^D&(B^U))+F[4]+4118548399&4294967295,N=D+(M<<7&4294967295|M>>>25),M=U+(B^N&(D^B))+F[5]+1200080426&4294967295,U=N+(M<<12&4294967295|M>>>20),M=B+(D^U&(N^D))+F[6]+2821735955&4294967295,B=U+(M<<17&4294967295|M>>>15),M=D+(N^B&(U^N))+F[7]+4249261313&4294967295,D=B+(M<<22&4294967295|M>>>10),M=N+(U^D&(B^U))+F[8]+1770035416&4294967295,N=D+(M<<7&4294967295|M>>>25),M=U+(B^N&(D^B))+F[9]+2336552879&4294967295,U=N+(M<<12&4294967295|M>>>20),M=B+(D^U&(N^D))+F[10]+4294925233&4294967295,B=U+(M<<17&4294967295|M>>>15),M=D+(N^B&(U^N))+F[11]+2304563134&4294967295,D=B+(M<<22&4294967295|M>>>10),M=N+(U^D&(B^U))+F[12]+1804603682&4294967295,N=D+(M<<7&4294967295|M>>>25),M=U+(B^N&(D^B))+F[13]+4254626195&4294967295,U=N+(M<<12&4294967295|M>>>20),M=B+(D^U&(N^D))+F[14]+2792965006&4294967295,B=U+(M<<17&4294967295|M>>>15),M=D+(N^B&(U^N))+F[15]+1236535329&4294967295,D=B+(M<<22&4294967295|M>>>10),M=N+(B^U&(D^B))+F[1]+4129170786&4294967295,N=D+(M<<5&4294967295|M>>>27),M=U+(D^B&(N^D))+F[6]+3225465664&4294967295,U=N+(M<<9&4294967295|M>>>23),M=B+(N^D&(U^N))+F[11]+643717713&4294967295,B=U+(M<<14&4294967295|M>>>18),M=D+(U^N&(B^U))+F[0]+3921069994&4294967295,D=B+(M<<20&4294967295|M>>>12),M=N+(B^U&(D^B))+F[5]+3593408605&4294967295,N=D+(M<<5&4294967295|M>>>27),M=U+(D^B&(N^D))+F[10]+38016083&4294967295,U=N+(M<<9&4294967295|M>>>23),M=B+(N^D&(U^N))+F[15]+3634488961&4294967295,B=U+(M<<14&4294967295|M>>>18),M=D+(U^N&(B^U))+F[4]+3889429448&4294967295,D=B+(M<<20&4294967295|M>>>12),M=N+(B^U&(D^B))+F[9]+568446438&4294967295,N=D+(M<<5&4294967295|M>>>27),M=U+(D^B&(N^D))+F[14]+3275163606&4294967295,U=N+(M<<9&4294967295|M>>>23),M=B+(N^D&(U^N))+F[3]+4107603335&4294967295,B=U+(M<<14&4294967295|M>>>18),M=D+(U^N&(B^U))+F[8]+1163531501&4294967295,D=B+(M<<20&4294967295|M>>>12),M=N+(B^U&(D^B))+F[13]+2850285829&4294967295,N=D+(M<<5&4294967295|M>>>27),M=U+(D^B&(N^D))+F[2]+4243563512&4294967295,U=N+(M<<9&4294967295|M>>>23),M=B+(N^D&(U^N))+F[7]+1735328473&4294967295,B=U+(M<<14&4294967295|M>>>18),M=D+(U^N&(B^U))+F[12]+2368359562&4294967295,D=B+(M<<20&4294967295|M>>>12),M=N+(D^B^U)+F[5]+4294588738&4294967295,N=D+(M<<4&4294967295|M>>>28),M=U+(N^D^B)+F[8]+2272392833&4294967295,U=N+(M<<11&4294967295|M>>>21),M=B+(U^N^D)+F[11]+1839030562&4294967295,B=U+(M<<16&4294967295|M>>>16),M=D+(B^U^N)+F[14]+4259657740&4294967295,D=B+(M<<23&4294967295|M>>>9),M=N+(D^B^U)+F[1]+2763975236&4294967295,N=D+(M<<4&4294967295|M>>>28),M=U+(N^D^B)+F[4]+1272893353&4294967295,U=N+(M<<11&4294967295|M>>>21),M=B+(U^N^D)+F[7]+4139469664&4294967295,B=U+(M<<16&4294967295|M>>>16),M=D+(B^U^N)+F[10]+3200236656&4294967295,D=B+(M<<23&4294967295|M>>>9),M=N+(D^B^U)+F[13]+681279174&4294967295,N=D+(M<<4&4294967295|M>>>28),M=U+(N^D^B)+F[0]+3936430074&4294967295,U=N+(M<<11&4294967295|M>>>21),M=B+(U^N^D)+F[3]+3572445317&4294967295,B=U+(M<<16&4294967295|M>>>16),M=D+(B^U^N)+F[6]+76029189&4294967295,D=B+(M<<23&4294967295|M>>>9),M=N+(D^B^U)+F[9]+3654602809&4294967295,N=D+(M<<4&4294967295|M>>>28),M=U+(N^D^B)+F[12]+3873151461&4294967295,U=N+(M<<11&4294967295|M>>>21),M=B+(U^N^D)+F[15]+530742520&4294967295,B=U+(M<<16&4294967295|M>>>16),M=D+(B^U^N)+F[2]+3299628645&4294967295,D=B+(M<<23&4294967295|M>>>9),M=N+(B^(D|~U))+F[0]+4096336452&4294967295,N=D+(M<<6&4294967295|M>>>26),M=U+(D^(N|~B))+F[7]+1126891415&4294967295,U=N+(M<<10&4294967295|M>>>22),M=B+(N^(U|~D))+F[14]+2878612391&4294967295,B=U+(M<<15&4294967295|M>>>17),M=D+(U^(B|~N))+F[5]+4237533241&4294967295,D=B+(M<<21&4294967295|M>>>11),M=N+(B^(D|~U))+F[12]+1700485571&4294967295,N=D+(M<<6&4294967295|M>>>26),M=U+(D^(N|~B))+F[3]+2399980690&4294967295,U=N+(M<<10&4294967295|M>>>22),M=B+(N^(U|~D))+F[10]+4293915773&4294967295,B=U+(M<<15&4294967295|M>>>17),M=D+(U^(B|~N))+F[1]+2240044497&4294967295,D=B+(M<<21&4294967295|M>>>11),M=N+(B^(D|~U))+F[8]+1873313359&4294967295,N=D+(M<<6&4294967295|M>>>26),M=U+(D^(N|~B))+F[15]+4264355552&4294967295,U=N+(M<<10&4294967295|M>>>22),M=B+(N^(U|~D))+F[6]+2734768916&4294967295,B=U+(M<<15&4294967295|M>>>17),M=D+(U^(B|~N))+F[13]+1309151649&4294967295,D=B+(M<<21&4294967295|M>>>11),M=N+(B^(D|~U))+F[4]+4149444226&4294967295,N=D+(M<<6&4294967295|M>>>26),M=U+(D^(N|~B))+F[11]+3174756917&4294967295,U=N+(M<<10&4294967295|M>>>22),M=B+(N^(U|~D))+F[2]+718787259&4294967295,B=U+(M<<15&4294967295|M>>>17),M=D+(U^(B|~N))+F[9]+3951481745&4294967295,k.g[0]=k.g[0]+N&4294967295,k.g[1]=k.g[1]+(B+(M<<21&4294967295|M>>>11))&4294967295,k.g[2]=k.g[2]+B&4294967295,k.g[3]=k.g[3]+U&4294967295}i.prototype.u=function(k,N){N===void 0&&(N=k.length);for(var D=N-this.blockSize,F=this.B,B=this.h,U=0;U<N;){if(B==0)for(;U<=D;)r(this,k,U),U+=this.blockSize;if(typeof k=="string"){for(;U<N;)if(F[B++]=k.charCodeAt(U++),B==this.blockSize){r(this,F),B=0;break}}else for(;U<N;)if(F[B++]=k[U++],B==this.blockSize){r(this,F),B=0;break}}this.h=B,this.o+=N},i.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var N=1;N<k.length-8;++N)k[N]=0;var D=8*this.o;for(N=k.length-8;N<k.length;++N)k[N]=D&255,D/=256;for(this.u(k),k=Array(16),N=D=0;4>N;++N)for(var F=0;32>F;F+=8)k[D++]=this.g[N]>>>F&255;return k};function o(k,N){var D=u;return Object.prototype.hasOwnProperty.call(D,k)?D[k]:D[k]=N(k)}function a(k,N){this.h=N;for(var D=[],F=!0,B=k.length-1;0<=B;B--){var U=k[B]|0;F&&U==N||(D[B]=U,F=!1)}this.g=D}var u={};function d(k){return-128<=k&&128>k?o(k,function(N){return new a([N|0],0>N?-1:0)}):new a([k|0],0>k?-1:0)}function p(k){if(isNaN(k)||!isFinite(k))return y;if(0>k)return q(p(-k));for(var N=[],D=1,F=0;k>=D;F++)N[F]=k/D|0,D*=4294967296;return new a(N,0)}function g(k,N){if(k.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(k.charAt(0)=="-")return q(g(k.substring(1),N));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var D=p(Math.pow(N,8)),F=y,B=0;B<k.length;B+=8){var U=Math.min(8,k.length-B),M=parseInt(k.substring(B,B+U),N);8>U?(U=p(Math.pow(N,U)),F=F.j(U).add(p(M))):(F=F.j(D),F=F.add(p(M)))}return F}var y=d(0),T=d(1),I=d(16777216);t=a.prototype,t.m=function(){if(b(this))return-q(this).m();for(var k=0,N=1,D=0;D<this.g.length;D++){var F=this.i(D);k+=(0<=F?F:4294967296+F)*N,N*=4294967296}return k},t.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(V(this))return"0";if(b(this))return"-"+q(this).toString(k);for(var N=p(Math.pow(k,6)),D=this,F="";;){var B=z(D,N).g;D=A(D,B.j(N));var U=((0<D.g.length?D.g[0]:D.h)>>>0).toString(k);if(D=B,V(D))return U+F;for(;6>U.length;)U="0"+U;F=U+F}},t.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function V(k){if(k.h!=0)return!1;for(var N=0;N<k.g.length;N++)if(k.g[N]!=0)return!1;return!0}function b(k){return k.h==-1}t.l=function(k){return k=A(this,k),b(k)?-1:V(k)?0:1};function q(k){for(var N=k.g.length,D=[],F=0;F<N;F++)D[F]=~k.g[F];return new a(D,~k.h).add(T)}t.abs=function(){return b(this)?q(this):this},t.add=function(k){for(var N=Math.max(this.g.length,k.g.length),D=[],F=0,B=0;B<=N;B++){var U=F+(this.i(B)&65535)+(k.i(B)&65535),M=(U>>>16)+(this.i(B)>>>16)+(k.i(B)>>>16);F=M>>>16,U&=65535,M&=65535,D[B]=M<<16|U}return new a(D,D[D.length-1]&-2147483648?-1:0)};function A(k,N){return k.add(q(N))}t.j=function(k){if(V(this)||V(k))return y;if(b(this))return b(k)?q(this).j(q(k)):q(q(this).j(k));if(b(k))return q(this.j(q(k)));if(0>this.l(I)&&0>k.l(I))return p(this.m()*k.m());for(var N=this.g.length+k.g.length,D=[],F=0;F<2*N;F++)D[F]=0;for(F=0;F<this.g.length;F++)for(var B=0;B<k.g.length;B++){var U=this.i(F)>>>16,M=this.i(F)&65535,le=k.i(B)>>>16,De=k.i(B)&65535;D[2*F+2*B]+=M*De,x(D,2*F+2*B),D[2*F+2*B+1]+=U*De,x(D,2*F+2*B+1),D[2*F+2*B+1]+=M*le,x(D,2*F+2*B+1),D[2*F+2*B+2]+=U*le,x(D,2*F+2*B+2)}for(F=0;F<N;F++)D[F]=D[2*F+1]<<16|D[2*F];for(F=N;F<2*N;F++)D[F]=0;return new a(D,0)};function x(k,N){for(;(k[N]&65535)!=k[N];)k[N+1]+=k[N]>>>16,k[N]&=65535,N++}function R(k,N){this.g=k,this.h=N}function z(k,N){if(V(N))throw Error("division by zero");if(V(k))return new R(y,y);if(b(k))return N=z(q(k),N),new R(q(N.g),q(N.h));if(b(N))return N=z(k,q(N)),new R(q(N.g),N.h);if(30<k.g.length){if(b(k)||b(N))throw Error("slowDivide_ only works with positive integers.");for(var D=T,F=N;0>=F.l(k);)D=W(D),F=W(F);var B=J(D,1),U=J(F,1);for(F=J(F,2),D=J(D,2);!V(F);){var M=U.add(F);0>=M.l(k)&&(B=B.add(D),U=M),F=J(F,1),D=J(D,1)}return N=A(k,B.j(N)),new R(B,N)}for(B=y;0<=k.l(N);){for(D=Math.max(1,Math.floor(k.m()/N.m())),F=Math.ceil(Math.log(D)/Math.LN2),F=48>=F?1:Math.pow(2,F-48),U=p(D),M=U.j(N);b(M)||0<M.l(k);)D-=F,U=p(D),M=U.j(N);V(U)&&(U=T),B=B.add(U),k=A(k,M)}return new R(B,k)}t.A=function(k){return z(this,k).h},t.and=function(k){for(var N=Math.max(this.g.length,k.g.length),D=[],F=0;F<N;F++)D[F]=this.i(F)&k.i(F);return new a(D,this.h&k.h)},t.or=function(k){for(var N=Math.max(this.g.length,k.g.length),D=[],F=0;F<N;F++)D[F]=this.i(F)|k.i(F);return new a(D,this.h|k.h)},t.xor=function(k){for(var N=Math.max(this.g.length,k.g.length),D=[],F=0;F<N;F++)D[F]=this.i(F)^k.i(F);return new a(D,this.h^k.h)};function W(k){for(var N=k.g.length+1,D=[],F=0;F<N;F++)D[F]=k.i(F)<<1|k.i(F-1)>>>31;return new a(D,k.h)}function J(k,N){var D=N>>5;N%=32;for(var F=k.g.length-D,B=[],U=0;U<F;U++)B[U]=0<N?k.i(U+D)>>>N|k.i(U+D+1)<<32-N:k.i(U+D);return new a(B,k.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,lw=i,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=p,a.fromString=g,$r=a}).apply(typeof fv<"u"?fv:typeof self<"u"?self:typeof window<"u"?window:{});var Xu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uw,za,cw,yc,Hf,dw,hw,fw;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,v,w){return h==Array.prototype||h==Object.prototype||(h[v]=w.value),h};function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xu=="object"&&Xu];for(var v=0;v<h.length;++v){var w=h[v];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var i=n(this);function r(h,v){if(v)e:{var w=i;h=h.split(".");for(var P=0;P<h.length-1;P++){var H=h[P];if(!(H in w))break e;w=w[H]}h=h[h.length-1],P=w[h],v=v(P),v!=P&&v!=null&&e(w,h,{configurable:!0,writable:!0,value:v})}}function o(h,v){h instanceof String&&(h+="");var w=0,P=!1,H={next:function(){if(!P&&w<h.length){var K=w++;return{value:v(K,h[K]),done:!1}}return P=!0,{done:!0,value:void 0}}};return H[Symbol.iterator]=function(){return H},H}r("Array.prototype.values",function(h){return h||function(){return o(this,function(v,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},u=this||self;function d(h){var v=typeof h;return v=v!="object"?v:h?Array.isArray(h)?"array":v:"null",v=="array"||v=="object"&&typeof h.length=="number"}function p(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function g(h,v,w){return h.call.apply(h.bind,arguments)}function y(h,v,w){if(!h)throw Error();if(2<arguments.length){var P=Array.prototype.slice.call(arguments,2);return function(){var H=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(H,P),h.apply(v,H)}}return function(){return h.apply(v,arguments)}}function T(h,v,w){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:y,T.apply(null,arguments)}function I(h,v){var w=Array.prototype.slice.call(arguments,1);return function(){var P=w.slice();return P.push.apply(P,arguments),h.apply(this,P)}}function V(h,v){function w(){}w.prototype=v.prototype,h.aa=v.prototype,h.prototype=new w,h.prototype.constructor=h,h.Qb=function(P,H,K){for(var te=Array(arguments.length-2),Oe=2;Oe<arguments.length;Oe++)te[Oe-2]=arguments[Oe];return v.prototype[H].apply(P,te)}}function b(h){const v=h.length;if(0<v){const w=Array(v);for(let P=0;P<v;P++)w[P]=h[P];return w}return[]}function q(h,v){for(let w=1;w<arguments.length;w++){const P=arguments[w];if(d(P)){const H=h.length||0,K=P.length||0;h.length=H+K;for(let te=0;te<K;te++)h[H+te]=P[te]}else h.push(P)}}class A{constructor(v,w){this.i=v,this.j=w,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function x(h){return/^[\s\xa0]*$/.test(h)}function R(){var h=u.navigator;return h&&(h=h.userAgent)?h:""}function z(h){return z[" "](h),h}z[" "]=function(){};var W=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function J(h,v,w){for(const P in h)v.call(w,h[P],P,h)}function k(h,v){for(const w in h)v.call(void 0,h[w],w,h)}function N(h){const v={};for(const w in h)v[w]=h[w];return v}const D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(h,v){let w,P;for(let H=1;H<arguments.length;H++){P=arguments[H];for(w in P)h[w]=P[w];for(let K=0;K<D.length;K++)w=D[K],Object.prototype.hasOwnProperty.call(P,w)&&(h[w]=P[w])}}function B(h){var v=1;h=h.split(":");const w=[];for(;0<v&&h.length;)w.push(h.shift()),v--;return h.length&&w.push(h.join(":")),w}function U(h){u.setTimeout(()=>{throw h},0)}function M(){var h=fe;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class le{constructor(){this.h=this.g=null}add(v,w){const P=De.get();P.set(v,w),this.h?this.h.next=P:this.g=P,this.h=P}}var De=new A(()=>new we,h=>h.reset());class we{constructor(){this.next=this.g=this.h=null}set(v,w){this.h=v,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let Fe,Z=!1,fe=new le,ee=()=>{const h=u.Promise.resolve(void 0);Fe=()=>{h.then(pe)}};var pe=()=>{for(var h;h=M();){try{h.h.call(h.g)}catch(w){U(w)}var v=De;v.j(h),100>v.h&&(v.h++,h.next=v.g,v.g=h)}Z=!1};function Ee(){this.s=this.s,this.C=this.C}Ee.prototype.s=!1,Ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ae(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}Ae.prototype.h=function(){this.defaultPrevented=!0};var Ue=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const w=()=>{};u.addEventListener("test",w,v),u.removeEventListener("test",w,v)}catch{}return h}();function Ce(h,v){if(Ae.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var w=this.type=h.type,P=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget){if(W){e:{try{z(v.nodeName);var H=!0;break e}catch{}H=!1}H||(v=null)}}else w=="mouseover"?v=h.fromElement:w=="mouseout"&&(v=h.toElement);this.relatedTarget=v,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:_e[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Ce.aa.h.call(this)}}V(Ce,Ae);var _e={2:"touch",3:"pen",4:"mouse"};Ce.prototype.h=function(){Ce.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var _t="closure_listenable_"+(1e6*Math.random()|0),$n=0;function Xl(h,v,w,P,H){this.listener=h,this.proxy=null,this.src=v,this.type=w,this.capture=!!P,this.ha=H,this.key=++$n,this.da=this.fa=!1}function Vi(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function bi(h){this.src=h,this.g={},this.h=0}bi.prototype.add=function(h,v,w,P,H){var K=h.toString();h=this.g[K],h||(h=this.g[K]=[],this.h++);var te=Cr(h,v,P,H);return-1<te?(v=h[te],w||(v.fa=!1)):(v=new Xl(v,this.src,K,!!P,H),v.fa=w,h.push(v)),v};function ai(h,v){var w=v.type;if(w in h.g){var P=h.g[w],H=Array.prototype.indexOf.call(P,v,void 0),K;(K=0<=H)&&Array.prototype.splice.call(P,H,1),K&&(Vi(v),h.g[w].length==0&&(delete h.g[w],h.h--))}}function Cr(h,v,w,P){for(var H=0;H<h.length;++H){var K=h[H];if(!K.da&&K.listener==v&&K.capture==!!w&&K.ha==P)return H}return-1}var Hs="closure_lm_"+(1e6*Math.random()|0),uo={};function Gs(h,v,w,P,H){if(Array.isArray(v)){for(var K=0;K<v.length;K++)Gs(h,v[K],w,P,H);return null}return w=tu(w),h&&h[_t]?h.K(v,w,p(P)?!!P.capture:!1,H):Ws(h,v,w,!1,P,H)}function Ws(h,v,w,P,H,K){if(!v)throw Error("Invalid event type");var te=p(H)?!!H.capture:!!H,Oe=po(h);if(Oe||(h[Hs]=Oe=new bi(h)),w=Oe.add(v,w,P,te,K),w.proxy)return w;if(P=co(),w.proxy=P,P.src=h,P.listener=w,h.addEventListener)Ue||(H=te),H===void 0&&(H=!1),h.addEventListener(v.toString(),P,H);else if(h.attachEvent)h.attachEvent(fo(v.toString()),P);else if(h.addListener&&h.removeListener)h.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return w}function co(){function h(w){return v.call(h.src,h.listener,w)}const v=eu;return h}function jl(h,v,w,P,H){if(Array.isArray(v))for(var K=0;K<v.length;K++)jl(h,v[K],w,P,H);else P=p(P)?!!P.capture:!!P,w=tu(w),h&&h[_t]?(h=h.i,v=String(v).toString(),v in h.g&&(K=h.g[v],w=Cr(K,w,P,H),-1<w&&(Vi(K[w]),Array.prototype.splice.call(K,w,1),K.length==0&&(delete h.g[v],h.h--)))):h&&(h=po(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Cr(v,w,P,H)),(w=-1<h?v[h]:null)&&ho(w))}function ho(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[_t])ai(v.i,h);else{var w=h.type,P=h.proxy;v.removeEventListener?v.removeEventListener(w,P,h.capture):v.detachEvent?v.detachEvent(fo(w),P):v.addListener&&v.removeListener&&v.removeListener(P),(w=po(v))?(ai(w,h),w.h==0&&(w.src=null,v[Hs]=null)):Vi(h)}}}function fo(h){return h in uo?uo[h]:uo[h]="on"+h}function eu(h,v){if(h.da)h=!0;else{v=new Ce(v,this);var w=h.listener,P=h.ha||h.src;h.fa&&ho(h),h=w.call(P,v)}return h}function po(h){return h=h[Hs],h instanceof bi?h:null}var $s="__closure_events_fn_"+(1e9*Math.random()>>>0);function tu(h){return typeof h=="function"?h:(h[$s]||(h[$s]=function(v){return h.handleEvent(v)}),h[$s])}function dt(){Ee.call(this),this.i=new bi(this),this.M=this,this.F=null}V(dt,Ee),dt.prototype[_t]=!0,dt.prototype.removeEventListener=function(h,v,w,P){jl(this,h,v,w,P)};function Et(h,v){var w,P=h.F;if(P)for(w=[];P;P=P.F)w.push(P);if(h=h.M,P=v.type||v,typeof v=="string")v=new Ae(v,h);else if(v instanceof Ae)v.target=v.target||h;else{var H=v;v=new Ae(P,h),F(v,H)}if(H=!0,w)for(var K=w.length-1;0<=K;K--){var te=v.g=w[K];H=Ir(te,P,!0,v)&&H}if(te=v.g=h,H=Ir(te,P,!0,v)&&H,H=Ir(te,P,!1,v)&&H,w)for(K=0;K<w.length;K++)te=v.g=w[K],H=Ir(te,P,!1,v)&&H}dt.prototype.N=function(){if(dt.aa.N.call(this),this.i){var h=this.i,v;for(v in h.g){for(var w=h.g[v],P=0;P<w.length;P++)Vi(w[P]);delete h.g[v],h.h--}}this.F=null},dt.prototype.K=function(h,v,w,P){return this.i.add(String(h),v,!1,w,P)},dt.prototype.L=function(h,v,w,P){return this.i.add(String(h),v,!0,w,P)};function Ir(h,v,w,P){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();for(var H=!0,K=0;K<v.length;++K){var te=v[K];if(te&&!te.da&&te.capture==w){var Oe=te.listener,ht=te.ha||te.src;te.fa&&ai(h.i,te),H=Oe.call(ht,P)!==!1&&H}}return H&&!P.defaultPrevented}function nu(h,v,w){if(typeof h=="function")w&&(h=T(h,w));else if(h&&typeof h.handleEvent=="function")h=T(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:u.setTimeout(h,v||0)}function Ks(h){h.g=nu(()=>{h.g=null,h.i&&(h.i=!1,Ks(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class iu extends Ee{constructor(v,w){super(),this.m=v,this.l=w,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Ks(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Sr(h){Ee.call(this),this.h=h,this.g={}}V(Sr,Ee);var Js=[];function mo(h){J(h.g,function(v,w){this.g.hasOwnProperty(w)&&ho(v)},h),h.g={}}Sr.prototype.N=function(){Sr.aa.N.call(this),mo(this)},Sr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var go=u.JSON.stringify,Gd=u.JSON.parse,xr=class{stringify(h){return u.JSON.stringify(h,void 0)}parse(h){return u.JSON.parse(h,void 0)}};function Zs(){}Zs.prototype.h=null;function ru(h){return h.h||(h.h=h.i())}function Ys(){}var Fi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function _o(){Ae.call(this,"d")}V(_o,Ae);function Qs(){Ae.call(this,"c")}V(Qs,Ae);var li={},ou=null;function yo(){return ou=ou||new dt}li.La="serverreachability";function su(h){Ae.call(this,li.La,h)}V(su,Ae);function Ar(h){const v=yo();Et(v,new su(v))}li.STAT_EVENT="statevent";function vo(h,v){Ae.call(this,li.STAT_EVENT,h),this.stat=v}V(vo,Ae);function At(h){const v=yo();Et(v,new vo(v,h))}li.Ma="timingevent";function au(h,v){Ae.call(this,li.Ma,h),this.size=v}V(au,Ae);function Pr(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){h()},v)}function Rr(){this.g=!0}Rr.prototype.xa=function(){this.g=!1};function mn(h,v,w,P,H,K){h.info(function(){if(h.g)if(K)for(var te="",Oe=K.split("&"),ht=0;ht<Oe.length;ht++){var Ne=Oe[ht].split("=");if(1<Ne.length){var He=Ne[0];Ne=Ne[1];var tt=He.split("_");te=2<=tt.length&&tt[1]=="type"?te+(He+"="+Ne+"&"):te+(He+"=redacted&")}}else te=null;else te=K;return"XMLHTTP REQ ("+P+") [attempt "+H+"]: "+v+`
`+w+`
`+te})}function ue(h,v,w,P,H,K,te){h.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+H+"]: "+v+`
`+w+`
`+K+" "+te})}function ui(h,v,w,P){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+uu(h,w)+(P?" "+P:"")})}function lu(h,v){h.info(function(){return"TIMEOUT: "+v})}Rr.prototype.info=function(){};function uu(h,v){if(!h.g)return v;if(!v)return null;try{var w=JSON.parse(v);if(w){for(h=0;h<w.length;h++)if(Array.isArray(w[h])){var P=w[h];if(!(2>P.length)){var H=P[1];if(Array.isArray(H)&&!(1>H.length)){var K=H[0];if(K!="noop"&&K!="stop"&&K!="close")for(var te=1;te<H.length;te++)H[te]=""}}}}return go(w)}catch{return v}}var Nr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},To={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Eo;function kn(){}V(kn,Zs),kn.prototype.g=function(){return new XMLHttpRequest},kn.prototype.i=function(){return{}},Eo=new kn;function Mn(h,v,w,P){this.j=h,this.i=v,this.l=w,this.R=P||1,this.U=new Sr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new cu}function cu(){this.i=null,this.g="",this.h=!1}var du={},Xs={};function js(h,v,w){h.L=1,h.v=_n(st(v)),h.m=w,h.P=!0,ea(h,null)}function ea(h,v){h.F=Date.now(),Co(h),h.A=st(h.v);var w=h.A,P=h.R;Array.isArray(P)||(P=[String(P)]),pu(w.i,"t",P),h.C=0,w=h.j.J,h.h=new cu,h.g=Eu(h.j,w?v:null,!h.m),0<h.O&&(h.M=new iu(T(h.Y,h,h.g),h.O)),v=h.U,w=h.g,P=h.ca;var H="readystatechange";Array.isArray(H)||(H&&(Js[0]=H.toString()),H=Js);for(var K=0;K<H.length;K++){var te=Gs(w,H[K],P||v.handleEvent,!1,v.h||v);if(!te)break;v.g[te.key]=te}v=h.H?N(h.H):{},h.m?(h.u||(h.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,v)):(h.u="GET",h.g.ea(h.A,h.u,null,v)),Ar(),mn(h.i,h.u,h.A,h.l,h.R,h.m)}Mn.prototype.ca=function(h){h=h.target;const v=this.M;v&&Ht(h)==3?v.j():this.Y(h)},Mn.prototype.Y=function(h){try{if(h==this.g)e:{const tt=Ht(this.g);var v=this.g.Ba();const Gi=this.g.Z();if(!(3>tt)&&(tt!=3||this.g&&(this.h.h||this.g.oa()||ga(this.g)))){this.J||tt!=4||v==7||(v==8||0>=Gi?Ar(3):Ar(2)),ta(this);var w=this.g.Z();this.X=w;t:if(hu(this)){var P=ga(this.g);h="";var H=P.length,K=Ht(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ci(this),kr(this);var te="";break t}this.h.i=new u.TextDecoder}for(v=0;v<H;v++)this.h.h=!0,h+=this.h.i.decode(P[v],{stream:!(K&&v==H-1)});P.length=0,this.h.g+=h,this.C=0,te=this.h.g}else te=this.g.oa();if(this.o=w==200,ue(this.i,this.u,this.A,this.l,this.R,tt,w),this.o){if(this.T&&!this.K){t:{if(this.g){var Oe,ht=this.g;if((Oe=ht.g?ht.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(Oe)){var Ne=Oe;break t}}Ne=null}if(w=Ne)ui(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Mr(this,w);else{this.o=!1,this.s=3,At(12),ci(this),kr(this);break e}}if(this.P){w=!0;let lt;for(;!this.J&&this.C<te.length;)if(lt=wo(this,te),lt==Xs){tt==4&&(this.s=4,At(14),w=!1),ui(this.i,this.l,null,"[Incomplete Response]");break}else if(lt==du){this.s=4,At(15),ui(this.i,this.l,te,"[Invalid Chunk]"),w=!1;break}else ui(this.i,this.l,lt,null),Mr(this,lt);if(hu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tt!=4||te.length!=0||this.h.h||(this.s=1,At(16),w=!1),this.o=this.o&&w,!w)ui(this.i,this.l,te,"[Invalid Chunked Response]"),ci(this),kr(this);else if(0<te.length&&!this.W){this.W=!0;var He=this.j;He.g==this&&He.ba&&!He.M&&(He.j.info("Great, no buffering proxy detected. Bytes received: "+te.length),Mo(He),He.M=!0,At(11))}}else ui(this.i,this.l,te,null),Mr(this,te);tt==4&&ci(this),this.o&&!this.J&&(tt==4?ya(this.j,this):(this.o=!1,Co(this)))}else Wd(this.g),w==400&&0<te.indexOf("Unknown SID")?(this.s=3,At(12)):(this.s=0,At(13)),ci(this),kr(this)}}}catch{}finally{}};function hu(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function wo(h,v){var w=h.C,P=v.indexOf(`
`,w);return P==-1?Xs:(w=Number(v.substring(w,P)),isNaN(w)?du:(P+=1,P+w>v.length?Xs:(v=v.slice(P,P+w),h.C=P+w,v)))}Mn.prototype.cancel=function(){this.J=!0,ci(this)};function Co(h){h.S=Date.now()+h.I,fu(h,h.I)}function fu(h,v){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Pr(T(h.ba,h),v)}function ta(h){h.B&&(u.clearTimeout(h.B),h.B=null)}Mn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(lu(this.i,this.A),this.L!=2&&(Ar(),At(17)),ci(this),this.s=2,kr(this)):fu(this,this.S-h)};function kr(h){h.j.G==0||h.J||ya(h.j,h)}function ci(h){ta(h);var v=h.M;v&&typeof v.ma=="function"&&v.ma(),h.M=null,mo(h.U),h.g&&(v=h.g,h.g=null,v.abort(),v.ma())}function Mr(h,v){try{var w=h.j;if(w.G!=0&&(w.g==h||Pe(w.h,h))){if(!h.K&&Pe(w.h,h)&&w.G==3){try{var P=w.Da.g.parse(v)}catch{P=null}if(Array.isArray(P)&&P.length==3){var H=P;if(H[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<h.F)Do(w),No(w);else break e;ko(w),At(18)}}else w.za=H[1],0<w.za-w.T&&37500>H[2]&&w.F&&w.v==0&&!w.C&&(w.C=Pr(T(w.Za,w),6e3));if(1>=Ui(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else mi(w,11)}else if((h.K||w.g==h)&&Do(w),!x(v))for(H=w.Da.g.parse(v),v=0;v<H.length;v++){let Ne=H[v];if(w.T=Ne[0],Ne=Ne[1],w.G==2)if(Ne[0]=="c"){w.K=Ne[1],w.ia=Ne[2];const He=Ne[3];He!=null&&(w.la=He,w.j.info("VER="+w.la));const tt=Ne[4];tt!=null&&(w.Aa=tt,w.j.info("SVER="+w.Aa));const Gi=Ne[5];Gi!=null&&typeof Gi=="number"&&0<Gi&&(P=1.5*Gi,w.L=P,w.j.info("backChannelRequestTimeoutMs_="+P)),P=w;const lt=h.g;if(lt){const bo=lt.g?lt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bo){var K=P.h;K.g||bo.indexOf("spdy")==-1&&bo.indexOf("quic")==-1&&bo.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(Ge(K,K.h),K.h=null))}if(P.D){const Zn=lt.g?lt.g.getResponseHeader("X-HTTP-Session-Id"):null;Zn&&(P.ya=Zn,me(P.I,P.D,Zn))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-h.F,w.j.info("Handshake RTT: "+w.R+"ms")),P=w;var te=h;if(P.qa=Vo(P,P.J?P.ia:null,P.W),te.K){Dr(P.h,te);var Oe=te,ht=P.L;ht&&(Oe.I=ht),Oe.B&&(ta(Oe),Co(Oe)),P.g=te}else Vn(P);0<w.i.length&&Hi(w)}else Ne[0]!="stop"&&Ne[0]!="close"||mi(w,7);else w.G==3&&(Ne[0]=="stop"||Ne[0]=="close"?Ne[0]=="stop"?mi(w,7):Ro(w):Ne[0]!="noop"&&w.l&&w.l.ta(Ne),w.v=0)}}Ar(4)}catch{}}var Lr=class{constructor(h,v){this.g=h,this.map=v}};function na(h){this.l=h||10,u.PerformanceNavigationTiming?(h=u.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ia(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Ui(h){return h.h?1:h.g?h.g.size:0}function Pe(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Ge(h,v){h.g?h.g.add(v):h.h=v}function Dr(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}na.prototype.cancel=function(){if(this.i=di(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function di(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const w of h.g.values())v=v.concat(w.D);return v}return b(h.i)}function Oi(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(d(h)){for(var v=[],w=h.length,P=0;P<w;P++)v.push(h[P]);return v}v=[],w=0;for(P in h)v[w++]=h[P];return v}function ra(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(d(h)||typeof h=="string"){var v=[];h=h.length;for(var w=0;w<h;w++)v.push(w);return v}v=[],w=0;for(const P in h)v[w++]=P;return v}}}function Te(h,v){if(h.forEach&&typeof h.forEach=="function")h.forEach(v,void 0);else if(d(h)||typeof h=="string")Array.prototype.forEach.call(h,v,void 0);else for(var w=ra(h),P=Oi(h),H=P.length,K=0;K<H;K++)v.call(void 0,P[K],w&&w[K],h)}var Qe=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function oa(h,v){if(h){h=h.split("&");for(var w=0;w<h.length;w++){var P=h[w].indexOf("="),H=null;if(0<=P){var K=h[w].substring(0,P);H=h[w].substring(P+1)}else K=h[w];v(K,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function gn(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof gn){this.h=h.h,Io(this,h.j),this.o=h.o,this.g=h.g,hi(this,h.s),this.l=h.l;var v=h.i,w=new fi;w.i=v.i,v.g&&(w.g=new Map(v.g),w.h=v.h),Kn(this,w),this.m=h.m}else h&&(v=String(h).match(Qe))?(this.h=!1,Io(this,v[1]||"",!0),this.o=Ln(v[2]||""),this.g=Ln(v[3]||"",!0),hi(this,v[4]),this.l=Ln(v[5]||"",!0),Kn(this,v[6]||"",!0),this.m=Ln(v[7]||"")):(this.h=!1,this.i=new fi(null,this.h))}gn.prototype.toString=function(){var h=[],v=this.j;v&&h.push(Dn(v,Bi,!0),":");var w=this.g;return(w||v=="file")&&(h.push("//"),(v=this.o)&&h.push(Dn(v,Bi,!0),"@"),h.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&h.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&h.push("/"),h.push(Dn(w,w.charAt(0)=="/"?la:aa,!0))),(w=this.i.toString())&&h.push("?",w),(w=this.m)&&h.push("#",Dn(w,ua)),h.join("")};function st(h){return new gn(h)}function Io(h,v,w){h.j=w?Ln(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function hi(h,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);h.s=v}else h.s=null}function Kn(h,v,w){v instanceof fi?(h.i=v,yn(h.i,h.h)):(w||(v=Dn(v,So)),h.i=new fi(v,h.h))}function me(h,v,w){h.i.set(v,w)}function _n(h){return me(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Ln(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Dn(h,v,w){return typeof h=="string"?(h=encodeURI(h).replace(v,sa),w&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function sa(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Bi=/[#\/\?@]/g,aa=/[#\?:]/g,la=/[#\?]/g,So=/[#\?@]/g,ua=/#/g;function fi(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function on(h){h.g||(h.g=new Map,h.h=0,h.i&&oa(h.i,function(v,w){h.add(decodeURIComponent(v.replace(/\+/g," ")),w)}))}t=fi.prototype,t.add=function(h,v){on(this),this.i=null,h=de(this,h);var w=this.g.get(h);return w||this.g.set(h,w=[]),w.push(v),this.h+=1,this};function ca(h,v){on(h),v=de(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function xo(h,v){return on(h),v=de(h,v),h.g.has(v)}t.forEach=function(h,v){on(this),this.g.forEach(function(w,P){w.forEach(function(H){h.call(v,H,P,this)},this)},this)},t.na=function(){on(this);const h=Array.from(this.g.values()),v=Array.from(this.g.keys()),w=[];for(let P=0;P<v.length;P++){const H=h[P];for(let K=0;K<H.length;K++)w.push(v[P])}return w},t.V=function(h){on(this);let v=[];if(typeof h=="string")xo(this,h)&&(v=v.concat(this.g.get(de(this,h))));else{h=Array.from(this.g.values());for(let w=0;w<h.length;w++)v=v.concat(h[w])}return v},t.set=function(h,v){return on(this),this.i=null,h=de(this,h),xo(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},t.get=function(h,v){return h?(h=this.V(h),0<h.length?String(h[0]):v):v};function pu(h,v,w){ca(h,v),0<w.length&&(h.i=null,h.g.set(de(h,v),b(w)),h.h+=w.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(var w=0;w<v.length;w++){var P=v[w];const K=encodeURIComponent(String(P)),te=this.V(P);for(P=0;P<te.length;P++){var H=K;te[P]!==""&&(H+="="+encodeURIComponent(String(te[P]))),h.push(H)}}return this.i=h.join("&")};function de(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function yn(h,v){v&&!h.j&&(on(h),h.i=null,h.g.forEach(function(w,P){var H=P.toLowerCase();P!=H&&(ca(this,P),pu(this,H,w))},h)),h.j=v}function qe(h,v){const w=new Rr;if(u.Image){const P=new Image;P.onload=I(vn,w,"TestLoadImage: loaded",!0,v,P),P.onerror=I(vn,w,"TestLoadImage: error",!1,v,P),P.onabort=I(vn,w,"TestLoadImage: abort",!1,v,P),P.ontimeout=I(vn,w,"TestLoadImage: timeout",!1,v,P),u.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=h}else v(!1)}function mu(h,v){const w=new Rr,P=new AbortController,H=setTimeout(()=>{P.abort(),vn(w,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:P.signal}).then(K=>{clearTimeout(H),K.ok?vn(w,"TestPingServer: ok",!0,v):vn(w,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(H),vn(w,"TestPingServer: error",!1,v)})}function vn(h,v,w,P,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),P(w)}catch{}}function da(){this.g=new xr}function ha(h,v,w){const P=w||"";try{Te(h,function(H,K){let te=H;p(H)&&(te=go(H)),v.push(P+K+"="+encodeURIComponent(te))})}catch(H){throw v.push(P+"type="+encodeURIComponent("_badmap")),H}}function Tn(h){this.l=h.Ub||null,this.j=h.eb||!1}V(Tn,Zs),Tn.prototype.g=function(){return new zi(this.l,this.j)},Tn.prototype.i=function(h){return function(){return h}}({});function zi(h,v){dt.call(this),this.D=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}V(zi,dt),t=zi.prototype,t.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=v,this.readyState=1,sn(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(v.body=h),(this.D||u).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,et(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,sn(this)),this.g&&(this.readyState=3,sn(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;qi(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function qi(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?et(this):sn(this),this.readyState==3&&qi(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,et(this))},t.Qa=function(h){this.g&&(this.response=h,et(this))},t.ga=function(){this.g&&et(this)};function et(h){h.readyState=4,h.l=null,h.j=null,h.v=null,sn(h)}t.setRequestHeader=function(h,v){this.u.append(h,v)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var w=v.next();!w.done;)w=w.value,h.push(w[0]+": "+w[1]),w=v.next();return h.join(`\r
`)};function sn(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(zi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function fa(h){let v="";return J(h,function(w,P){v+=P,v+=":",v+=w,v+=`\r
`}),v}function Ao(h,v,w){e:{for(P in w){var P=!1;break e}P=!0}P||(w=fa(w),typeof h=="string"?w!=null&&encodeURIComponent(String(w)):me(h,v,w))}function Xe(h){dt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}V(Xe,dt);var gu=/^https?$/i,pa=["POST","PUT"];t=Xe.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,v,w,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Eo.g(),this.v=this.o?ru(this.o):ru(Eo),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(K){_u(this,K);return}if(h=w||"",w=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var H in P)w.set(H,P[H]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const K of P.keys())w.set(K,P.get(K));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(w.keys()).find(K=>K.toLowerCase()=="content-type"),H=u.FormData&&h instanceof u.FormData,!(0<=Array.prototype.indexOf.call(pa,v,void 0))||P||H||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,te]of w)this.g.setRequestHeader(K,te);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Zt(this),this.u=!0,this.g.send(h),this.u=!1}catch(K){_u(this,K)}};function _u(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.m=5,ma(h),Po(h)}function ma(h){h.A||(h.A=!0,Et(h,"complete"),Et(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Et(this,"complete"),Et(this,"abort"),Po(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Po(this,!0)),Xe.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Se(this):this.bb())},t.bb=function(){Se(this)};function Se(h){if(h.h&&typeof a<"u"&&(!h.v[1]||Ht(h)!=4||h.Z()!=2)){if(h.u&&Ht(h)==4)nu(h.Ea,0,h);else if(Et(h,"readystatechange"),Ht(h)==4){h.h=!1;try{const te=h.Z();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var w;if(!(w=v)){var P;if(P=te===0){var H=String(h.D).match(Qe)[1]||null;!H&&u.self&&u.self.location&&(H=u.self.location.protocol.slice(0,-1)),P=!gu.test(H?H.toLowerCase():"")}w=P}if(w)Et(h,"complete"),Et(h,"success");else{h.m=6;try{var K=2<Ht(h)?h.g.statusText:""}catch{K=""}h.l=K+" ["+h.Z()+"]",ma(h)}}finally{Po(h)}}}}function Po(h,v){if(h.g){Zt(h);const w=h.g,P=h.v[0]?()=>{}:null;h.g=null,h.v=null,v||Et(h,"ready");try{w.onreadystatechange=P}catch{}}}function Zt(h){h.I&&(u.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function Ht(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<Ht(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Gd(v)}};function ga(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Wd(h){const v={};h=(h.g&&2<=Ht(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<h.length;P++){if(x(h[P]))continue;var w=B(h[P]);const H=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const K=v[H]||[];v[H]=K,K.push(w)}k(v,function(P){return P.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function pi(h,v,w){return w&&w.internalChannelParams&&w.internalChannelParams[h]||v}function yu(h){this.Aa=0,this.i=[],this.j=new Rr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=pi("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=pi("baseRetryDelayMs",5e3,h),this.cb=pi("retryDelaySeedMs",1e4,h),this.Wa=pi("forwardChannelMaxRetries",2,h),this.wa=pi("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new na(h&&h.concurrentRequestLimit),this.Da=new da,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=yu.prototype,t.la=8,t.G=1,t.connect=function(h,v,w,P){At(0),this.W=h,this.H=v||{},w&&P!==void 0&&(this.H.OSID=w,this.H.OAID=P),this.F=this.X,this.I=Vo(this,null,this.W),Hi(this)};function Ro(h){if(vu(h),h.G==3){var v=h.U++,w=st(h.I);if(me(w,"SID",h.K),me(w,"RID",v),me(w,"TYPE","terminate"),Vr(h,w),v=new Mn(h,h.j,v),v.L=2,v.v=_n(st(w)),w=!1,u.navigator&&u.navigator.sendBeacon)try{w=u.navigator.sendBeacon(v.v.toString(),"")}catch{}!w&&u.Image&&(new Image().src=v.v,w=!0),w||(v.g=Eu(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Co(v)}Tu(h)}function No(h){h.g&&(Mo(h),h.g.cancel(),h.g=null)}function vu(h){No(h),h.u&&(u.clearTimeout(h.u),h.u=null),Do(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&u.clearTimeout(h.s),h.s=null)}function Hi(h){if(!ia(h.h)&&!h.s){h.s=!0;var v=h.Ga;Fe||ee(),Z||(Fe(),Z=!0),fe.add(v,h),h.B=0}}function $d(h,v){return Ui(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=v.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Pr(T(h.Ga,h,v),va(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const H=new Mn(this,this.j,h);let K=this.o;if(this.S&&(K?(K=N(K),F(K,this.S)):K=this.S),this.m!==null||this.O||(H.H=K,K=null),this.P)e:{for(var v=0,w=0;w<this.i.length;w++){t:{var P=this.i[w];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(v+=P,4096<v){v=w;break e}if(v===4096||w===this.i.length-1){v=w+1;break e}}v=1e3}else v=1e3;v=_a(this,H,v),w=st(this.I),me(w,"RID",h),me(w,"CVER",22),this.D&&me(w,"X-HTTP-Session-Id",this.D),Vr(this,w),K&&(this.O?v="headers="+encodeURIComponent(String(fa(K)))+"&"+v:this.m&&Ao(w,this.m,K)),Ge(this.h,H),this.Ua&&me(w,"TYPE","init"),this.P?(me(w,"$req",v),me(w,"SID","null"),H.T=!0,js(H,w,null)):js(H,w,v),this.G=2}}else this.G==3&&(h?an(this,h):this.i.length==0||ia(this.h)||an(this))};function an(h,v){var w;v?w=v.l:w=h.U++;const P=st(h.I);me(P,"SID",h.K),me(P,"RID",w),me(P,"AID",h.T),Vr(h,P),h.m&&h.o&&Ao(P,h.m,h.o),w=new Mn(h,h.j,w,h.B+1),h.m===null&&(w.H=h.o),v&&(h.i=v.D.concat(h.i)),v=_a(h,w,1e3),w.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Ge(h.h,w),js(w,P,v)}function Vr(h,v){h.H&&J(h.H,function(w,P){me(v,P,w)}),h.l&&Te({},function(w,P){me(v,P,w)})}function _a(h,v,w){w=Math.min(h.i.length,w);var P=h.l?T(h.l.Na,h.l,h):null;e:{var H=h.i;let K=-1;for(;;){const te=["count="+w];K==-1?0<w?(K=H[0].g,te.push("ofs="+K)):K=0:te.push("ofs="+K);let Oe=!0;for(let ht=0;ht<w;ht++){let Ne=H[ht].g;const He=H[ht].map;if(Ne-=K,0>Ne)K=Math.max(0,H[ht].g-100),Oe=!1;else try{ha(He,te,"req"+Ne+"_")}catch{P&&P(He)}}if(Oe){P=te.join("&");break e}}}return h=h.i.splice(0,w),v.D=h,P}function Vn(h){if(!h.g&&!h.u){h.Y=1;var v=h.Fa;Fe||ee(),Z||(Fe(),Z=!0),fe.add(v,h),h.v=0}}function ko(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Pr(T(h.Fa,h),va(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,Lo(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Pr(T(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,At(10),No(this),Lo(this))};function Mo(h){h.A!=null&&(u.clearTimeout(h.A),h.A=null)}function Lo(h){h.g=new Mn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var v=st(h.qa);me(v,"RID","rpc"),me(v,"SID",h.K),me(v,"AID",h.T),me(v,"CI",h.F?"0":"1"),!h.F&&h.ja&&me(v,"TO",h.ja),me(v,"TYPE","xmlhttp"),Vr(h,v),h.m&&h.o&&Ao(v,h.m,h.o),h.L&&(h.g.I=h.L);var w=h.g;h=h.ia,w.L=1,w.v=_n(st(v)),w.m=null,w.P=!0,ea(w,h)}t.Za=function(){this.C!=null&&(this.C=null,No(this),ko(this),At(19))};function Do(h){h.C!=null&&(u.clearTimeout(h.C),h.C=null)}function ya(h,v){var w=null;if(h.g==v){Do(h),Mo(h),h.g=null;var P=2}else if(Pe(h.h,v))w=v.D,Dr(h.h,v),P=1;else return;if(h.G!=0){if(v.o)if(P==1){w=v.m?v.m.length:0,v=Date.now()-v.F;var H=h.B;P=yo(),Et(P,new au(P,w)),Hi(h)}else Vn(h);else if(H=v.s,H==3||H==0&&0<v.X||!(P==1&&$d(h,v)||P==2&&ko(h)))switch(w&&0<w.length&&(v=h.h,v.i=v.i.concat(w)),H){case 1:mi(h,5);break;case 4:mi(h,10);break;case 3:mi(h,6);break;default:mi(h,2)}}}function va(h,v){let w=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(w*=2),w*v}function mi(h,v){if(h.j.info("Error code "+v),v==2){var w=T(h.fb,h),P=h.Xa;const H=!P;P=new gn(P||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Io(P,"https"),_n(P),H?qe(P.toString(),w):mu(P.toString(),w)}else At(2);h.G=0,h.l&&h.l.sa(v),Tu(h),vu(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),At(2)):(this.j.info("Failed to ping google.com"),At(1))};function Tu(h){if(h.G=0,h.ka=[],h.l){const v=di(h.h);(v.length!=0||h.i.length!=0)&&(q(h.ka,v),q(h.ka,h.i),h.h.i.length=0,b(h.i),h.i.length=0),h.l.ra()}}function Vo(h,v,w){var P=w instanceof gn?st(w):new gn(w);if(P.g!="")v&&(P.g=v+"."+P.g),hi(P,P.s);else{var H=u.location;P=H.protocol,v=v?v+"."+H.hostname:H.hostname,H=+H.port;var K=new gn(null);P&&Io(K,P),v&&(K.g=v),H&&hi(K,H),w&&(K.l=w),P=K}return w=h.D,v=h.ya,w&&v&&me(P,w,v),me(P,"VER",h.la),Vr(h,P),P}function Eu(h,v,w){if(v&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Ca&&!h.pa?new Xe(new Tn({eb:w})):new Xe(h.pa),v.Ha(h.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ta(){}t=Ta.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function br(){}br.prototype.g=function(h,v){return new wt(h,v)};function wt(h,v){dt.call(this),this.g=new yu(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(h?h["X-WebChannel-Client-Profile"]=v.va:h={"X-WebChannel-Client-Profile":v.va}),this.g.S=h,(h=v&&v.Sb)&&!x(h)&&(this.g.m=h),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!x(v)&&(this.g.D=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new En(this)}V(wt,dt),wt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},wt.prototype.close=function(){Ro(this.g)},wt.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var w={};w.__data__=h,h=w}else this.u&&(w={},w.__data__=go(h),h=w);v.i.push(new Lr(v.Ya++,h)),v.G==3&&Hi(v)},wt.prototype.N=function(){this.g.l=null,delete this.j,Ro(this.g),delete this.g,wt.aa.N.call(this)};function Jn(h){_o.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const w in v){h=w;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}V(Jn,_o);function wu(){Qs.call(this),this.status=1}V(wu,Qs);function En(h){this.g=h}V(En,Ta),En.prototype.ua=function(){Et(this.g,"a")},En.prototype.ta=function(h){Et(this.g,new Jn(h))},En.prototype.sa=function(h){Et(this.g,new wu)},En.prototype.ra=function(){Et(this.g,"b")},br.prototype.createWebChannel=br.prototype.g,wt.prototype.send=wt.prototype.o,wt.prototype.open=wt.prototype.m,wt.prototype.close=wt.prototype.close,fw=function(){return new br},hw=function(){return yo()},dw=li,Hf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Nr.NO_ERROR=0,Nr.TIMEOUT=8,Nr.HTTP_ERROR=6,yc=Nr,To.COMPLETE="complete",cw=To,Ys.EventType=Fi,Fi.OPEN="a",Fi.CLOSE="b",Fi.ERROR="c",Fi.MESSAGE="d",dt.prototype.listen=dt.prototype.K,za=Ys,Xe.prototype.listenOnce=Xe.prototype.L,Xe.prototype.getLastError=Xe.prototype.Ka,Xe.prototype.getLastErrorCode=Xe.prototype.Ba,Xe.prototype.getStatus=Xe.prototype.Z,Xe.prototype.getResponseJson=Xe.prototype.Oa,Xe.prototype.getResponseText=Xe.prototype.oa,Xe.prototype.send=Xe.prototype.ea,Xe.prototype.setWithCredentials=Xe.prototype.Ha,uw=Xe}).apply(typeof Xu<"u"?Xu:typeof self<"u"?self:typeof window<"u"?window:{});const pv="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Os="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo=new nw("@firebase/firestore");function Da(){return eo.logLevel}function ae(t,...e){if(eo.logLevel<=Me.DEBUG){const n=e.map(dm);eo.debug(`Firestore (${Os}): ${t}`,...n)}}function Ni(t,...e){if(eo.logLevel<=Me.ERROR){const n=e.map(dm);eo.error(`Firestore (${Os}): ${t}`,...n)}}function Cs(t,...e){if(eo.logLevel<=Me.WARN){const n=e.map(dm);eo.warn(`Firestore (${Os}): ${t}`,...n)}}function dm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ge(t="Unexpected state"){const e=`FIRESTORE (${Os}) INTERNAL ASSERTION FAILED: `+t;throw Ni(e),new Error(e)}function ze(t,e){t||ge()}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class se extends Us{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class A2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ut.UNAUTHENTICATED))}shutdown(){}}class P2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class R2{constructor(e){this.t=e,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ze(this.o===void 0);let i=this.i;const r=d=>this.i!==i?(i=this.i,n(d)):Promise.resolve();let o=new Kr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Kr,e.enqueueRetryable(()=>r(this.currentUser))};const a=()=>{const d=o;e.enqueueRetryable(async()=>{await d.promise,await r(this.currentUser)})},u=d=>{ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(d=>u(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Kr)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==e?(ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ze(typeof i.accessToken=="string"),new pw(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ze(e===null||typeof e=="string"),new Ut(e)}}class N2{constructor(e,n,i){this.l=e,this.h=n,this.P=i,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class k2{constructor(e,n,i){this.l=e,this.h=n,this.P=i}getToken(){return Promise.resolve(new N2(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class M2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class L2{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){ze(this.o===void 0);const i=o=>{o.error!=null&&ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.R;return this.R=o.token,ae("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};const r=o=>{ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?r(o):ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ze(typeof n.token=="string"),this.R=n.token,new M2(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const r=D2(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<n&&(i+=e.charAt(r[o]%e.length))}return i}}function Ve(t,e){return t<e?-1:t>e?1:0}function Is(t,e,n){return t.length===e.length&&t.every((i,r)=>n(i,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new se(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new se(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new se(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new se(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Tt.fromMillis(Date.now())}static fromDate(e){return Tt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*n));return new Tt(n,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ye(e)}static min(){return new ye(new Tt(0,0))}static max(){return new ye(new Tt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e,n,i){n===void 0?n=0:n>e.length&&ge(),i===void 0?i=e.length-n:i>e.length-n&&ge(),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return xl.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof xl?e.forEach(i=>{n.push(i)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let r=0;r<i;r++){const o=e.get(r),a=n.get(r);if(o<a)return-1;if(o>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ze extends xl{construct(e,n,i){return new Ze(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new se(Y.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(r=>r.length>0))}return new Ze(n)}static emptyPath(){return new Ze([])}}const V2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Nt extends xl{construct(e,n,i){return new Nt(e,n,i)}static isValidIdentifier(e){return V2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Nt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Nt(["__name__"])}static fromServerFormat(e){const n=[];let i="",r=0;const o=()=>{if(i.length===0)throw new se(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let a=!1;for(;r<e.length;){const u=e[r];if(u==="\\"){if(r+1===e.length)throw new se(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[r+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new se(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=d,r+=2}else u==="`"?(a=!a,r++):u!=="."||a?(i+=u,r++):(o(),r++)}if(o(),a)throw new se(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Nt(n)}static emptyPath(){return new Nt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.path=e}static fromPath(e){return new ce(Ze.fromString(e))}static fromName(e){return new ce(Ze.fromString(e).popFirst(5))}static empty(){return new ce(Ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ze.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ce(new Ze(e.slice()))}}function b2(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=ye.fromTimestamp(i===1e9?new Tt(n+1,0):new Tt(n,i));return new pr(r,ce.empty(),e)}function F2(t){return new pr(t.readTime,t.key,-1)}class pr{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new pr(ye.min(),ce.empty(),-1)}static max(){return new pr(ye.max(),ce.empty(),-1)}}function U2(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ce.comparator(t.documentKey,e.documentKey),n!==0?n:Ve(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class B2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hl(t){if(t.code!==Y.FAILED_PRECONDITION||t.message!==O2)throw t;ae("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ge(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new X((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(n,o).next(i,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof X?n:X.resolve(n)}catch(n){return X.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):X.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):X.reject(n)}static resolve(e){return new X((n,i)=>{n(e)})}static reject(e){return new X((n,i)=>{i(e)})}static waitFor(e){return new X((n,i)=>{let r=0,o=0,a=!1;e.forEach(u=>{++r,u.next(()=>{++o,a&&o===r&&n()},d=>i(d))}),a=!0,o===r&&n()})}static or(e){let n=X.resolve(!1);for(const i of e)n=n.next(r=>r?X.resolve(r):i());return n}static forEach(e,n){const i=[];return e.forEach((r,o)=>{i.push(n.call(this,r,o))}),this.waitFor(i)}static mapArray(e,n){return new X((i,r)=>{const o=e.length,a=new Array(o);let u=0;for(let d=0;d<o;d++){const p=d;n(e[p]).next(g=>{a[p]=g,++u,u===o&&i(a)},g=>r(g))}})}static doWhile(e,n){return new X((i,r)=>{const o=()=>{e()===!0?n().next(()=>{o()},r):i()};o()})}}function z2(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Gl(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ie(i),this.se=i=>n.writeSequenceNumber(i))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}hm.oe=-1;function Pd(t){return t==null}function ed(t){return t===0&&1/t==-1/0}function q2(t){return typeof t=="number"&&Number.isInteger(t)&&!ed(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mv(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function so(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function gw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e,n){this.comparator=e,this.root=n||Rt.EMPTY}insert(e,n){return new ot(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Rt.BLACK,null,null))}remove(e){return new ot(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return n+i.left.size;r<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,i)=>(e(n,i),!1))}toString(){const e=[];return this.inorderTraversal((n,i)=>(e.push(`${n}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ju(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ju(this.root,e,this.comparator,!1)}getReverseIterator(){return new ju(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ju(this.root,e,this.comparator,!0)}}class ju{constructor(e,n,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?i(e.key,n):1,n&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rt{constructor(e,n,i,r,o){this.key=e,this.value=n,this.color=i??Rt.RED,this.left=r??Rt.EMPTY,this.right=o??Rt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,r,o){return new Rt(e??this.key,n??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let r=this;const o=i(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,n,i),null):o===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Rt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return Rt.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ge();const e=this.left.check();if(e!==this.right.check())throw ge();return e+(this.isRed()?0:1)}}Rt.EMPTY=null,Rt.RED=!0,Rt.BLACK=!1;Rt.EMPTY=new class{constructor(){this.size=0}get key(){throw ge()}get value(){throw ge()}get color(){throw ge()}get left(){throw ge()}get right(){throw ge()}copy(e,n,i,r,o){return this}insert(e,n,i){return new Rt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.comparator=e,this.data=new ot(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,i)=>(e(n),!1))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new gv(this.data.getIterator())}getIteratorFrom(e){return new gv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(i=>{n=n.add(i)}),n}isEqual(e){if(!(e instanceof Mt)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Mt(this.comparator);return n.data=e,n}}class gv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e){this.fields=e,e.sort(Nt.comparator)}static empty(){return new cn([])}unionWith(e){let n=new Mt(Nt.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new cn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Is(this.fields,e.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new _w("Invalid base64 string: "+o):o}}(e);return new Dt(n)}static fromUint8Array(e){const n=function(r){let o="";for(let a=0;a<r.length;++a)o+=String.fromCharCode(r[a]);return o}(e);return new Dt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Dt.EMPTY_BYTE_STRING=new Dt("");const H2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mr(t){if(ze(!!t),typeof t=="string"){let e=0;const n=H2.exec(t);if(ze(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ut(t.seconds),nanos:ut(t.nanos)}}function ut(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function to(t){return typeof t=="string"?Dt.fromBase64String(t):Dt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fm(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function pm(t){const e=t.mapValue.fields.__previous_value__;return fm(e)?pm(e):e}function Al(t){const e=mr(t.mapValue.fields.__local_write_time__.timestampValue);return new Tt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,n,i,r,o,a,u,d,p){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=d,this.useFetchStreams=p}}class Pl{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Pl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Pl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ec={mapValue:{}};function no(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fm(t)?4:$2(t)?9007199254740991:W2(t)?10:11:ge()}function si(t,e){if(t===e)return!0;const n=no(t);if(n!==no(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Al(t).isEqual(Al(e));case 3:return function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;const a=mr(r.timestampValue),u=mr(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,o){return to(r.bytesValue).isEqual(to(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,o){return ut(r.geoPointValue.latitude)===ut(o.geoPointValue.latitude)&&ut(r.geoPointValue.longitude)===ut(o.geoPointValue.longitude)}(t,e);case 2:return function(r,o){if("integerValue"in r&&"integerValue"in o)return ut(r.integerValue)===ut(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){const a=ut(r.doubleValue),u=ut(o.doubleValue);return a===u?ed(a)===ed(u):isNaN(a)&&isNaN(u)}return!1}(t,e);case 9:return Is(t.arrayValue.values||[],e.arrayValue.values||[],si);case 10:case 11:return function(r,o){const a=r.mapValue.fields||{},u=o.mapValue.fields||{};if(mv(a)!==mv(u))return!1;for(const d in a)if(a.hasOwnProperty(d)&&(u[d]===void 0||!si(a[d],u[d])))return!1;return!0}(t,e);default:return ge()}}function Rl(t,e){return(t.values||[]).find(n=>si(n,e))!==void 0}function Ss(t,e){if(t===e)return 0;const n=no(t),i=no(e);if(n!==i)return Ve(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ve(t.booleanValue,e.booleanValue);case 2:return function(o,a){const u=ut(o.integerValue||o.doubleValue),d=ut(a.integerValue||a.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1}(t,e);case 3:return _v(t.timestampValue,e.timestampValue);case 4:return _v(Al(t),Al(e));case 5:return Ve(t.stringValue,e.stringValue);case 6:return function(o,a){const u=to(o),d=to(a);return u.compareTo(d)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const u=o.split("/"),d=a.split("/");for(let p=0;p<u.length&&p<d.length;p++){const g=Ve(u[p],d[p]);if(g!==0)return g}return Ve(u.length,d.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const u=Ve(ut(o.latitude),ut(a.latitude));return u!==0?u:Ve(ut(o.longitude),ut(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return yv(t.arrayValue,e.arrayValue);case 10:return function(o,a){var u,d,p,g;const y=o.fields||{},T=a.fields||{},I=(u=y.value)===null||u===void 0?void 0:u.arrayValue,V=(d=T.value)===null||d===void 0?void 0:d.arrayValue,b=Ve(((p=I==null?void 0:I.values)===null||p===void 0?void 0:p.length)||0,((g=V==null?void 0:V.values)===null||g===void 0?void 0:g.length)||0);return b!==0?b:yv(I,V)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===ec.mapValue&&a===ec.mapValue)return 0;if(o===ec.mapValue)return 1;if(a===ec.mapValue)return-1;const u=o.fields||{},d=Object.keys(u),p=a.fields||{},g=Object.keys(p);d.sort(),g.sort();for(let y=0;y<d.length&&y<g.length;++y){const T=Ve(d[y],g[y]);if(T!==0)return T;const I=Ss(u[d[y]],p[g[y]]);if(I!==0)return I}return Ve(d.length,g.length)}(t.mapValue,e.mapValue);default:throw ge()}}function _v(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ve(t,e);const n=mr(t),i=mr(e),r=Ve(n.seconds,i.seconds);return r!==0?r:Ve(n.nanos,i.nanos)}function yv(t,e){const n=t.values||[],i=e.values||[];for(let r=0;r<n.length&&r<i.length;++r){const o=Ss(n[r],i[r]);if(o)return o}return Ve(n.length,i.length)}function xs(t){return Gf(t)}function Gf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const i=mr(n);return`time(${i.seconds},${i.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return to(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ce.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let i="[",r=!0;for(const o of n.values||[])r?r=!1:i+=",",i+=Gf(o);return i+"]"}(t.arrayValue):"mapValue"in t?function(n){const i=Object.keys(n.fields||{}).sort();let r="{",o=!0;for(const a of i)o?o=!1:r+=",",r+=`${a}:${Gf(n.fields[a])}`;return r+"}"}(t.mapValue):ge()}function vv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Wf(t){return!!t&&"integerValue"in t}function mm(t){return!!t&&"arrayValue"in t}function Tv(t){return!!t&&"nullValue"in t}function Ev(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function vc(t){return!!t&&"mapValue"in t}function W2(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function nl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return so(t.mapValue.fields,(n,i)=>e.mapValue.fields[n]=nl(i)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=nl(t.arrayValue.values[n]);return e}return Object.assign({},t)}function $2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.value=e}static empty(){return new Xt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!vc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=nl(n)}setAll(e){let n=Nt.emptyPath(),i={},r=[];e.forEach((a,u)=>{if(!n.isImmediateParentOf(u)){const d=this.getFieldsMap(n);this.applyChanges(d,i,r),i={},r=[],n=u.popLast()}a?i[u.lastSegment()]=nl(a):r.push(u.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,i,r)}delete(e){const n=this.field(e.popLast());vc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return si(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=n.mapValue.fields[e.get(i)];vc(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,i){so(n,(r,o)=>e[r]=o);for(const r of i)delete e[r]}clone(){return new Xt(nl(this.value))}}function yw(t){const e=[];return so(t.fields,(n,i)=>{const r=new Nt([n]);if(vc(i)){const o=yw(i.mapValue).fields;if(o.length===0)e.push(r);else for(const a of o)e.push(r.child(a))}else e.push(r)}),new cn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e,n,i,r,o,a,u){this.key=e,this.documentType=n,this.version=i,this.readTime=r,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new Bt(e,0,ye.min(),ye.min(),ye.min(),Xt.empty(),0)}static newFoundDocument(e,n,i,r){return new Bt(e,1,n,ye.min(),i,r,0)}static newNoDocument(e,n){return new Bt(e,2,n,ye.min(),ye.min(),Xt.empty(),0)}static newUnknownDocument(e,n){return new Bt(e,3,n,ye.min(),ye.min(),Xt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Bt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e,n){this.position=e,this.inclusive=n}}function wv(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const o=e[r],a=t.position[r];if(o.field.isKeyField()?i=ce.comparator(ce.fromName(a.referenceValue),n.key):i=Ss(a,n.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function Cv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!si(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,n="asc"){this.field=e,this.dir=n}}function K2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{}class gt extends vw{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new Z2(e,n,i):n==="array-contains"?new X2(e,i):n==="in"?new j2(e,i):n==="not-in"?new eD(e,i):n==="array-contains-any"?new tD(e,i):new gt(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new Y2(e,i):new Q2(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ss(n,this.value)):n!==null&&no(this.value)===no(n)&&this.matchesComparison(Ss(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ge()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Gn extends vw{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Gn(e,n)}matches(e){return Tw(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Tw(t){return t.op==="and"}function Ew(t){return J2(t)&&Tw(t)}function J2(t){for(const e of t.filters)if(e instanceof Gn)return!1;return!0}function $f(t){if(t instanceof gt)return t.field.canonicalString()+t.op.toString()+xs(t.value);if(Ew(t))return t.filters.map(e=>$f(e)).join(",");{const e=t.filters.map(n=>$f(n)).join(",");return`${t.op}(${e})`}}function ww(t,e){return t instanceof gt?function(i,r){return r instanceof gt&&i.op===r.op&&i.field.isEqual(r.field)&&si(i.value,r.value)}(t,e):t instanceof Gn?function(i,r){return r instanceof Gn&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((o,a,u)=>o&&ww(a,r.filters[u]),!0):!1}(t,e):void ge()}function Cw(t){return t instanceof gt?function(n){return`${n.field.canonicalString()} ${n.op} ${xs(n.value)}`}(t):t instanceof Gn?function(n){return n.op.toString()+" {"+n.getFilters().map(Cw).join(" ,")+"}"}(t):"Filter"}class Z2 extends gt{constructor(e,n,i){super(e,n,i),this.key=ce.fromName(i.referenceValue)}matches(e){const n=ce.comparator(e.key,this.key);return this.matchesComparison(n)}}class Y2 extends gt{constructor(e,n){super(e,"in",n),this.keys=Iw("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Q2 extends gt{constructor(e,n){super(e,"not-in",n),this.keys=Iw("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Iw(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(i=>ce.fromName(i.referenceValue))}class X2 extends gt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return mm(n)&&Rl(n.arrayValue,this.value)}}class j2 extends gt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Rl(this.value.arrayValue,n)}}class eD extends gt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Rl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Rl(this.value.arrayValue,n)}}class tD extends gt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!mm(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>Rl(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e,n=null,i=[],r=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=a,this.endAt=u,this.ue=null}}function Iv(t,e=null,n=[],i=[],r=null,o=null,a=null){return new nD(t,e,n,i,r,o,a)}function gm(t){const e=ve(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(i=>$f(i)).join(","),n+="|ob:",n+=e.orderBy.map(i=>function(o){return o.field.canonicalString()+o.dir}(i)).join(","),Pd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(i=>xs(i)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(i=>xs(i)).join(",")),e.ue=n}return e.ue}function _m(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!K2(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!ww(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Cv(t.startAt,e.startAt)&&Cv(t.endAt,e.endAt)}function Kf(t){return ce.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e,n=null,i=[],r=[],o=null,a="F",u=null,d=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=d,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function iD(t,e,n,i,r,o,a,u){return new Bs(t,e,n,i,r,o,a,u)}function ym(t){return new Bs(t)}function Sv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Sw(t){return t.collectionGroup!==null}function il(t){const e=ve(t);if(e.ce===null){e.ce=[];const n=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),n.add(o.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Mt(Nt.comparator);return a.filters.forEach(d=>{d.getFlattenedFilters().forEach(p=>{p.isInequality()&&(u=u.add(p.field))})}),u})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Nl(o,i))}),n.has(Nt.keyField().canonicalString())||e.ce.push(new Nl(Nt.keyField(),i))}return e.ce}function ni(t){const e=ve(t);return e.le||(e.le=rD(e,il(t))),e.le}function rD(t,e){if(t.limitType==="F")return Iv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const o=r.dir==="desc"?"asc":"desc";return new Nl(r.field,o)});const n=t.endAt?new td(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new td(t.startAt.position,t.startAt.inclusive):null;return Iv(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function Jf(t,e){const n=t.filters.concat([e]);return new Bs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function nd(t,e,n){return new Bs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Rd(t,e){return _m(ni(t),ni(e))&&t.limitType===e.limitType}function xw(t){return`${gm(ni(t))}|lt:${t.limitType}`}function qo(t){return`Query(target=${function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(r=>Cw(r)).join(", ")}]`),Pd(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(r=>xs(r)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(r=>xs(r)).join(",")),`Target(${i})`}(ni(t))}; limitType=${t.limitType})`}function Nd(t,e){return e.isFoundDocument()&&function(i,r){const o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):ce.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)}(t,e)&&function(i,r){for(const o of il(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0}(t,e)&&function(i,r){for(const o of i.filters)if(!o.matches(r))return!1;return!0}(t,e)&&function(i,r){return!(i.startAt&&!function(a,u,d){const p=wv(a,u,d);return a.inclusive?p<=0:p<0}(i.startAt,il(i),r)||i.endAt&&!function(a,u,d){const p=wv(a,u,d);return a.inclusive?p>=0:p>0}(i.endAt,il(i),r))}(t,e)}function oD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Aw(t){return(e,n)=>{let i=!1;for(const r of il(t)){const o=sD(r,e,n);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function sD(t,e,n){const i=t.field.isKeyField()?ce.comparator(e.key,n.key):function(o,a,u){const d=a.data.field(o),p=u.data.field(o);return d!==null&&p!==null?Ss(d,p):ge()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return ge()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[n]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){so(this.inner,(n,i)=>{for(const[r,o]of i)e(r,o)})}isEmpty(){return gw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD=new ot(ce.comparator);function ki(){return aD}const Pw=new ot(ce.comparator);function qa(...t){let e=Pw;for(const n of t)e=e.insert(n.key,n);return e}function Rw(t){let e=Pw;return t.forEach((n,i)=>e=e.insert(n,i.overlayedDocument)),e}function Hr(){return rl()}function Nw(){return rl()}function rl(){return new zs(t=>t.toString(),(t,e)=>t.isEqual(e))}const lD=new ot(ce.comparator),uD=new Mt(ce.comparator);function Re(...t){let e=uD;for(const n of t)e=e.add(n);return e}const cD=new Mt(Ve);function dD(){return cD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ed(e)?"-0":e}}function kw(t){return{integerValue:""+t}}function Mw(t,e){return q2(e)?kw(e):vm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(){this._=void 0}}function hD(t,e,n){return t instanceof kl?function(r,o){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&fm(o)&&(o=pm(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(n,e):t instanceof Ml?Dw(t,e):t instanceof Ll?Vw(t,e):function(r,o){const a=Lw(r,o),u=xv(a)+xv(r.Pe);return Wf(a)&&Wf(r.Pe)?kw(u):vm(r.serializer,u)}(t,e)}function fD(t,e,n){return t instanceof Ml?Dw(t,e):t instanceof Ll?Vw(t,e):n}function Lw(t,e){return t instanceof Dl?function(i){return Wf(i)||function(o){return!!o&&"doubleValue"in o}(i)}(e)?e:{integerValue:0}:null}class kl extends kd{}class Ml extends kd{constructor(e){super(),this.elements=e}}function Dw(t,e){const n=bw(e);for(const i of t.elements)n.some(r=>si(r,i))||n.push(i);return{arrayValue:{values:n}}}class Ll extends kd{constructor(e){super(),this.elements=e}}function Vw(t,e){let n=bw(e);for(const i of t.elements)n=n.filter(r=>!si(r,i));return{arrayValue:{values:n}}}class Dl extends kd{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function xv(t){return ut(t.integerValue||t.doubleValue)}function bw(t){return mm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(e,n){this.field=e,this.transform=n}}function pD(t,e){return t.field.isEqual(e.field)&&function(i,r){return i instanceof Ml&&r instanceof Ml||i instanceof Ll&&r instanceof Ll?Is(i.elements,r.elements,si):i instanceof Dl&&r instanceof Dl?si(i.Pe,r.Pe):i instanceof kl&&r instanceof kl}(t.transform,e.transform)}class mD{constructor(e,n){this.version=e,this.transformResults=n}}class ii{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ii}static exists(e){return new ii(void 0,e)}static updateTime(e){return new ii(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Tc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Md{}function Uw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Bw(t.key,ii.none()):new Wl(t.key,t.data,ii.none());{const n=t.data,i=Xt.empty();let r=new Mt(Nt.comparator);for(let o of e.fields)if(!r.has(o)){let a=n.field(o);a===null&&o.length>1&&(o=o.popLast(),a=n.field(o)),a===null?i.delete(o):i.set(o,a),r=r.add(o)}return new Er(t.key,i,new cn(r.toArray()),ii.none())}}function gD(t,e,n){t instanceof Wl?function(r,o,a){const u=r.value.clone(),d=Pv(r.fieldTransforms,o,a.transformResults);u.setAll(d),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):t instanceof Er?function(r,o,a){if(!Tc(r.precondition,o))return void o.convertToUnknownDocument(a.version);const u=Pv(r.fieldTransforms,o,a.transformResults),d=o.data;d.setAll(Ow(r)),d.setAll(u),o.convertToFoundDocument(a.version,d).setHasCommittedMutations()}(t,e,n):function(r,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function ol(t,e,n,i){return t instanceof Wl?function(o,a,u,d){if(!Tc(o.precondition,a))return u;const p=o.value.clone(),g=Rv(o.fieldTransforms,d,a);return p.setAll(g),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),null}(t,e,n,i):t instanceof Er?function(o,a,u,d){if(!Tc(o.precondition,a))return u;const p=Rv(o.fieldTransforms,d,a),g=a.data;return g.setAll(Ow(o)),g.setAll(p),a.convertToFoundDocument(a.version,g).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))}(t,e,n,i):function(o,a,u){return Tc(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(t,e,n)}function _D(t,e){let n=null;for(const i of t.fieldTransforms){const r=e.data.field(i.field),o=Lw(i.transform,r||null);o!=null&&(n===null&&(n=Xt.empty()),n.set(i.field,o))}return n||null}function Av(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Is(i,r,(o,a)=>pD(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Wl extends Md{constructor(e,n,i,r=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Er extends Md{constructor(e,n,i,r,o=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Ow(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}}),e}function Pv(t,e,n){const i=new Map;ze(t.length===n.length);for(let r=0;r<n.length;r++){const o=t[r],a=o.transform,u=e.data.field(o.field);i.set(o.field,fD(a,u,n[r]))}return i}function Rv(t,e,n){const i=new Map;for(const r of t){const o=r.transform,a=n.data.field(r.field);i.set(r.field,hD(o,a,e))}return i}class Bw extends Md{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yD extends Md{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(e,n,i,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const o=this.mutations[r];o.key.isEqual(e.key)&&gD(o,e,i[r])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=ol(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=ol(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=Nw();return this.mutations.forEach(r=>{const o=e.get(r.key),a=o.overlayedDocument;let u=this.applyToLocalView(a,o.mutatedFields);u=n.has(r.key)?null:u;const d=Uw(a,u);d!==null&&i.set(r.key,d),a.isValidDocument()||a.convertToNoDocument(ye.min())}),i}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Re())}isEqual(e){return this.batchId===e.batchId&&Is(this.mutations,e.mutations,(n,i)=>Av(n,i))&&Is(this.baseMutations,e.baseMutations,(n,i)=>Av(n,i))}}class Tm{constructor(e,n,i,r){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=r}static from(e,n,i){ze(e.mutations.length===i.length);let r=function(){return lD}();const o=e.mutations;for(let a=0;a<o.length;a++)r=r.insert(o[a].key,i[a].version);return new Tm(e,n,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pt,ke;function wD(t){switch(t){default:return ge();case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0}}function zw(t){if(t===void 0)return Ni("GRPC error has no .code"),Y.UNKNOWN;switch(t){case pt.OK:return Y.OK;case pt.CANCELLED:return Y.CANCELLED;case pt.UNKNOWN:return Y.UNKNOWN;case pt.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case pt.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case pt.INTERNAL:return Y.INTERNAL;case pt.UNAVAILABLE:return Y.UNAVAILABLE;case pt.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case pt.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case pt.NOT_FOUND:return Y.NOT_FOUND;case pt.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case pt.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case pt.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case pt.ABORTED:return Y.ABORTED;case pt.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case pt.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case pt.DATA_LOSS:return Y.DATA_LOSS;default:return ge()}}(ke=pt||(pt={}))[ke.OK=0]="OK",ke[ke.CANCELLED=1]="CANCELLED",ke[ke.UNKNOWN=2]="UNKNOWN",ke[ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ke[ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ke[ke.NOT_FOUND=5]="NOT_FOUND",ke[ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",ke[ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",ke[ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",ke[ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ke[ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ke[ke.ABORTED=10]="ABORTED",ke[ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",ke[ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",ke[ke.INTERNAL=13]="INTERNAL",ke[ke.UNAVAILABLE=14]="UNAVAILABLE",ke[ke.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ID=new $r([4294967295,4294967295],0);function Nv(t){const e=CD().encode(t),n=new lw;return n.update(e),new Uint8Array(n.digest())}function kv(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new $r([n,i],0),new $r([r,o],0)]}class Em{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Ha(`Invalid padding: ${n}`);if(i<0)throw new Ha(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Ha(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Ha(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=$r.fromNumber(this.Ie)}Ee(e,n,i){let r=e.add(n.multiply($r.fromNumber(i)));return r.compare(ID)===1&&(r=new $r([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Nv(e),[i,r]=kv(n);for(let o=0;o<this.hashCount;o++){const a=this.Ee(i,r,o);if(!this.de(a))return!1}return!0}static create(e,n,i){const r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new Em(o,r,n);return i.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;const n=Nv(e),[i,r]=kv(n);for(let o=0;o<this.hashCount;o++){const a=this.Ee(i,r,o);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Ha extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e,n,i,r,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const r=new Map;return r.set(e,$l.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new Ld(ye.min(),r,new ot(Ve),ki(),Re())}}class $l{constructor(e,n,i,r,o){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new $l(i,n,Re(),Re(),Re())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(e,n,i,r){this.Re=e,this.removedTargetIds=n,this.key=i,this.Ve=r}}class qw{constructor(e,n){this.targetId=e,this.me=n}}class Hw{constructor(e,n,i=Dt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=r}}class Mv{constructor(){this.fe=0,this.ge=Dv(),this.pe=Dt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Re(),n=Re(),i=Re();return this.ge.forEach((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:i=i.add(r);break;default:ge()}}),new $l(this.pe,this.ye,e,n,i)}Ce(){this.we=!1,this.ge=Dv()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ze(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class SD{constructor(e){this.Le=e,this.Be=new Map,this.ke=ki(),this.qe=Lv(),this.Qe=new ot(Ve)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const i=this.Ge(n);switch(e.state){case 0:this.ze(n)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),i.De(e.resumeToken));break;default:ge()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((i,r)=>{this.ze(r)&&n(r)})}He(e){const n=e.targetId,i=e.me.count,r=this.Je(n);if(r){const o=r.target;if(Kf(o))if(i===0){const a=new ce(o.path);this.Ue(n,a,Bt.newNoDocument(a,ye.min()))}else ze(i===1);else{const a=this.Ye(n);if(a!==i){const u=this.Ze(e),d=u?this.Xe(u,e,a):1;if(d!==0){this.je(n);const p=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,p)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=n;let a,u;try{a=to(i).toUint8Array()}catch(d){if(d instanceof _w)return Cs("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{u=new Em(a,r,o)}catch(d){return Cs(d instanceof Ha?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return u.Ie===0?null:u}Xe(e,n,i){return n.me.count===i-this.nt(e,n.targetId)?0:2}nt(e,n){const i=this.Le.getRemoteKeysForTarget(n);let r=0;return i.forEach(o=>{const a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(n,o,null),r++)}),r}rt(e){const n=new Map;this.Be.forEach((o,a)=>{const u=this.Je(a);if(u){if(o.current&&Kf(u.target)){const d=new ce(u.target.path);this.ke.get(d)!==null||this.it(a,d)||this.Ue(a,d,Bt.newNoDocument(d,e))}o.be&&(n.set(a,o.ve()),o.Ce())}});let i=Re();this.qe.forEach((o,a)=>{let u=!0;a.forEachWhile(d=>{const p=this.Je(d);return!p||p.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(i=i.add(o))}),this.ke.forEach((o,a)=>a.setReadTime(e));const r=new Ld(e,n,this.Qe,this.ke,i);return this.ke=ki(),this.qe=Lv(),this.Qe=new ot(Ve),r}$e(e,n){if(!this.ze(e))return;const i=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,i),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,i){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,n)?r.Fe(n,1):r.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),i&&(this.ke=this.ke.insert(n,i))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Mv,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Mt(Ve),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ae("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Mv),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Lv(){return new ot(ce.comparator)}function Dv(){return new ot(ce.comparator)}const xD={asc:"ASCENDING",desc:"DESCENDING"},AD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},PD={and:"AND",or:"OR"};class RD{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Zf(t,e){return t.useProto3Json||Pd(e)?e:{value:e}}function id(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Gw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function ND(t,e){return id(t,e.toTimestamp())}function ri(t){return ze(!!t),ye.fromTimestamp(function(n){const i=mr(n);return new Tt(i.seconds,i.nanos)}(t))}function wm(t,e){return Yf(t,e).canonicalString()}function Yf(t,e){const n=function(r){return new Ze(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Ww(t){const e=Ze.fromString(t);return ze(Yw(e)),e}function Qf(t,e){return wm(t.databaseId,e.path)}function Rh(t,e){const n=Ww(e);if(n.get(1)!==t.databaseId.projectId)throw new se(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new se(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ce(Kw(n))}function $w(t,e){return wm(t.databaseId,e)}function kD(t){const e=Ww(t);return e.length===4?Ze.emptyPath():Kw(e)}function Xf(t){return new Ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Kw(t){return ze(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Vv(t,e,n){return{name:Qf(t,e),fields:n.value.mapValue.fields}}function MD(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:ge()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=function(p,g){return p.useProto3Json?(ze(g===void 0||typeof g=="string"),Dt.fromBase64String(g||"")):(ze(g===void 0||g instanceof Buffer||g instanceof Uint8Array),Dt.fromUint8Array(g||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(p){const g=p.code===void 0?Y.UNKNOWN:zw(p.code);return new se(g,p.message||"")}(a);n=new Hw(i,r,o,u||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Rh(t,i.document.name),o=ri(i.document.updateTime),a=i.document.createTime?ri(i.document.createTime):ye.min(),u=new Xt({mapValue:{fields:i.document.fields}}),d=Bt.newFoundDocument(r,o,a,u),p=i.targetIds||[],g=i.removedTargetIds||[];n=new Ec(p,g,d.key,d)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Rh(t,i.document),o=i.readTime?ri(i.readTime):ye.min(),a=Bt.newNoDocument(r,o),u=i.removedTargetIds||[];n=new Ec([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Rh(t,i.document),o=i.removedTargetIds||[];n=new Ec([],o,r,null)}else{if(!("filter"in e))return ge();{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:o}=i,a=new ED(r,o),u=i.targetId;n=new qw(u,a)}}return n}function LD(t,e){let n;if(e instanceof Wl)n={update:Vv(t,e.key,e.value)};else if(e instanceof Bw)n={delete:Qf(t,e.key)};else if(e instanceof Er)n={update:Vv(t,e.key,e.data),updateMask:qD(e.fieldMask)};else{if(!(e instanceof yD))return ge();n={verify:Qf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(i=>function(o,a){const u=a.transform;if(u instanceof kl)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Ml)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Ll)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Dl)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw ge()}(0,i))),e.precondition.isNone||(n.currentDocument=function(r,o){return o.updateTime!==void 0?{updateTime:ND(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ge()}(t,e.precondition)),n}function DD(t,e){return t&&t.length>0?(ze(e!==void 0),t.map(n=>function(r,o){let a=r.updateTime?ri(r.updateTime):ri(o);return a.isEqual(ye.min())&&(a=ri(o)),new mD(a,r.transformResults||[])}(n,e))):[]}function VD(t,e){return{documents:[$w(t,e.path)]}}function bD(t,e){const n={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=$w(t,r);const o=function(p){if(p.length!==0)return Zw(Gn.create(p,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const a=function(p){if(p.length!==0)return p.map(g=>function(T){return{field:Ho(T.field),direction:OD(T.dir)}}(g))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const u=Zf(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(e.endAt)),{_t:n,parent:r}}function FD(t){let e=kD(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){ze(i===1);const g=n.from[0];g.allDescendants?r=g.collectionId:e=e.child(g.collectionId)}let o=[];n.where&&(o=function(y){const T=Jw(y);return T instanceof Gn&&Ew(T)?T.getFilters():[T]}(n.where));let a=[];n.orderBy&&(a=function(y){return y.map(T=>function(V){return new Nl(Go(V.field),function(q){switch(q){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(V.direction))}(T))}(n.orderBy));let u=null;n.limit&&(u=function(y){let T;return T=typeof y=="object"?y.value:y,Pd(T)?null:T}(n.limit));let d=null;n.startAt&&(d=function(y){const T=!!y.before,I=y.values||[];return new td(I,T)}(n.startAt));let p=null;return n.endAt&&(p=function(y){const T=!y.before,I=y.values||[];return new td(I,T)}(n.endAt)),iD(e,r,a,o,u,"F",d,p)}function UD(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ge()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Jw(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Go(n.unaryFilter.field);return gt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Go(n.unaryFilter.field);return gt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Go(n.unaryFilter.field);return gt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Go(n.unaryFilter.field);return gt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ge()}}(t):t.fieldFilter!==void 0?function(n){return gt.create(Go(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ge()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Gn.create(n.compositeFilter.filters.map(i=>Jw(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ge()}}(n.compositeFilter.op))}(t):ge()}function OD(t){return xD[t]}function BD(t){return AD[t]}function zD(t){return PD[t]}function Ho(t){return{fieldPath:t.canonicalString()}}function Go(t){return Nt.fromServerFormat(t.fieldPath)}function Zw(t){return t instanceof gt?function(n){if(n.op==="=="){if(Ev(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NAN"}};if(Tv(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Ev(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NOT_NAN"}};if(Tv(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ho(n.field),op:BD(n.op),value:n.value}}}(t):t instanceof Gn?function(n){const i=n.getFilters().map(r=>Zw(r));return i.length===1?i[0]:{compositeFilter:{op:zD(n.op),filters:i}}}(t):ge()}function qD(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Yw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e,n,i,r,o=ye.min(),a=ye.min(),u=Dt.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=d}withSequenceNumber(e){return new er(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new er(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e){this.ct=e}}function GD(t){const e=FD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?nd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(){this.un=new $D}addToCollectionParentIndex(e,n){return this.un.add(n),X.resolve()}getCollectionParents(e,n){return X.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return X.resolve()}deleteFieldIndex(e,n){return X.resolve()}deleteAllFieldIndexes(e){return X.resolve()}createTargetIndexes(e,n){return X.resolve()}getDocumentsMatchingTarget(e,n){return X.resolve(null)}getIndexType(e,n){return X.resolve(0)}getFieldIndexes(e,n){return X.resolve([])}getNextCollectionGroupToUpdate(e){return X.resolve(null)}getMinOffset(e,n){return X.resolve(pr.min())}getMinOffsetFromCollectionGroup(e,n){return X.resolve(pr.min())}updateCollectionGroup(e,n,i){return X.resolve()}updateIndexEntries(e,n){return X.resolve()}}class $D{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),r=this.index[n]||new Mt(Ze.comparator),o=!r.has(i);return this.index[n]=r.add(i),o}has(e){const n=e.lastSegment(),i=e.popLast(),r=this.index[n];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Mt(Ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new As(0)}static kn(){return new As(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(){this.changes=new zs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Bt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?X.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e,n,i,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(i!==null&&ol(i.mutation,r,cn.empty(),Tt.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(i=>this.getLocalViewOfDocuments(e,i,Re()).next(()=>i))}getLocalViewOfDocuments(e,n,i=Re()){const r=Hr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,i).next(o=>{let a=qa();return o.forEach((u,d)=>{a=a.insert(u,d.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const i=Hr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,Re()))}populateOverlays(e,n,i){const r=[];return i.forEach(o=>{n.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(e,r).next(o=>{o.forEach((a,u)=>{n.set(a,u)})})}computeViews(e,n,i,r){let o=ki();const a=rl(),u=function(){return rl()}();return n.forEach((d,p)=>{const g=i.get(p.key);r.has(p.key)&&(g===void 0||g.mutation instanceof Er)?o=o.insert(p.key,p):g!==void 0?(a.set(p.key,g.mutation.getFieldMask()),ol(g.mutation,p,g.mutation.getFieldMask(),Tt.now())):a.set(p.key,cn.empty())}),this.recalculateAndSaveOverlays(e,o).next(d=>(d.forEach((p,g)=>a.set(p,g)),n.forEach((p,g)=>{var y;return u.set(p,new JD(g,(y=a.get(p))!==null&&y!==void 0?y:null))}),u))}recalculateAndSaveOverlays(e,n){const i=rl();let r=new ot((a,u)=>a-u),o=Re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const u of a)u.keys().forEach(d=>{const p=n.get(d);if(p===null)return;let g=i.get(d)||cn.empty();g=u.applyToLocalView(p,g),i.set(d,g);const y=(r.get(u.batchId)||Re()).add(d);r=r.insert(u.batchId,y)})}).next(()=>{const a=[],u=r.getReverseIterator();for(;u.hasNext();){const d=u.getNext(),p=d.key,g=d.value,y=Nw();g.forEach(T=>{if(!o.has(T)){const I=Uw(n.get(T),i.get(T));I!==null&&y.set(T,I),o=o.add(T)}}),a.push(this.documentOverlayCache.saveOverlays(e,p,y))}return X.waitFor(a)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,n,i,r){return function(a){return ce.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Sw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,r):this.getDocumentsMatchingCollectionQuery(e,n,i,r)}getNextDocuments(e,n,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,r).next(o=>{const a=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,r-o.size):X.resolve(Hr());let u=-1,d=o;return a.next(p=>X.forEach(p,(g,y)=>(u<y.largestBatchId&&(u=y.largestBatchId),o.get(g)?X.resolve():this.remoteDocumentCache.getEntry(e,g).next(T=>{d=d.insert(g,T)}))).next(()=>this.populateOverlays(e,p,o)).next(()=>this.computeViews(e,d,p,Re())).next(g=>({batchId:u,changes:Rw(g)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ce(n)).next(i=>{let r=qa();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,i,r){const o=n.collectionGroup;let a=qa();return this.indexManager.getCollectionParents(e,o).next(u=>X.forEach(u,d=>{const p=function(y,T){return new Bs(T,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(n,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,i,r).next(g=>{g.forEach((y,T)=>{a=a.insert(y,T)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,o,r))).next(a=>{o.forEach((d,p)=>{const g=p.getKey();a.get(g)===null&&(a=a.insert(g,Bt.newInvalidDocument(g)))});let u=qa();return a.forEach((d,p)=>{const g=o.get(d);g!==void 0&&ol(g.mutation,p,cn.empty(),Tt.now()),Nd(n,p)&&(u=u.insert(d,p))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return X.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:ri(r.createTime)}}(n)),X.resolve()}getNamedQuery(e,n){return X.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(r){return{name:r.name,query:GD(r.bundledQuery),readTime:ri(r.readTime)}}(n)),X.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(){this.overlays=new ot(ce.comparator),this.Ir=new Map}getOverlay(e,n){return X.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Hr();return X.forEach(n,r=>this.getOverlay(e,r).next(o=>{o!==null&&i.set(r,o)})).next(()=>i)}saveOverlays(e,n,i){return i.forEach((r,o)=>{this.ht(e,n,o)}),X.resolve()}removeOverlaysForBatchId(e,n,i){const r=this.Ir.get(i);return r!==void 0&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(i)),X.resolve()}getOverlaysForCollection(e,n,i){const r=Hr(),o=n.length+1,a=new ce(n.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const d=u.getNext().value,p=d.getKey();if(!n.isPrefixOf(p.path))break;p.path.length===o&&d.largestBatchId>i&&r.set(d.getKey(),d)}return X.resolve(r)}getOverlaysForCollectionGroup(e,n,i,r){let o=new ot((p,g)=>p-g);const a=this.overlays.getIterator();for(;a.hasNext();){const p=a.getNext().value;if(p.getKey().getCollectionGroup()===n&&p.largestBatchId>i){let g=o.get(p.largestBatchId);g===null&&(g=Hr(),o=o.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const u=Hr(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((p,g)=>u.set(p,g)),!(u.size()>=r)););return X.resolve(u)}ht(e,n,i){const r=this.overlays.get(i.key);if(r!==null){const a=this.Ir.get(r.largestBatchId).delete(i.key);this.Ir.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(i.key,new TD(n,i));let o=this.Ir.get(n);o===void 0&&(o=Re(),this.Ir.set(n,o)),this.Ir.set(n,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(){this.sessionToken=Dt.EMPTY_BYTE_STRING}getSessionToken(e){return X.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,X.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(){this.Tr=new Mt(It.Er),this.dr=new Mt(It.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const i=new It(e,n);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,n){e.forEach(i=>this.addReference(i,n))}removeReference(e,n){this.Vr(new It(e,n))}mr(e,n){e.forEach(i=>this.removeReference(i,n))}gr(e){const n=new ce(new Ze([])),i=new It(n,e),r=new It(n,e+1),o=[];return this.dr.forEachInRange([i,r],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ce(new Ze([])),i=new It(n,e),r=new It(n,e+1);let o=Re();return this.dr.forEachInRange([i,r],a=>{o=o.add(a.key)}),o}containsKey(e){const n=new It(e,0),i=this.Tr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class It{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ce.comparator(e.key,n.key)||Ve(e.wr,n.wr)}static Ar(e,n){return Ve(e.wr,n.wr)||ce.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Mt(It.Er)}checkEmpty(e){return X.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,r){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new vD(o,n,i,r);this.mutationQueue.push(a);for(const u of r)this.br=this.br.add(new It(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return X.resolve(a)}lookupMutationBatch(e,n){return X.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,r=this.vr(i),o=r<0?0:r;return X.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return X.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return X.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new It(n,0),r=new It(n,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([i,r],a=>{const u=this.Dr(a.wr);o.push(u)}),X.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new Mt(Ve);return n.forEach(r=>{const o=new It(r,0),a=new It(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],u=>{i=i.add(u.wr)})}),X.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,r=i.length+1;let o=i;ce.isDocumentKey(o)||(o=o.child(""));const a=new It(new ce(o),0);let u=new Mt(Ve);return this.br.forEachWhile(d=>{const p=d.key.path;return!!i.isPrefixOf(p)&&(p.length===r&&(u=u.add(d.wr)),!0)},a),X.resolve(this.Cr(u))}Cr(e){const n=[];return e.forEach(i=>{const r=this.Dr(i);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){ze(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return X.forEach(n.mutations,r=>{const o=new It(r.key,n.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=i})}On(e){}containsKey(e,n){const i=new It(n,0),r=this.br.firstAfterOrEqual(i);return X.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,X.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(e){this.Mr=e,this.docs=function(){return new ot(ce.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,r=this.docs.get(i),o=r?r.size:0,a=this.Mr(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return X.resolve(i?i.document.mutableCopy():Bt.newInvalidDocument(n))}getEntries(e,n){let i=ki();return n.forEach(r=>{const o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():Bt.newInvalidDocument(r))}),X.resolve(i)}getDocumentsMatchingQuery(e,n,i,r){let o=ki();const a=n.path,u=new ce(a.child("")),d=this.docs.getIteratorFrom(u);for(;d.hasNext();){const{key:p,value:{document:g}}=d.getNext();if(!a.isPrefixOf(p.path))break;p.path.length>a.length+1||U2(F2(g),i)<=0||(r.has(g.key)||Nd(n,g))&&(o=o.insert(g.key,g.mutableCopy()))}return X.resolve(o)}getAllFromCollectionGroup(e,n,i,r){ge()}Or(e,n){return X.forEach(this.docs,i=>n(i))}newChangeBuffer(e){return new tV(this)}getSize(e){return X.resolve(this.size)}}class tV extends KD{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?n.push(this.cr.addEntry(e,r)):this.cr.removeEntry(i)}),X.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e){this.persistence=e,this.Nr=new zs(n=>gm(n),_m),this.lastRemoteSnapshotVersion=ye.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Cm,this.targetCount=0,this.kr=As.Bn()}forEachTarget(e,n){return this.Nr.forEach((i,r)=>n(r)),X.resolve()}getLastRemoteSnapshotVersion(e){return X.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return X.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),X.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.Lr&&(this.Lr=n),X.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new As(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,X.resolve()}updateTargetData(e,n){return this.Kn(n),X.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,X.resolve()}removeTargets(e,n,i){let r=0;const o=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=n&&i.get(u.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),r++)}),X.waitFor(o).next(()=>r)}getTargetCount(e){return X.resolve(this.targetCount)}getTargetData(e,n){const i=this.Nr.get(n)||null;return X.resolve(i)}addMatchingKeys(e,n,i){return this.Br.Rr(n,i),X.resolve()}removeMatchingKeys(e,n,i){this.Br.mr(n,i);const r=this.persistence.referenceDelegate,o=[];return r&&n.forEach(a=>{o.push(r.markPotentiallyOrphaned(e,a))}),X.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),X.resolve()}getMatchingKeysForTargetId(e,n){const i=this.Br.yr(n);return X.resolve(i)}containsKey(e,n){return X.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e,n){this.qr={},this.overlays={},this.Qr=new hm(0),this.Kr=!1,this.Kr=!0,this.$r=new XD,this.referenceDelegate=e(this),this.Ur=new nV(this),this.indexManager=new WD,this.remoteDocumentCache=function(r){return new eV(r)}(i=>this.referenceDelegate.Wr(i)),this.serializer=new HD(n),this.Gr=new YD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new QD,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.qr[e.toKey()];return i||(i=new jD(n,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,i){ae("MemoryPersistence","Starting transaction:",e);const r=new rV(this.Qr.next());return this.referenceDelegate.zr(),i(r).next(o=>this.referenceDelegate.jr(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}Hr(e,n){return X.or(Object.values(this.qr).map(i=>()=>i.containsKey(e,n)))}}class rV extends B2{constructor(e){super(),this.currentSequenceNumber=e}}class Im{constructor(e){this.persistence=e,this.Jr=new Cm,this.Yr=null}static Zr(e){return new Im(e)}get Xr(){if(this.Yr)return this.Yr;throw ge()}addReference(e,n,i){return this.Jr.addReference(i,n),this.Xr.delete(i.toString()),X.resolve()}removeReference(e,n,i){return this.Jr.removeReference(i,n),this.Xr.add(i.toString()),X.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),X.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(r=>this.Xr.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(o=>this.Xr.add(o.toString()))}).next(()=>i.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return X.forEach(this.Xr,i=>{const r=ce.fromPath(i);return this.ei(e,r).next(o=>{o||n.removeEntry(r,ye.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(i=>{i?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return X.or([()=>X.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e,n,i,r){this.targetId=e,this.fromCache=n,this.$i=i,this.Ui=r}static Wi(e,n){let i=Re(),r=Re();for(const o of n.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new Sm(e,n.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return uL()?8:z2(aL())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,i,r){const o={result:null};return this.Yi(e,n).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,n,r,i).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new oV;return this.Xi(e,n,a).next(u=>{if(o.result=u,this.zi)return this.es(e,n,a,u.size)})}).next(()=>o.result)}es(e,n,i,r){return i.documentReadCount<this.ji?(Da()<=Me.DEBUG&&ae("QueryEngine","SDK will not create cache indexes for query:",qo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),X.resolve()):(Da()<=Me.DEBUG&&ae("QueryEngine","Query:",qo(n),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Hi*r?(Da()<=Me.DEBUG&&ae("QueryEngine","The SDK decides to create cache indexes for query:",qo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ni(n))):X.resolve())}Yi(e,n){if(Sv(n))return X.resolve(null);let i=ni(n);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=nd(n,null,"F"),i=ni(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{const a=Re(...o);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,i).next(d=>{const p=this.ts(n,u);return this.ns(n,p,a,d.readTime)?this.Yi(e,nd(n,null,"F")):this.rs(e,p,n,d)}))})))}Zi(e,n,i,r){return Sv(n)||r.isEqual(ye.min())?X.resolve(null):this.Ji.getDocuments(e,i).next(o=>{const a=this.ts(n,o);return this.ns(n,a,i,r)?X.resolve(null):(Da()<=Me.DEBUG&&ae("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),qo(n)),this.rs(e,a,n,b2(r,-1)).next(u=>u))})}ts(e,n){let i=new Mt(Aw(e));return n.forEach((r,o)=>{Nd(e,o)&&(i=i.add(o))}),i}ns(e,n,i,r){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}Xi(e,n,i){return Da()<=Me.DEBUG&&ae("QueryEngine","Using full collection scan to execute query:",qo(n)),this.Ji.getDocumentsMatchingQuery(e,n,pr.min(),i)}rs(e,n,i,r){return this.Ji.getDocumentsMatchingQuery(e,i,r).next(o=>(n.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e,n,i,r){this.persistence=e,this.ss=n,this.serializer=r,this.os=new ot(Ve),this._s=new zs(o=>gm(o),_m),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZD(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function lV(t,e,n,i){return new aV(t,e,n,i)}async function Qw(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let r;return n.mutationQueue.getAllMutationBatches(i).next(o=>(r=o,n.ls(e),n.mutationQueue.getAllMutationBatches(i))).next(o=>{const a=[],u=[];let d=Re();for(const p of r){a.push(p.batchId);for(const g of p.mutations)d=d.add(g.key)}for(const p of o){u.push(p.batchId);for(const g of p.mutations)d=d.add(g.key)}return n.localDocuments.getDocuments(i,d).next(p=>({hs:p,removedBatchIds:a,addedBatchIds:u}))})})}function uV(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),o=n.cs.newChangeBuffer({trackRemovals:!0});return function(u,d,p,g){const y=p.batch,T=y.keys();let I=X.resolve();return T.forEach(V=>{I=I.next(()=>g.getEntry(d,V)).next(b=>{const q=p.docVersions.get(V);ze(q!==null),b.version.compareTo(q)<0&&(y.applyToRemoteDocument(b,p),b.isValidDocument()&&(b.setReadTime(p.commitVersion),g.addEntry(b)))})}),I.next(()=>u.mutationQueue.removeMutationBatch(d,y))}(n,i,e,o).next(()=>o.apply(i)).next(()=>n.mutationQueue.performConsistencyCheck(i)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(u){let d=Re();for(let p=0;p<u.mutationResults.length;++p)u.mutationResults[p].transformResults.length>0&&(d=d.add(u.batch.mutations[p].key));return d}(e))).next(()=>n.localDocuments.getDocuments(i,r))})}function Xw(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function cV(t,e){const n=ve(t),i=e.snapshotVersion;let r=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});r=n.os;const u=[];e.targetChanges.forEach((g,y)=>{const T=r.get(y);if(!T)return;u.push(n.Ur.removeMatchingKeys(o,g.removedDocuments,y).next(()=>n.Ur.addMatchingKeys(o,g.addedDocuments,y)));let I=T.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?I=I.withResumeToken(Dt.EMPTY_BYTE_STRING,ye.min()).withLastLimboFreeSnapshotVersion(ye.min()):g.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(g.resumeToken,i)),r=r.insert(y,I),function(b,q,A){return b.resumeToken.approximateByteSize()===0||q.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(T,I,g)&&u.push(n.Ur.updateTargetData(o,I))});let d=ki(),p=Re();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(o,g))}),u.push(dV(o,a,e.documentUpdates).next(g=>{d=g.Ps,p=g.Is})),!i.isEqual(ye.min())){const g=n.Ur.getLastRemoteSnapshotVersion(o).next(y=>n.Ur.setTargetsMetadata(o,o.currentSequenceNumber,i));u.push(g)}return X.waitFor(u).next(()=>a.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,d,p)).next(()=>d)}).then(o=>(n.os=r,o))}function dV(t,e,n){let i=Re(),r=Re();return n.forEach(o=>i=i.add(o)),e.getEntries(t,i).next(o=>{let a=ki();return n.forEach((u,d)=>{const p=o.get(u);d.isFoundDocument()!==p.isFoundDocument()&&(r=r.add(u)),d.isNoDocument()&&d.version.isEqual(ye.min())?(e.removeEntry(u,d.readTime),a=a.insert(u,d)):!p.isValidDocument()||d.version.compareTo(p.version)>0||d.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(d),a=a.insert(u,d)):ae("LocalStore","Ignoring outdated watch update for ",u,". Current version:",p.version," Watch version:",d.version)}),{Ps:a,Is:r}})}function hV(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function fV(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return n.Ur.getTargetData(i,e).next(o=>o?(r=o,X.resolve(r)):n.Ur.allocateTargetId(i).next(a=>(r=new er(e,a,"TargetPurposeListen",i.currentSequenceNumber),n.Ur.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=n.os.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(i.targetId,i),n._s.set(e,i.targetId)),i})}async function jf(t,e,n){const i=ve(t),r=i.os.get(e),o=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",o,a=>i.persistence.referenceDelegate.removeTarget(a,r))}catch(a){if(!Gl(a))throw a;ae("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}i.os=i.os.remove(e),i._s.delete(r.target)}function bv(t,e,n){const i=ve(t);let r=ye.min(),o=Re();return i.persistence.runTransaction("Execute query","readwrite",a=>function(d,p,g){const y=ve(d),T=y._s.get(g);return T!==void 0?X.resolve(y.os.get(T)):y.Ur.getTargetData(p,g)}(i,a,ni(e)).next(u=>{if(u)return r=u.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(a,u.targetId).next(d=>{o=d})}).next(()=>i.ss.getDocumentsMatchingQuery(a,e,n?r:ye.min(),n?o:Re())).next(u=>(pV(i,oD(e),u),{documents:u,Ts:o})))}function pV(t,e,n){let i=t.us.get(e)||ye.min();n.forEach((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),t.us.set(e,i)}class Fv{constructor(){this.activeTargetIds=dD()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class mV{constructor(){this.so=new Fv,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,i){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Fv,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gV{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ae("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ae("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tc=null;function Nh(){return tc===null?tc=function(){return 268435456+Math.round(2147483648*Math.random())}():tc++,"0x"+tc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _V={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ft="WebChannelConnection";class vV extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const i=n.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+n.host,this.vo=`projects/${r}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${o}`}get Fo(){return!1}Mo(n,i,r,o,a){const u=Nh(),d=this.xo(n,i.toUriEncodedString());ae("RestConnection",`Sending RPC '${n}' ${u}:`,d,r);const p={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(p,o,a),this.No(n,d,p,r).then(g=>(ae("RestConnection",`Received RPC '${n}' ${u}: `,g),g),g=>{throw Cs("RestConnection",`RPC '${n}' ${u} failed with error: `,g,"url: ",d,"request:",r),g})}Lo(n,i,r,o,a,u){return this.Mo(n,i,r,o,a)}Oo(n,i,r){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Os}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((o,a)=>n[a]=o),r&&r.headers.forEach((o,a)=>n[a]=o)}xo(n,i){const r=_V[n];return`${this.Do}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,i,r){const o=Nh();return new Promise((a,u)=>{const d=new uw;d.setWithCredentials(!0),d.listenOnce(cw.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case yc.NO_ERROR:const g=d.getResponseJson();ae(Ft,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),a(g);break;case yc.TIMEOUT:ae(Ft,`RPC '${e}' ${o} timed out`),u(new se(Y.DEADLINE_EXCEEDED,"Request time out"));break;case yc.HTTP_ERROR:const y=d.getStatus();if(ae(Ft,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let T=d.getResponseJson();Array.isArray(T)&&(T=T[0]);const I=T==null?void 0:T.error;if(I&&I.status&&I.message){const V=function(q){const A=q.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(A)>=0?A:Y.UNKNOWN}(I.status);u(new se(V,I.message))}else u(new se(Y.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new se(Y.UNAVAILABLE,"Connection failed."));break;default:ge()}}finally{ae(Ft,`RPC '${e}' ${o} completed.`)}});const p=JSON.stringify(r);ae(Ft,`RPC '${e}' ${o} sending request:`,r),d.send(n,"POST",p,i,15)})}Bo(e,n,i){const r=Nh(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=fw(),u=hw(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Oo(d.initMessageHeaders,n,i),d.encodeInitMessageHeaders=!0;const g=o.join("");ae(Ft,`Creating RPC '${e}' stream ${r}: ${g}`,d);const y=a.createWebChannel(g,d);let T=!1,I=!1;const V=new yV({Io:q=>{I?ae(Ft,`Not sending because RPC '${e}' stream ${r} is closed:`,q):(T||(ae(Ft,`Opening RPC '${e}' stream ${r} transport.`),y.open(),T=!0),ae(Ft,`RPC '${e}' stream ${r} sending:`,q),y.send(q))},To:()=>y.close()}),b=(q,A,x)=>{q.listen(A,R=>{try{x(R)}catch(z){setTimeout(()=>{throw z},0)}})};return b(y,za.EventType.OPEN,()=>{I||(ae(Ft,`RPC '${e}' stream ${r} transport opened.`),V.yo())}),b(y,za.EventType.CLOSE,()=>{I||(I=!0,ae(Ft,`RPC '${e}' stream ${r} transport closed`),V.So())}),b(y,za.EventType.ERROR,q=>{I||(I=!0,Cs(Ft,`RPC '${e}' stream ${r} transport errored:`,q),V.So(new se(Y.UNAVAILABLE,"The operation could not be completed")))}),b(y,za.EventType.MESSAGE,q=>{var A;if(!I){const x=q.data[0];ze(!!x);const R=x,z=R.error||((A=R[0])===null||A===void 0?void 0:A.error);if(z){ae(Ft,`RPC '${e}' stream ${r} received error:`,z);const W=z.status;let J=function(D){const F=pt[D];if(F!==void 0)return zw(F)}(W),k=z.message;J===void 0&&(J=Y.INTERNAL,k="Unknown error status: "+W+" with message "+z.message),I=!0,V.So(new se(J,k)),y.close()}else ae(Ft,`RPC '${e}' stream ${r} received:`,x),V.bo(x)}}),b(u,dw.STAT_EVENT,q=>{q.stat===Hf.PROXY?ae(Ft,`RPC '${e}' stream ${r} detected buffering proxy`):q.stat===Hf.NOPROXY&&ae(Ft,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{V.wo()},0),V}}function kh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(t){return new RD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e,n,i=1e3,r=1.5,o=6e4){this.ui=e,this.timerId=n,this.ko=i,this.qo=r,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,n-i);r>0&&ae("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e,n,i,r,o,a,u,d){this.ui=e,this.Ho=i,this.Jo=r,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=d,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new jw(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Y.RESOURCE_EXHAUSTED?(Ni(n.toString()),Ni("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Yo===n&&this.P_(i,r)},i=>{e(()=>{const r=new se(Y.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(r)})})}P_(e,n){const i=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{i(()=>this.listener.Eo())}),this.stream.Ro(()=>{i(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(r=>{i(()=>this.I_(r))}),this.stream.onMessage(r=>{i(()=>++this.e_==1?this.E_(r):this.onNext(r))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ae("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ae("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class TV extends eC{constructor(e,n,i,r,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,r,a),this.serializer=o}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=MD(this.serializer,e),i=function(o){if(!("targetChange"in o))return ye.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?ye.min():a.readTime?ri(a.readTime):ye.min()}(e);return this.listener.d_(n,i)}A_(e){const n={};n.database=Xf(this.serializer),n.addTarget=function(o,a){let u;const d=a.target;if(u=Kf(d)?{documents:VD(o,d)}:{query:bD(o,d)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=Gw(o,a.resumeToken);const p=Zf(o,a.expectedCount);p!==null&&(u.expectedCount=p)}else if(a.snapshotVersion.compareTo(ye.min())>0){u.readTime=id(o,a.snapshotVersion.toTimestamp());const p=Zf(o,a.expectedCount);p!==null&&(u.expectedCount=p)}return u}(this.serializer,e);const i=UD(this.serializer,e);i&&(n.labels=i),this.a_(n)}R_(e){const n={};n.database=Xf(this.serializer),n.removeTarget=e,this.a_(n)}}class EV extends eC{constructor(e,n,i,r,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,r,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return ze(!!e.streamToken),this.lastStreamToken=e.streamToken,ze(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ze(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=DD(e.writeResults,e.commitTime),i=ri(e.commitTime);return this.listener.g_(i,n)}p_(){const e={};e.database=Xf(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(i=>LD(this.serializer,i))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV extends class{}{constructor(e,n,i,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new se(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,Yf(n,i),r,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new se(Y.UNKNOWN,o.toString())})}Lo(e,n,i,r,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,Yf(n,i),r,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new se(Y.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class CV{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ni(n),this.D_=!1):ae("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IV{constructor(e,n,i,r,o){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{i.enqueueAndForget(async()=>{ao(this)&&(ae("RemoteStore","Restarting streams for network reachability change."),await async function(d){const p=ve(d);p.L_.add(4),await Kl(p),p.q_.set("Unknown"),p.L_.delete(4),await Vd(p)}(this))})}),this.q_=new CV(i,r)}}async function Vd(t){if(ao(t))for(const e of t.B_)await e(!0)}async function Kl(t){for(const e of t.B_)await e(!1)}function tC(t,e){const n=ve(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Rm(n)?Pm(n):qs(n).r_()&&Am(n,e))}function xm(t,e){const n=ve(t),i=qs(n);n.N_.delete(e),i.r_()&&nC(n,e),n.N_.size===0&&(i.r_()?i.o_():ao(n)&&n.q_.set("Unknown"))}function Am(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ye.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}qs(t).A_(e)}function nC(t,e){t.Q_.xe(e),qs(t).R_(e)}function Pm(t){t.Q_=new SD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),qs(t).start(),t.q_.v_()}function Rm(t){return ao(t)&&!qs(t).n_()&&t.N_.size>0}function ao(t){return ve(t).L_.size===0}function iC(t){t.Q_=void 0}async function SV(t){t.q_.set("Online")}async function xV(t){t.N_.forEach((e,n)=>{Am(t,e)})}async function AV(t,e){iC(t),Rm(t)?(t.q_.M_(e),Pm(t)):t.q_.set("Unknown")}async function PV(t,e,n){if(t.q_.set("Online"),e instanceof Hw&&e.state===2&&e.cause)try{await async function(r,o){const a=o.cause;for(const u of o.targetIds)r.N_.has(u)&&(await r.remoteSyncer.rejectListen(u,a),r.N_.delete(u),r.Q_.removeTarget(u))}(t,e)}catch(i){ae("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await rd(t,i)}else if(e instanceof Ec?t.Q_.Ke(e):e instanceof qw?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ye.min()))try{const i=await Xw(t.localStore);n.compareTo(i)>=0&&await function(o,a){const u=o.Q_.rt(a);return u.targetChanges.forEach((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const g=o.N_.get(p);g&&o.N_.set(p,g.withResumeToken(d.resumeToken,a))}}),u.targetMismatches.forEach((d,p)=>{const g=o.N_.get(d);if(!g)return;o.N_.set(d,g.withResumeToken(Dt.EMPTY_BYTE_STRING,g.snapshotVersion)),nC(o,d);const y=new er(g.target,d,p,g.sequenceNumber);Am(o,y)}),o.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(i){ae("RemoteStore","Failed to raise snapshot:",i),await rd(t,i)}}async function rd(t,e,n){if(!Gl(e))throw e;t.L_.add(1),await Kl(t),t.q_.set("Offline"),n||(n=()=>Xw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ae("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Vd(t)})}function rC(t,e){return e().catch(n=>rd(t,n,e))}async function bd(t){const e=ve(t),n=gr(e);let i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;RV(e);)try{const r=await hV(e.localStore,i);if(r===null){e.O_.length===0&&n.o_();break}i=r.batchId,NV(e,r)}catch(r){await rd(e,r)}oC(e)&&sC(e)}function RV(t){return ao(t)&&t.O_.length<10}function NV(t,e){t.O_.push(e);const n=gr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function oC(t){return ao(t)&&!gr(t).n_()&&t.O_.length>0}function sC(t){gr(t).start()}async function kV(t){gr(t).p_()}async function MV(t){const e=gr(t);for(const n of t.O_)e.m_(n.mutations)}async function LV(t,e,n){const i=t.O_.shift(),r=Tm.from(i,e,n);await rC(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await bd(t)}async function DV(t,e){e&&gr(t).V_&&await async function(i,r){if(function(a){return wD(a)&&a!==Y.ABORTED}(r.code)){const o=i.O_.shift();gr(i).s_(),await rC(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r)),await bd(i)}}(t,e),oC(t)&&sC(t)}async function Ov(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),ae("RemoteStore","RemoteStore received new credentials");const i=ao(n);n.L_.add(3),await Kl(n),i&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Vd(n)}async function VV(t,e){const n=ve(t);e?(n.L_.delete(2),await Vd(n)):e||(n.L_.add(2),await Kl(n),n.q_.set("Unknown"))}function qs(t){return t.K_||(t.K_=function(n,i,r){const o=ve(n);return o.w_(),new TV(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)}(t.datastore,t.asyncQueue,{Eo:SV.bind(null,t),Ro:xV.bind(null,t),mo:AV.bind(null,t),d_:PV.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Rm(t)?Pm(t):t.q_.set("Unknown")):(await t.K_.stop(),iC(t))})),t.K_}function gr(t){return t.U_||(t.U_=function(n,i,r){const o=ve(n);return o.w_(),new EV(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:kV.bind(null,t),mo:DV.bind(null,t),f_:MV.bind(null,t),g_:LV.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await bd(t)):(await t.U_.stop(),t.O_.length>0&&(ae("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e,n,i,r,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new Kr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,r,o){const a=Date.now()+i,u=new Nm(e,n,a,r,o);return u.start(i),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new se(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function km(t,e){if(Ni("AsyncQueue",`${e}: ${t}`),Gl(t))return new se(Y.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e){this.comparator=e?(n,i)=>e(n,i)||ce.comparator(n.key,i.key):(n,i)=>ce.comparator(n.key,i.key),this.keyedMap=qa(),this.sortedSet=new ot(this.comparator)}static emptySet(e){return new ps(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,i)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ps)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new ps;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(){this.W_=new ot(ce.comparator)}track(e){const n=e.doc.key,i=this.W_.get(n);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(n,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(n):e.type===1&&i.type===2?this.W_=this.W_.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ge():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,i)=>{e.push(i)}),e}}class Ps{constructor(e,n,i,r,o,a,u,d,p){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=d,this.hasCachedResults=p}static fromInitialDocuments(e,n,i,r,o){const a=[];return n.forEach(u=>{a.push({type:0,doc:u})}),new Ps(e,n,ps.emptySet(n),a,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Rd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==i[r].type||!n[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bV{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class FV{constructor(){this.queries=zv(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,i){const r=ve(n),o=r.queries;r.queries=zv(),o.forEach((a,u)=>{for(const d of u.j_)d.onError(i)})})(this,new se(Y.ABORTED,"Firestore shutting down"))}}function zv(){return new zs(t=>xw(t),Rd)}async function UV(t,e){const n=ve(t);let i=3;const r=e.query;let o=n.queries.get(r);o?!o.H_()&&e.J_()&&(i=2):(o=new bV,i=e.J_()?0:1);try{switch(i){case 0:o.z_=await n.onListen(r,!0);break;case 1:o.z_=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(a){const u=km(a,`Initialization of query '${qo(e.query)}' failed`);return void e.onError(u)}n.queries.set(r,o),o.j_.push(e),e.Z_(n.onlineState),o.z_&&e.X_(o.z_)&&Mm(n)}async function OV(t,e){const n=ve(t),i=e.query;let r=3;const o=n.queries.get(i);if(o){const a=o.j_.indexOf(e);a>=0&&(o.j_.splice(a,1),o.j_.length===0?r=e.J_()?0:1:!o.H_()&&e.J_()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function BV(t,e){const n=ve(t);let i=!1;for(const r of e){const o=r.query,a=n.queries.get(o);if(a){for(const u of a.j_)u.X_(r)&&(i=!0);a.z_=r}}i&&Mm(n)}function zV(t,e,n){const i=ve(t),r=i.queries.get(e);if(r)for(const o of r.j_)o.onError(n);i.queries.delete(e)}function Mm(t){t.Y_.forEach(e=>{e.next()})}var ep,qv;(qv=ep||(ep={})).ea="default",qv.Cache="cache";class qV{constructor(e,n,i){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Ps(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const i=n!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Ps.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ep.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e){this.key=e}}class lC{constructor(e){this.key=e}}class HV{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Re(),this.mutatedKeys=Re(),this.Aa=Aw(e),this.Ra=new ps(this.Aa)}get Va(){return this.Ta}ma(e,n){const i=n?n.fa:new Bv,r=n?n.Ra:this.Ra;let o=n?n.mutatedKeys:this.mutatedKeys,a=r,u=!1;const d=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,p=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((g,y)=>{const T=r.get(g),I=Nd(this.query,y)?y:null,V=!!T&&this.mutatedKeys.has(T.key),b=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let q=!1;T&&I?T.data.isEqual(I.data)?V!==b&&(i.track({type:3,doc:I}),q=!0):this.ga(T,I)||(i.track({type:2,doc:I}),q=!0,(d&&this.Aa(I,d)>0||p&&this.Aa(I,p)<0)&&(u=!0)):!T&&I?(i.track({type:0,doc:I}),q=!0):T&&!I&&(i.track({type:1,doc:T}),q=!0,(d||p)&&(u=!0)),q&&(I?(a=a.add(I),o=b?o.add(g):o.delete(g)):(a=a.delete(g),o=o.delete(g)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const g=this.query.limitType==="F"?a.last():a.first();a=a.delete(g.key),o=o.delete(g.key),i.track({type:1,doc:g})}return{Ra:a,fa:i,ns:u,mutatedKeys:o}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,r){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((g,y)=>function(I,V){const b=q=>{switch(q){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ge()}};return b(I)-b(V)}(g.type,y.type)||this.Aa(g.doc,y.doc)),this.pa(i),r=r!=null&&r;const u=n&&!r?this.ya():[],d=this.da.size===0&&this.current&&!r?1:0,p=d!==this.Ea;return this.Ea=d,a.length!==0||p?{snapshot:new Ps(this.query,e.Ra,o,a,e.mutatedKeys,d===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Bv,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Re(),this.Ra.forEach(i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))});const n=[];return e.forEach(i=>{this.da.has(i)||n.push(new lC(i))}),this.da.forEach(i=>{e.has(i)||n.push(new aC(i))}),n}ba(e){this.Ta=e.Ts,this.da=Re();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Ps.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class GV{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class WV{constructor(e){this.key=e,this.va=!1}}class $V{constructor(e,n,i,r,o,a){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new zs(u=>xw(u),Rd),this.Ma=new Map,this.xa=new Set,this.Oa=new ot(ce.comparator),this.Na=new Map,this.La=new Cm,this.Ba={},this.ka=new Map,this.qa=As.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function KV(t,e,n=!0){const i=pC(t);let r;const o=i.Fa.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.Da()):r=await uC(i,e,n,!0),r}async function JV(t,e){const n=pC(t);await uC(n,e,!0,!1)}async function uC(t,e,n,i){const r=await fV(t.localStore,ni(e)),o=r.targetId,a=t.sharedClientState.addLocalQueryTarget(o,n);let u;return i&&(u=await ZV(t,e,o,a==="current",r.resumeToken)),t.isPrimaryClient&&n&&tC(t.remoteStore,r),u}async function ZV(t,e,n,i,r){t.Ka=(y,T,I)=>async function(b,q,A,x){let R=q.view.ma(A);R.ns&&(R=await bv(b.localStore,q.query,!1).then(({documents:k})=>q.view.ma(k,R)));const z=x&&x.targetChanges.get(q.targetId),W=x&&x.targetMismatches.get(q.targetId)!=null,J=q.view.applyChanges(R,b.isPrimaryClient,z,W);return Gv(b,q.targetId,J.wa),J.snapshot}(t,y,T,I);const o=await bv(t.localStore,e,!0),a=new HV(e,o.Ts),u=a.ma(o.documents),d=$l.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",r),p=a.applyChanges(u,t.isPrimaryClient,d);Gv(t,n,p.wa);const g=new GV(e,n,a);return t.Fa.set(e,g),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),p.snapshot}async function YV(t,e,n){const i=ve(t),r=i.Fa.get(e),o=i.Ma.get(r.targetId);if(o.length>1)return i.Ma.set(r.targetId,o.filter(a=>!Rd(a,e))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await jf(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),n&&xm(i.remoteStore,r.targetId),tp(i,r.targetId)}).catch(Hl)):(tp(i,r.targetId),await jf(i.localStore,r.targetId,!0))}async function QV(t,e){const n=ve(t),i=n.Fa.get(e),r=n.Ma.get(i.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),xm(n.remoteStore,i.targetId))}async function XV(t,e,n){const i=ob(t);try{const r=await function(a,u){const d=ve(a),p=Tt.now(),g=u.reduce((I,V)=>I.add(V.key),Re());let y,T;return d.persistence.runTransaction("Locally write mutations","readwrite",I=>{let V=ki(),b=Re();return d.cs.getEntries(I,g).next(q=>{V=q,V.forEach((A,x)=>{x.isValidDocument()||(b=b.add(A))})}).next(()=>d.localDocuments.getOverlayedDocuments(I,V)).next(q=>{y=q;const A=[];for(const x of u){const R=_D(x,y.get(x.key).overlayedDocument);R!=null&&A.push(new Er(x.key,R,yw(R.value.mapValue),ii.exists(!0)))}return d.mutationQueue.addMutationBatch(I,p,A,u)}).next(q=>{T=q;const A=q.applyToLocalDocumentSet(y,b);return d.documentOverlayCache.saveOverlays(I,q.batchId,A)})}).then(()=>({batchId:T.batchId,changes:Rw(y)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(a,u,d){let p=a.Ba[a.currentUser.toKey()];p||(p=new ot(Ve)),p=p.insert(u,d),a.Ba[a.currentUser.toKey()]=p}(i,r.batchId,n),await Jl(i,r.changes),await bd(i.remoteStore)}catch(r){const o=km(r,"Failed to persist write");n.reject(o)}}async function cC(t,e){const n=ve(t);try{const i=await cV(n.localStore,e);e.targetChanges.forEach((r,o)=>{const a=n.Na.get(o);a&&(ze(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?a.va=!0:r.modifiedDocuments.size>0?ze(a.va):r.removedDocuments.size>0&&(ze(a.va),a.va=!1))}),await Jl(n,i,e)}catch(i){await Hl(i)}}function Hv(t,e,n){const i=ve(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const r=[];i.Fa.forEach((o,a)=>{const u=a.view.Z_(e);u.snapshot&&r.push(u.snapshot)}),function(a,u){const d=ve(a);d.onlineState=u;let p=!1;d.queries.forEach((g,y)=>{for(const T of y.j_)T.Z_(u)&&(p=!0)}),p&&Mm(d)}(i.eventManager,e),r.length&&i.Ca.d_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function jV(t,e,n){const i=ve(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.Na.get(e),o=r&&r.key;if(o){let a=new ot(ce.comparator);a=a.insert(o,Bt.newNoDocument(o,ye.min()));const u=Re().add(o),d=new Ld(ye.min(),new Map,new ot(Ve),a,u);await cC(i,d),i.Oa=i.Oa.remove(o),i.Na.delete(e),Lm(i)}else await jf(i.localStore,e,!1).then(()=>tp(i,e,n)).catch(Hl)}async function eb(t,e){const n=ve(t),i=e.batch.batchId;try{const r=await uV(n.localStore,e);hC(n,i,null),dC(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Jl(n,r)}catch(r){await Hl(r)}}async function tb(t,e,n){const i=ve(t);try{const r=await function(a,u){const d=ve(a);return d.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let g;return d.mutationQueue.lookupMutationBatch(p,u).next(y=>(ze(y!==null),g=y.keys(),d.mutationQueue.removeMutationBatch(p,y))).next(()=>d.mutationQueue.performConsistencyCheck(p)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(p,g,u)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g)).next(()=>d.localDocuments.getDocuments(p,g))})}(i.localStore,e);hC(i,e,n),dC(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Jl(i,r)}catch(r){await Hl(r)}}function dC(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function hC(t,e,n){const i=ve(t);let r=i.Ba[i.currentUser.toKey()];if(r){const o=r.get(e);o&&(n?o.reject(n):o.resolve(),r=r.remove(e)),i.Ba[i.currentUser.toKey()]=r}}function tp(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Ma.get(e))t.Fa.delete(i),n&&t.Ca.$a(i,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(i=>{t.La.containsKey(i)||fC(t,i)})}function fC(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(xm(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Lm(t))}function Gv(t,e,n){for(const i of n)i instanceof aC?(t.La.addReference(i.key,e),nb(t,i)):i instanceof lC?(ae("SyncEngine","Document no longer in limbo: "+i.key),t.La.removeReference(i.key,e),t.La.containsKey(i.key)||fC(t,i.key)):ge()}function nb(t,e){const n=e.key,i=n.path.canonicalString();t.Oa.get(n)||t.xa.has(i)||(ae("SyncEngine","New document in limbo: "+n),t.xa.add(i),Lm(t))}function Lm(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ce(Ze.fromString(e)),i=t.qa.next();t.Na.set(i,new WV(n)),t.Oa=t.Oa.insert(n,i),tC(t.remoteStore,new er(ni(ym(n.path)),i,"TargetPurposeLimboResolution",hm.oe))}}async function Jl(t,e,n){const i=ve(t),r=[],o=[],a=[];i.Fa.isEmpty()||(i.Fa.forEach((u,d)=>{a.push(i.Ka(d,e,n).then(p=>{var g;if((p||n)&&i.isPrimaryClient){const y=p?!p.fromCache:(g=n==null?void 0:n.targetChanges.get(d.targetId))===null||g===void 0?void 0:g.current;i.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(p){r.push(p);const y=Sm.Wi(d.targetId,p);o.push(y)}}))}),await Promise.all(a),i.Ca.d_(r),await async function(d,p){const g=ve(d);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>X.forEach(p,T=>X.forEach(T.$i,I=>g.persistence.referenceDelegate.addReference(y,T.targetId,I)).next(()=>X.forEach(T.Ui,I=>g.persistence.referenceDelegate.removeReference(y,T.targetId,I)))))}catch(y){if(!Gl(y))throw y;ae("LocalStore","Failed to update sequence numbers: "+y)}for(const y of p){const T=y.targetId;if(!y.fromCache){const I=g.os.get(T),V=I.snapshotVersion,b=I.withLastLimboFreeSnapshotVersion(V);g.os=g.os.insert(T,b)}}}(i.localStore,o))}async function ib(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){ae("SyncEngine","User change. New user:",e.toKey());const i=await Qw(n.localStore,e);n.currentUser=e,function(o,a){o.ka.forEach(u=>{u.forEach(d=>{d.reject(new se(Y.CANCELLED,a))})}),o.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Jl(n,i.hs)}}function rb(t,e){const n=ve(t),i=n.Na.get(e);if(i&&i.va)return Re().add(i.key);{let r=Re();const o=n.Ma.get(e);if(!o)return r;for(const a of o){const u=n.Fa.get(a);r=r.unionWith(u.view.Va)}return r}}function pC(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=cC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jV.bind(null,e),e.Ca.d_=BV.bind(null,e.eventManager),e.Ca.$a=zV.bind(null,e.eventManager),e}function ob(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=eb.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tb.bind(null,e),e}class od{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Dd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return lV(this.persistence,new sV,e.initialUser,this.serializer)}Ga(e){return new iV(Im.Zr,this.serializer)}Wa(e){return new mV}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}od.provider={build:()=>new od};class np{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Hv(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=ib.bind(null,this.syncEngine),await VV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new FV}()}createDatastore(e){const n=Dd(e.databaseInfo.databaseId),i=function(o){return new vV(o)}(e.databaseInfo);return function(o,a,u,d){return new wV(o,a,u,d)}(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return function(i,r,o,a,u){return new IV(i,r,o,a,u)}(this.localStore,this.datastore,e.asyncQueue,n=>Hv(this.syncEngine,n,0),function(){return Uv.D()?new Uv:new gV}())}createSyncEngine(e,n){return function(r,o,a,u,d,p,g){const y=new $V(r,o,a,u,d,p);return g&&(y.Qa=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(r){const o=ve(r);ae("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await Kl(o),o.k_.shutdown(),o.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}np.provider={build:()=>new np};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ni("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e,n,i,r,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=r,this.user=Ut.UNAUTHENTICATED,this.clientId=mw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async a=>{ae("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(i,a=>(ae("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Kr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=km(n,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function Mh(t,e){t.asyncQueue.verifyOperationInProgress(),ae("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener(async r=>{i.isEqual(r)||(await Qw(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Wv(t,e){t.asyncQueue.verifyOperationInProgress();const n=await lb(t);ae("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(i=>Ov(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,r)=>Ov(e.remoteStore,r)),t._onlineComponents=e}async function lb(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ae("FirestoreClient","Using user provided OfflineComponentProvider");try{await Mh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(r){return r.name==="FirebaseError"?r.code===Y.FAILED_PRECONDITION||r.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;Cs("Error using user provided cache. Falling back to memory cache: "+n),await Mh(t,new od)}}else ae("FirestoreClient","Using default OfflineComponentProvider"),await Mh(t,new od);return t._offlineComponents}async function mC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ae("FirestoreClient","Using user provided OnlineComponentProvider"),await Wv(t,t._uninitializedComponentsProvider._online)):(ae("FirestoreClient","Using default OnlineComponentProvider"),await Wv(t,new np))),t._onlineComponents}function ub(t){return mC(t).then(e=>e.syncEngine)}async function $v(t){const e=await mC(t),n=e.eventManager;return n.onListen=KV.bind(null,e.syncEngine),n.onUnlisten=YV.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=JV.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=QV.bind(null,e.syncEngine),n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kv=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _C(t,e,n){if(!n)throw new se(Y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function cb(t,e,n,i){if(e===!0&&i===!0)throw new se(Y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Jv(t){if(!ce.isDocumentKey(t))throw new se(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Zv(t){if(ce.isDocumentKey(t))throw new se(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Fd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ge()}function Jr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new se(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Fd(t);throw new se(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(e){var n,i;if(e.host===void 0){if(e.ssl!==void 0)throw new se(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new se(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gC((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new se(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new se(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new se(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ud{constructor(e,n,i,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yv({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new se(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new se(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yv(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new A2;switch(i.type){case"firstParty":return new k2(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new se(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=Kv.get(n);i&&(ae("ComponentProvider","Removing Datastore"),Kv.delete(n),i.terminate())}(this),Promise.resolve()}}function db(t,e,n,i={}){var r;const o=(t=Jr(t,Ud))._getSettings(),a=`${e}:${n}`;if(o.host!=="firestore.googleapis.com"&&o.host!==a&&Cs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),i.mockUserToken){let u,d;if(typeof i.mockUserToken=="string")u=i.mockUserToken,d=Ut.MOCK_USER;else{u=sL(i.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new se(Y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Ut(p)}t._authCredentials=new P2(new pw(u,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new wr(this.firestore,e,this._query)}}class rn{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rn(this.firestore,e,this._key)}}class dr extends wr{constructor(e,n,i){super(e,n,ym(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rn(this.firestore,null,new ce(e))}withConverter(e){return new dr(this.firestore,e,this._path)}}function yC(t,e,...n){if(t=oi(t),_C("collection","path",e),t instanceof Ud){const i=Ze.fromString(e,...n);return Zv(i),new dr(t,null,i)}{if(!(t instanceof rn||t instanceof dr))throw new se(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Ze.fromString(e,...n));return Zv(i),new dr(t.firestore,null,i)}}function vC(t,e,...n){if(t=oi(t),arguments.length===1&&(e=mw.newId()),_C("doc","path",e),t instanceof Ud){const i=Ze.fromString(e,...n);return Jv(i),new rn(t,null,new ce(i))}{if(!(t instanceof rn||t instanceof dr))throw new se(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Ze.fromString(e,...n));return Jv(i),new rn(t.firestore,t instanceof dr?t.converter:null,new ce(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new jw(this,"async_queue_retry"),this.Vu=()=>{const i=kh();i&&ae("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;const n=kh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=kh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Kr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Gl(e))throw e;ae("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(i=>{this.Eu=i,this.du=!1;const r=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(i);throw Ni("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.du=!1,i))));return this.mu=n,n}enqueueAfterDelay(e,n,i){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const r=Nm.createAndSchedule(this,e,n,i,o=>this.yu(o));return this.Tu.push(r),r}fu(){this.Eu&&ge()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Xv(t){return function(n,i){if(typeof n!="object"||n===null)return!1;const r=n;for(const o of i)if(o in r&&typeof r[o]=="function")return!0;return!1}(t,["next","error","complete"])}class Vl extends Ud{constructor(e,n,i,r){super(e,n,i,r),this.type="firestore",this._queue=new Qv,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Qv(e),this._firestoreClient=void 0,await e}}}function hb(t,e){const n=typeof t=="object"?t:m2(),i=typeof t=="string"?t:"(default)",r=d2(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const o=rL("firestore");o&&db(r,...o)}return r}function TC(t){if(t._terminated)throw new se(Y.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||fb(t),t._firestoreClient}function fb(t){var e,n,i;const r=t._freezeSettings(),o=function(u,d,p,g){return new G2(u,d,p,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,gC(g.experimentalLongPollingOptions),g.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,r);t._componentsProvider||!((n=r.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),t._firestoreClient=new ab(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const d=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Rs(Dt.fromBase64String(e))}catch(n){throw new se(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Rs(Dt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new se(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Nt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new se(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new se(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb=/^__.*__$/;class mb{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new Er(e,this.data,this.fieldMask,n,this.fieldTransforms):new Wl(e,this.data,n,this.fieldTransforms)}}class EC{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new Er(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function wC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ge()}}class bm{constructor(e,n,i,r,o,a){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new bm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.Fu({path:i,xu:!1});return r.Ou(e),r}Nu(e){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.Fu({path:i,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return sd(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(wC(this.Cu)&&pb.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class gb{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||Dd(e)}Qu(e,n,i,r=!1){return new bm({Cu:e,methodName:n,qu:i,path:Nt.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fm(t){const e=t._freezeSettings(),n=Dd(t._databaseId);return new gb(t._databaseId,!!e.ignoreUndefinedProperties,n)}function _b(t,e,n,i,r,o={}){const a=t.Qu(o.merge||o.mergeFields?2:0,e,n,r);Bm("Data must be an object, but it was:",a,i);const u=CC(i,a);let d,p;if(o.merge)d=new cn(a.fieldMask),p=a.fieldTransforms;else if(o.mergeFields){const g=[];for(const y of o.mergeFields){const T=ip(e,y,n);if(!a.contains(T))throw new se(Y.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);SC(g,T)||g.push(T)}d=new cn(g),p=a.fieldTransforms.filter(y=>d.covers(y.field))}else d=null,p=a.fieldTransforms;return new mb(new Xt(u),d,p)}class Bd extends Zl{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Bd}}class Um extends Zl{_toFieldTransform(e){return new Fw(e.path,new kl)}isEqual(e){return e instanceof Um}}class Om extends Zl{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new Dl(e.serializer,Mw(e.serializer,this.$u));return new Fw(e.path,n)}isEqual(e){return e instanceof Om&&this.$u===e.$u}}function yb(t,e,n,i){const r=t.Qu(1,e,n);Bm("Data must be an object, but it was:",r,i);const o=[],a=Xt.empty();so(i,(d,p)=>{const g=zm(e,d,n);p=oi(p);const y=r.Nu(g);if(p instanceof Bd)o.push(g);else{const T=Yl(p,y);T!=null&&(o.push(g),a.set(g,T))}});const u=new cn(o);return new EC(a,u,r.fieldTransforms)}function vb(t,e,n,i,r,o){const a=t.Qu(1,e,n),u=[ip(e,i,n)],d=[r];if(o.length%2!=0)throw new se(Y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<o.length;T+=2)u.push(ip(e,o[T])),d.push(o[T+1]);const p=[],g=Xt.empty();for(let T=u.length-1;T>=0;--T)if(!SC(p,u[T])){const I=u[T];let V=d[T];V=oi(V);const b=a.Nu(I);if(V instanceof Bd)p.push(I);else{const q=Yl(V,b);q!=null&&(p.push(I),g.set(I,q))}}const y=new cn(p);return new EC(g,y,a.fieldTransforms)}function Tb(t,e,n,i=!1){return Yl(n,t.Qu(i?4:3,e))}function Yl(t,e){if(IC(t=oi(t)))return Bm("Unsupported field value:",e,t),CC(t,e);if(t instanceof Zl)return function(i,r){if(!wC(r.Cu))throw r.Bu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Bu(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(i,r){const o=[];let a=0;for(const u of i){let d=Yl(u,r.Lu(a));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),a++}return{arrayValue:{values:o}}}(t,e)}return function(i,r){if((i=oi(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Mw(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=Tt.fromDate(i);return{timestampValue:id(r.serializer,o)}}if(i instanceof Tt){const o=new Tt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:id(r.serializer,o)}}if(i instanceof Dm)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Rs)return{bytesValue:Gw(r.serializer,i._byteString)};if(i instanceof rn){const o=r.databaseId,a=i.firestore._databaseId;if(!a.isEqual(o))throw r.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:wm(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Vm)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw u.Bu("VectorValues must only contain numeric values.");return vm(u.serializer,d)})}}}}}}(i,r);throw r.Bu(`Unsupported field value: ${Fd(i)}`)}(t,e)}function CC(t,e){const n={};return gw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):so(t,(i,r)=>{const o=Yl(r,e.Mu(i));o!=null&&(n[i]=o)}),{mapValue:{fields:n}}}function IC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Tt||t instanceof Dm||t instanceof Rs||t instanceof rn||t instanceof Zl||t instanceof Vm)}function Bm(t,e,n){if(!IC(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const i=Fd(n);throw i==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+i)}}function ip(t,e,n){if((e=oi(e))instanceof Od)return e._internalPath;if(typeof e=="string")return zm(t,e);throw sd("Field path arguments must be of type string or ",t,!1,void 0,n)}const Eb=new RegExp("[~\\*/\\[\\]]");function zm(t,e,n){if(e.search(Eb)>=0)throw sd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Od(...e.split("."))._internalPath}catch{throw sd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function sd(t,e,n,i,r){const o=i&&!i.isEmpty(),a=r!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let d="";return(o||a)&&(d+=" (found",o&&(d+=` in field ${i}`),a&&(d+=` in document ${r}`),d+=")"),new se(Y.INVALID_ARGUMENT,u+t+d)}function SC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(e,n,i,r,o){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new rn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new wb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(qm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class wb extends xC{data(){return super.data()}}function qm(t,e){return typeof e=="string"?zm(t,e):e instanceof Od?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cb(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new se(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Hm{}class Gm extends Hm{}function Ib(t,e,...n){let i=[];e instanceof Hm&&i.push(e),i=i.concat(n),function(o){const a=o.filter(d=>d instanceof $m).length,u=o.filter(d=>d instanceof Wm).length;if(a>1||a>0&&u>0)throw new se(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)t=r._apply(t);return t}class Wm extends Gm{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new Wm(e,n,i)}_apply(e){const n=this._parse(e);return AC(e._query,n),new wr(e.firestore,e.converter,Jf(e._query,n))}_parse(e){const n=Fm(e.firestore);return function(o,a,u,d,p,g,y){let T;if(p.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new se(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){e0(y,g);const I=[];for(const V of y)I.push(jv(d,o,V));T={arrayValue:{values:I}}}else T=jv(d,o,y)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||e0(y,g),T=Tb(u,a,y,g==="in"||g==="not-in");return gt.create(p,g,T)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class $m extends Hm{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new $m(e,n)}_parse(e){const n=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return n.length===1?n[0]:Gn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,o){let a=r;const u=o.getFlattenedFilters();for(const d of u)AC(a,d),a=Jf(a,d)}(e._query,n),new wr(e.firestore,e.converter,Jf(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Km extends Gm{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Km(e,n)}_apply(e){const n=function(r,o,a){if(r.startAt!==null)throw new se(Y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new se(Y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Nl(o,a)}(e._query,this._field,this._direction);return new wr(e.firestore,e.converter,function(r,o){const a=r.explicitOrderBy.concat([o]);return new Bs(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function Sb(t,e="asc"){const n=e,i=qm("orderBy",t);return Km._create(i,n)}class Jm extends Gm{constructor(e,n,i){super(),this.type=e,this._limit=n,this._limitType=i}static _create(e,n,i){return new Jm(e,n,i)}_apply(e){return new wr(e.firestore,e.converter,nd(e._query,this._limit,this._limitType))}}function xb(t){return Jm._create("limit",t,"F")}function jv(t,e,n){if(typeof(n=oi(n))=="string"){if(n==="")throw new se(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sw(e)&&n.indexOf("/")!==-1)throw new se(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(Ze.fromString(n));if(!ce.isDocumentKey(i))throw new se(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return vv(t,new ce(i))}if(n instanceof rn)return vv(t,n._key);throw new se(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Fd(n)}.`)}function e0(t,e){if(!Array.isArray(t)||t.length===0)throw new se(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function AC(t,e){const n=function(r,o){for(const a of r)for(const u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new se(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new se(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Ab{convertValue(e,n="none"){switch(no(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(to(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ge()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return so(e,(r,o)=>{i[r]=this.convertValue(o,n)}),i}convertVectorValue(e){var n,i,r;const o=(r=(i=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(a=>ut(a.doubleValue));return new Vm(o)}convertGeoPoint(e){return new Dm(ut(e.latitude),ut(e.longitude))}convertArray(e,n){return(e.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(e,n){switch(n){case"previous":const i=pm(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Al(e));default:return null}}convertTimestamp(e){const n=mr(e);return new Tt(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=Ze.fromString(e);ze(Yw(i));const r=new Pl(i.get(1),i.get(3)),o=new ce(i.popFirst(5));return r.isEqual(n)||Ni(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pb(t,e,n){let i;return i=t?t.toFirestore(e):e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class PC extends xC{constructor(e,n,i,r,o,a){super(e,n,i,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new wc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(qm("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}}class wc extends PC{data(e={}){return super.data(e)}}class Rb{constructor(e,n,i,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new Ga(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(i=>{e.call(n,new wc(this._firestore,this._userDataWriter,i.key,i,new Ga(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new se(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,o){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(u=>{const d=new wc(r._firestore,r._userDataWriter,u.doc.key,u.doc,new Ga(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);return u.doc,{type:"added",doc:d,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const d=new wc(r._firestore,r._userDataWriter,u.doc.key,u.doc,new Ga(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);let p=-1,g=-1;return u.type!==0&&(p=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),g=a.indexOf(u.doc.key)),{type:Nb(u.type),doc:d,oldIndex:p,newIndex:g}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function Nb(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ge()}}class RC extends Ab{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new rn(this.firestore,null,n)}}function kb(t,e,n,...i){t=Jr(t,rn);const r=Jr(t.firestore,Vl),o=Fm(r);let a;return a=typeof(e=oi(e))=="string"||e instanceof Od?vb(o,"updateDoc",t._key,e,n,i):yb(o,"updateDoc",t._key,e),NC(r,[a.toMutation(t._key,ii.exists(!0))])}function Mb(t,e){const n=Jr(t.firestore,Vl),i=vC(t),r=Pb(t.converter,e);return NC(n,[_b(Fm(t.firestore),"addDoc",i._key,r,t.converter!==null,{}).toMutation(i._key,ii.exists(!1))]).then(()=>i)}function Lb(t,...e){var n,i,r;t=oi(t);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Xv(e[a])||(o=e[a],a++);const u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Xv(e[a])){const y=e[a];e[a]=(n=y.next)===null||n===void 0?void 0:n.bind(y),e[a+1]=(i=y.error)===null||i===void 0?void 0:i.bind(y),e[a+2]=(r=y.complete)===null||r===void 0?void 0:r.bind(y)}let d,p,g;if(t instanceof rn)p=Jr(t.firestore,Vl),g=ym(t._key.path),d={next:y=>{e[a]&&e[a](Db(p,t,y))},error:e[a+1],complete:e[a+2]};else{const y=Jr(t,wr);p=Jr(y.firestore,Vl),g=y._query;const T=new RC(p);d={next:I=>{e[a]&&e[a](new Rb(p,T,y,I))},error:e[a+1],complete:e[a+2]},Cb(t._query)}return function(T,I,V,b){const q=new sb(b),A=new qV(I,q,V);return T.asyncQueue.enqueueAndForget(async()=>UV(await $v(T),A)),()=>{q.Za(),T.asyncQueue.enqueueAndForget(async()=>OV(await $v(T),A))}}(TC(p),g,u,d)}function NC(t,e){return function(i,r){const o=new Kr;return i.asyncQueue.enqueueAndForget(async()=>XV(await ub(i),r,o)),o.promise}(TC(t),e)}function Db(t,e,n){const i=n.docs.get(e._key),r=new RC(t);return new PC(t,r,e._key,i,new Ga(n.hasPendingWrites,n.fromCache),e.converter)}function Vb(){return new Um("serverTimestamp")}function bb(t){return new Om("increment",t)}(function(e,n=!0){(function(r){Os=r})(p2),jc(new Il("firestore",(i,{instanceIdentifier:r,options:o})=>{const a=i.getProvider("app").getImmediate(),u=new Vl(new R2(i.getProvider("auth-internal")),new L2(i.getProvider("app-check-internal")),function(p,g){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new se(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pl(p.options.projectId,g)}(a,r),a);return o=Object.assign({useFetchStreams:n},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),fs(pv,"4.7.3",e),fs(pv,"4.7.3","esm2017")})();const Fb={apiKey:"YOUR_API_KEY",authDomain:"scb-hospital-navigation-app.firebaseapp.com",projectId:"scb-hospital-navigation-app",storageBucket:"scb-hospital-navigation-app.firebasestorage.app",messagingSenderId:"YOUR_SENDER_ID",appId:"YOUR_APP_ID"},Ub=ow(Fb),Zi=hb(Ub),Ob=({isOpen:t,onClose:e,language:n})=>{const i=Ls[n],[r,o]=ne.useState(""),[a,u]=ne.useState(""),[d,p]=ne.useState("moderate"),[g,y]=ne.useState(!1),[T,I]=ne.useState(!1),[V,b]=ne.useState(null);if(!t)return null;const q=()=>{const x=["Neon","Cyber","Solar","Rapid","Urban","Night","Swift","Metro","Campus"],R=["Scout","Rider","Guide","Pilot","Walker","Ranger","Drifter","Surfer","Navigator"],z=x[Math.floor(Math.random()*x.length)],W=R[Math.floor(Math.random()*R.length)],J=Math.floor(Math.random()*99)+1;return`${z} ${W} ${J}`},A=async x=>{x.preventDefault(),y(!0),b(null);try{if(!Zi)throw new Error("Community database is not connected. Please contact admin.");const R=`${a} at ${r}`,z=await JM(R,n);let W=sessionStorage.getItem("scb_user_alias");W||(W=q(),sessionStorage.setItem("scb_user_alias",W)),await Mb(yC(Zi,"reports"),{timestamp:Vb(),severity:d,location:r,description:z,originalText:a,reporterName:W,verificationCount:1}),I(!0),setTimeout(()=>{I(!1),o(""),u(""),p("moderate"),e()},1500)}catch(R){console.error("Failed to submit report",R),b("Could not submit report. Check connection.")}finally{y(!1)}};return C.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn",onClick:e,children:C.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 space-y-5",onClick:x=>x.stopPropagation(),children:[C.jsx("h3",{className:"text-xl font-bold text-blue-800 border-b border-slate-100 pb-3",children:i.reportHeader}),T?C.jsxs("div",{className:"text-center py-8",children:[C.jsx("div",{className:"text-green-500 text-6xl mb-4",children:""}),C.jsx("p",{className:"text-xl font-bold text-slate-800",children:i.reportSuccess})]}):C.jsxs("form",{onSubmit:A,className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:i.reportLocation}),C.jsx("input",{type:"text",value:r,onChange:x=>o(x.target.value),placeholder:i.reportLocationPlace,className:"w-full bg-slate-50 border border-slate-300 text-slate-900 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:i.reportSeverity}),C.jsxs("select",{value:d,onChange:x=>p(x.target.value),className:"w-full bg-slate-50 border border-slate-300 text-slate-900 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[C.jsx("option",{value:"light",children:i.sevLight}),C.jsx("option",{value:"moderate",children:i.sevModerate}),C.jsx("option",{value:"heavy",children:i.sevHeavy}),C.jsx("option",{value:"accident",children:i.sevAccident}),C.jsx("option",{value:"closure",children:i.sevClosure})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:i.reportDescLabel}),C.jsx("textarea",{value:a,onChange:x=>u(x.target.value),placeholder:i.reportDescPlace,rows:3,className:"w-full bg-slate-50 border border-slate-300 text-slate-900 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0})]}),V&&C.jsx("p",{className:"text-red-500 text-sm bg-red-50 p-2 rounded border border-red-100",children:V}),C.jsxs("div",{className:"flex justify-end space-x-3 pt-3",children:[C.jsx("button",{type:"button",onClick:e,className:"px-5 py-2.5 bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 font-semibold rounded-lg transition-colors",disabled:g,children:i.cancel}),C.jsxs("button",{type:"submit",disabled:g,className:"px-5 py-2.5 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg transition-colors flex items-center shadow-sm",children:[g&&C.jsx(TE,{}),C.jsx("span",{className:g?"ml-2":"",children:g?i.processingReport:i.submitReport})]})]})]})]})})},Va=({icon:t,title:e,description:n,onClick:i,disabled:r=!1})=>C.jsxs("button",{onClick:i,disabled:r,className:"bg-white border border-slate-200 p-5 rounded-xl shadow-sm flex items-center space-x-4 w-full text-left transition-all duration-200 hover:shadow-md hover:border-blue-300 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-60 disabled:cursor-not-allowed disabled:shadow-none disabled:bg-slate-100",children:[C.jsx("div",{className:`p-3 rounded-full ${r?"bg-slate-200 text-slate-400":"bg-blue-50 text-blue-600"}`,children:t}),C.jsxs("div",{children:[C.jsx("h3",{className:`font-bold text-lg ${r?"text-slate-500":"text-slate-800"}`,children:e}),C.jsx("p",{className:"text-sm text-slate-500 mt-1 leading-snug",children:n})]})]}),Bb=({setView:t,geoStatus:e,onShowInstructions:n,manualLocation:i,onEnterLocationManually:r,isScbContext:o,language:a})=>{const u=Ls[a],[d,p]=ne.useState(!1);return C.jsxs("div",{className:"animate-fadeIn space-y-6 max-w-lg mx-auto",children:[C.jsx(Ob,{isOpen:d,onClose:()=>p(!1),language:a}),C.jsxs("div",{className:"text-center p-6 bg-white border border-slate-200 rounded-2xl shadow-sm relative overflow-hidden",children:[C.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 to-cyan-400"}),C.jsx("button",{onClick:n,className:"absolute top-3 right-3 text-slate-400 hover:text-blue-600 transition-colors p-2","aria-label":"Show instructions",children:C.jsx(qx,{})}),C.jsx("h2",{className:"text-2xl font-extrabold text-slate-900",children:u.welcome}),C.jsx("p",{className:"text-slate-600 mt-2 font-medium",children:u.welcomeSub}),C.jsxs("div",{className:"mt-4 flex flex-col items-center justify-center text-sm font-medium",children:[e.loading&&!i&&C.jsx("span",{className:"flex items-center text-blue-600 bg-blue-50 px-3 py-1 rounded-full animate-pulse",children:u.gettingLocation}),e.error&&!i&&C.jsx("span",{className:"text-red-600 bg-red-50 px-3 py-1 rounded-full border border-red-100",children:e.error}),i&&C.jsxs("span",{className:"flex items-center text-green-700 bg-green-50 px-3 py-1 rounded-full border border-green-100",children:[C.jsx("span",{className:"mr-1",children:""})," ",u.manualLocationSet," ",C.jsx("strong",{children:i})]})]})]}),C.jsxs("div",{className:"space-y-4",children:[C.jsx(Va,{icon:C.jsx(_E,{}),title:u.planRouteTitle,description:o?u.planRouteDesc:u.planRouteDescScb,onClick:()=>t("planner"),disabled:e.loading&&!i||!o}),C.jsx(Va,{icon:C.jsx(yE,{}),title:u.localUpdatesTitle,description:i&&!o&&a==="en"?`Check for news in ${i}`:u.localUpdatesDesc,onClick:()=>t("updates"),disabled:e.loading&&!i}),C.jsx(Va,{icon:C.jsx(vE,{}),title:u.chatTitle,description:u.chatDesc,onClick:()=>t("chat")}),C.jsx("div",{className:"pt-2 border-t border-slate-200 my-4"}),C.jsx(Va,{icon:C.jsx(Hx,{}),title:u.setLocationTitle,description:u.setLocationDesc,onClick:r}),C.jsx(Va,{icon:C.jsx(em,{}),title:u.reportTitle,description:u.reportDesc,onClick:()=>p(!0)})]})]})};function kC(t,e){const n=ne.useRef(e);ne.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}function zb(t,e,n){e.center!==n.center&&t.setLatLng(e.center),e.radius!=null&&e.radius!==n.radius&&t.setRadius(e.radius)}const qb=1;function Hb(t){return Object.freeze({__version:qb,map:t})}function Zm(t,e){return Object.freeze({...t,...e})}const MC=ne.createContext(null),LC=MC.Provider;function zd(){const t=ne.useContext(MC);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function DC(t){function e(n,i){const{instance:r,context:o}=t(n).current;return ne.useImperativeHandle(i,()=>r),n.children==null?null:ms.createElement(LC,{value:o},n.children)}return ne.forwardRef(e)}function Gb(t){function e(n,i){const[r,o]=ne.useState(!1),{instance:a}=t(n,o).current;ne.useImperativeHandle(i,()=>a),ne.useEffect(function(){r&&a.update()},[a,r,n.children]);const u=a._contentNode;return u?gE.createPortal(n.children,u):null}return ne.forwardRef(e)}function Wb(t){function e(n,i){const{instance:r}=t(n).current;return ne.useImperativeHandle(i,()=>r),null}return ne.forwardRef(e)}function Ym(t,e){const n=ne.useRef();ne.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function qd(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function $b(t,e){return function(i,r){const o=zd(),a=t(qd(i,o),o);return kC(o.map,i.attribution),Ym(a.current,i.eventHandlers),e(a.current,o,i,r),a}}var rp={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,i){i(e)})(hI,function(n){var i="1.9.4";function r(s){var l,m,_,E;for(m=1,_=arguments.length;m<_;m++){E=arguments[m];for(l in E)s[l]=E[l]}return s}var o=Object.create||function(){function s(){}return function(l){return s.prototype=l,new s}}();function a(s,l){var m=Array.prototype.slice;if(s.bind)return s.bind.apply(s,m.call(arguments,1));var _=m.call(arguments,2);return function(){return s.apply(l,_.length?_.concat(m.call(arguments)):arguments)}}var u=0;function d(s){return"_leaflet_id"in s||(s._leaflet_id=++u),s._leaflet_id}function p(s,l,m){var _,E,S,O;return O=function(){_=!1,E&&(S.apply(m,E),E=!1)},S=function(){_?E=arguments:(s.apply(m,arguments),setTimeout(O,l),_=!0)},S}function g(s,l,m){var _=l[1],E=l[0],S=_-E;return s===_&&m?s:((s-E)%S+S)%S+E}function y(){return!1}function T(s,l){if(l===!1)return s;var m=Math.pow(10,l===void 0?6:l);return Math.round(s*m)/m}function I(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function V(s){return I(s).split(/\s+/)}function b(s,l){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?o(s.options):{});for(var m in l)s.options[m]=l[m];return s.options}function q(s,l,m){var _=[];for(var E in s)_.push(encodeURIComponent(m?E.toUpperCase():E)+"="+encodeURIComponent(s[E]));return(!l||l.indexOf("?")===-1?"?":"&")+_.join("&")}var A=/\{ *([\w_ -]+) *\}/g;function x(s,l){return s.replace(A,function(m,_){var E=l[_];if(E===void 0)throw new Error("No value provided for variable "+m);return typeof E=="function"&&(E=E(l)),E})}var R=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function z(s,l){for(var m=0;m<s.length;m++)if(s[m]===l)return m;return-1}var W="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function J(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var k=0;function N(s){var l=+new Date,m=Math.max(0,16-(l-k));return k=l+m,window.setTimeout(s,m)}var D=window.requestAnimationFrame||J("RequestAnimationFrame")||N,F=window.cancelAnimationFrame||J("CancelAnimationFrame")||J("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function B(s,l,m){if(m&&D===N)s.call(l);else return D.call(window,a(s,l))}function U(s){s&&F.call(window,s)}var M={__proto__:null,extend:r,create:o,bind:a,get lastId(){return u},stamp:d,throttle:p,wrapNum:g,falseFn:y,formatNum:T,trim:I,splitWords:V,setOptions:b,getParamString:q,template:x,isArray:R,indexOf:z,emptyImageUrl:W,requestFn:D,cancelFn:F,requestAnimFrame:B,cancelAnimFrame:U};function le(){}le.extend=function(s){var l=function(){b(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},m=l.__super__=this.prototype,_=o(m);_.constructor=l,l.prototype=_;for(var E in this)Object.prototype.hasOwnProperty.call(this,E)&&E!=="prototype"&&E!=="__super__"&&(l[E]=this[E]);return s.statics&&r(l,s.statics),s.includes&&(De(s.includes),r.apply(null,[_].concat(s.includes))),r(_,s),delete _.statics,delete _.includes,_.options&&(_.options=m.options?o(m.options):{},r(_.options,s.options)),_._initHooks=[],_.callInitHooks=function(){if(!this._initHooksCalled){m.callInitHooks&&m.callInitHooks.call(this),this._initHooksCalled=!0;for(var S=0,O=_._initHooks.length;S<O;S++)_._initHooks[S].call(this)}},l},le.include=function(s){var l=this.prototype.options;return r(this.prototype,s),s.options&&(this.prototype.options=l,this.mergeOptions(s.options)),this},le.mergeOptions=function(s){return r(this.prototype.options,s),this},le.addInitHook=function(s){var l=Array.prototype.slice.call(arguments,1),m=typeof s=="function"?s:function(){this[s].apply(this,l)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(m),this};function De(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=R(s)?s:[s];for(var l=0;l<s.length;l++)s[l]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var we={on:function(s,l,m){if(typeof s=="object")for(var _ in s)this._on(_,s[_],l);else{s=V(s);for(var E=0,S=s.length;E<S;E++)this._on(s[E],l,m)}return this},off:function(s,l,m){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var _ in s)this._off(_,s[_],l);else{s=V(s);for(var E=arguments.length===1,S=0,O=s.length;S<O;S++)E?this._off(s[S]):this._off(s[S],l,m)}return this},_on:function(s,l,m,_){if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}if(this._listens(s,l,m)===!1){m===this&&(m=void 0);var E={fn:l,ctx:m};_&&(E.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(E)}},_off:function(s,l,m){var _,E,S;if(this._events&&(_=this._events[s],!!_)){if(arguments.length===1){if(this._firingCount)for(E=0,S=_.length;E<S;E++)_[E].fn=y;delete this._events[s];return}if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}var O=this._listens(s,l,m);if(O!==!1){var G=_[O];this._firingCount&&(G.fn=y,this._events[s]=_=_.slice()),_.splice(O,1)}}},fire:function(s,l,m){if(!this.listens(s,m))return this;var _=r({},l,{type:s,target:this,sourceTarget:l&&l.sourceTarget||this});if(this._events){var E=this._events[s];if(E){this._firingCount=this._firingCount+1||1;for(var S=0,O=E.length;S<O;S++){var G=E[S],$=G.fn;G.once&&this.off(s,$,G.ctx),$.call(G.ctx||this,_)}this._firingCount--}}return m&&this._propagateEvent(_),this},listens:function(s,l,m,_){typeof s!="string"&&console.warn('"string" type argument expected');var E=l;typeof l!="function"&&(_=!!l,E=void 0,m=void 0);var S=this._events&&this._events[s];if(S&&S.length&&this._listens(s,E,m)!==!1)return!0;if(_){for(var O in this._eventParents)if(this._eventParents[O].listens(s,l,m,_))return!0}return!1},_listens:function(s,l,m){if(!this._events)return!1;var _=this._events[s]||[];if(!l)return!!_.length;m===this&&(m=void 0);for(var E=0,S=_.length;E<S;E++)if(_[E].fn===l&&_[E].ctx===m)return E;return!1},once:function(s,l,m){if(typeof s=="object")for(var _ in s)this._on(_,s[_],l,!0);else{s=V(s);for(var E=0,S=s.length;E<S;E++)this._on(s[E],l,m,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[d(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[d(s)],this},_propagateEvent:function(s){for(var l in this._eventParents)this._eventParents[l].fire(s.type,r({layer:s.target,propagatedFrom:s.target},s),!0)}};we.addEventListener=we.on,we.removeEventListener=we.clearAllEventListeners=we.off,we.addOneTimeEventListener=we.once,we.fireEvent=we.fire,we.hasEventListeners=we.listens;var Fe=le.extend(we);function Z(s,l,m){this.x=m?Math.round(s):s,this.y=m?Math.round(l):l}var fe=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};Z.prototype={clone:function(){return new Z(this.x,this.y)},add:function(s){return this.clone()._add(ee(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(ee(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new Z(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new Z(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=fe(this.x),this.y=fe(this.y),this},distanceTo:function(s){s=ee(s);var l=s.x-this.x,m=s.y-this.y;return Math.sqrt(l*l+m*m)},equals:function(s){return s=ee(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=ee(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+T(this.x)+", "+T(this.y)+")"}};function ee(s,l,m){return s instanceof Z?s:R(s)?new Z(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new Z(s.x,s.y):new Z(s,l,m)}function pe(s,l){if(s)for(var m=l?[s,l]:s,_=0,E=m.length;_<E;_++)this.extend(m[_])}pe.prototype={extend:function(s){var l,m;if(!s)return this;if(s instanceof Z||typeof s[0]=="number"||"x"in s)l=m=ee(s);else if(s=Ee(s),l=s.min,m=s.max,!l||!m)return this;return!this.min&&!this.max?(this.min=l.clone(),this.max=m.clone()):(this.min.x=Math.min(l.x,this.min.x),this.max.x=Math.max(m.x,this.max.x),this.min.y=Math.min(l.y,this.min.y),this.max.y=Math.max(m.y,this.max.y)),this},getCenter:function(s){return ee((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return ee(this.min.x,this.max.y)},getTopRight:function(){return ee(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var l,m;return typeof s[0]=="number"||s instanceof Z?s=ee(s):s=Ee(s),s instanceof pe?(l=s.min,m=s.max):l=m=s,l.x>=this.min.x&&m.x<=this.max.x&&l.y>=this.min.y&&m.y<=this.max.y},intersects:function(s){s=Ee(s);var l=this.min,m=this.max,_=s.min,E=s.max,S=E.x>=l.x&&_.x<=m.x,O=E.y>=l.y&&_.y<=m.y;return S&&O},overlaps:function(s){s=Ee(s);var l=this.min,m=this.max,_=s.min,E=s.max,S=E.x>l.x&&_.x<m.x,O=E.y>l.y&&_.y<m.y;return S&&O},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var l=this.min,m=this.max,_=Math.abs(l.x-m.x)*s,E=Math.abs(l.y-m.y)*s;return Ee(ee(l.x-_,l.y-E),ee(m.x+_,m.y+E))},equals:function(s){return s?(s=Ee(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function Ee(s,l){return!s||s instanceof pe?s:new pe(s,l)}function Ae(s,l){if(s)for(var m=l?[s,l]:s,_=0,E=m.length;_<E;_++)this.extend(m[_])}Ae.prototype={extend:function(s){var l=this._southWest,m=this._northEast,_,E;if(s instanceof Ce)_=s,E=s;else if(s instanceof Ae){if(_=s._southWest,E=s._northEast,!_||!E)return this}else return s?this.extend(_e(s)||Ue(s)):this;return!l&&!m?(this._southWest=new Ce(_.lat,_.lng),this._northEast=new Ce(E.lat,E.lng)):(l.lat=Math.min(_.lat,l.lat),l.lng=Math.min(_.lng,l.lng),m.lat=Math.max(E.lat,m.lat),m.lng=Math.max(E.lng,m.lng)),this},pad:function(s){var l=this._southWest,m=this._northEast,_=Math.abs(l.lat-m.lat)*s,E=Math.abs(l.lng-m.lng)*s;return new Ae(new Ce(l.lat-_,l.lng-E),new Ce(m.lat+_,m.lng+E))},getCenter:function(){return new Ce((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ce(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ce(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Ce||"lat"in s?s=_e(s):s=Ue(s);var l=this._southWest,m=this._northEast,_,E;return s instanceof Ae?(_=s.getSouthWest(),E=s.getNorthEast()):_=E=s,_.lat>=l.lat&&E.lat<=m.lat&&_.lng>=l.lng&&E.lng<=m.lng},intersects:function(s){s=Ue(s);var l=this._southWest,m=this._northEast,_=s.getSouthWest(),E=s.getNorthEast(),S=E.lat>=l.lat&&_.lat<=m.lat,O=E.lng>=l.lng&&_.lng<=m.lng;return S&&O},overlaps:function(s){s=Ue(s);var l=this._southWest,m=this._northEast,_=s.getSouthWest(),E=s.getNorthEast(),S=E.lat>l.lat&&_.lat<m.lat,O=E.lng>l.lng&&_.lng<m.lng;return S&&O},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,l){return s?(s=Ue(s),this._southWest.equals(s.getSouthWest(),l)&&this._northEast.equals(s.getNorthEast(),l)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ue(s,l){return s instanceof Ae?s:new Ae(s,l)}function Ce(s,l,m){if(isNaN(s)||isNaN(l))throw new Error("Invalid LatLng object: ("+s+", "+l+")");this.lat=+s,this.lng=+l,m!==void 0&&(this.alt=+m)}Ce.prototype={equals:function(s,l){if(!s)return!1;s=_e(s);var m=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return m<=(l===void 0?1e-9:l)},toString:function(s){return"LatLng("+T(this.lat,s)+", "+T(this.lng,s)+")"},distanceTo:function(s){return $n.distance(this,_e(s))},wrap:function(){return $n.wrapLatLng(this)},toBounds:function(s){var l=180*s/40075017,m=l/Math.cos(Math.PI/180*this.lat);return Ue([this.lat-l,this.lng-m],[this.lat+l,this.lng+m])},clone:function(){return new Ce(this.lat,this.lng,this.alt)}};function _e(s,l,m){return s instanceof Ce?s:R(s)&&typeof s[0]!="object"?s.length===3?new Ce(s[0],s[1],s[2]):s.length===2?new Ce(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Ce(s.lat,"lng"in s?s.lng:s.lon,s.alt):l===void 0?null:new Ce(s,l,m)}var _t={latLngToPoint:function(s,l){var m=this.projection.project(s),_=this.scale(l);return this.transformation._transform(m,_)},pointToLatLng:function(s,l){var m=this.scale(l),_=this.transformation.untransform(s,m);return this.projection.unproject(_)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var l=this.projection.bounds,m=this.scale(s),_=this.transformation.transform(l.min,m),E=this.transformation.transform(l.max,m);return new pe(_,E)},infinite:!1,wrapLatLng:function(s){var l=this.wrapLng?g(s.lng,this.wrapLng,!0):s.lng,m=this.wrapLat?g(s.lat,this.wrapLat,!0):s.lat,_=s.alt;return new Ce(m,l,_)},wrapLatLngBounds:function(s){var l=s.getCenter(),m=this.wrapLatLng(l),_=l.lat-m.lat,E=l.lng-m.lng;if(_===0&&E===0)return s;var S=s.getSouthWest(),O=s.getNorthEast(),G=new Ce(S.lat-_,S.lng-E),$=new Ce(O.lat-_,O.lng-E);return new Ae(G,$)}},$n=r({},_t,{wrapLng:[-180,180],R:6371e3,distance:function(s,l){var m=Math.PI/180,_=s.lat*m,E=l.lat*m,S=Math.sin((l.lat-s.lat)*m/2),O=Math.sin((l.lng-s.lng)*m/2),G=S*S+Math.cos(_)*Math.cos(E)*O*O,$=2*Math.atan2(Math.sqrt(G),Math.sqrt(1-G));return this.R*$}}),Xl=6378137,Vi={R:Xl,MAX_LATITUDE:85.0511287798,project:function(s){var l=Math.PI/180,m=this.MAX_LATITUDE,_=Math.max(Math.min(m,s.lat),-m),E=Math.sin(_*l);return new Z(this.R*s.lng*l,this.R*Math.log((1+E)/(1-E))/2)},unproject:function(s){var l=180/Math.PI;return new Ce((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*l,s.x*l/this.R)},bounds:function(){var s=Xl*Math.PI;return new pe([-s,-s],[s,s])}()};function bi(s,l,m,_){if(R(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=l,this._c=m,this._d=_}bi.prototype={transform:function(s,l){return this._transform(s.clone(),l)},_transform:function(s,l){return l=l||1,s.x=l*(this._a*s.x+this._b),s.y=l*(this._c*s.y+this._d),s},untransform:function(s,l){return l=l||1,new Z((s.x/l-this._b)/this._a,(s.y/l-this._d)/this._c)}};function ai(s,l,m,_){return new bi(s,l,m,_)}var Cr=r({},$n,{code:"EPSG:3857",projection:Vi,transformation:function(){var s=.5/(Math.PI*Vi.R);return ai(s,.5,-s,.5)}()}),Hs=r({},Cr,{code:"EPSG:900913"});function uo(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Gs(s,l){var m="",_,E,S,O,G,$;for(_=0,S=s.length;_<S;_++){for(G=s[_],E=0,O=G.length;E<O;E++)$=G[E],m+=(E?"L":"M")+$.x+" "+$.y;m+=l?ue.svg?"z":"x":""}return m||"M0 0"}var Ws=document.documentElement.style,co="ActiveXObject"in window,jl=co&&!document.addEventListener,ho="msLaunchUri"in navigator&&!("documentMode"in document),fo=mn("webkit"),eu=mn("android"),po=mn("android 2")||mn("android 3"),$s=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),tu=eu&&mn("Google")&&$s<537&&!("AudioNode"in window),dt=!!window.opera,Et=!ho&&mn("chrome"),Ir=mn("gecko")&&!fo&&!dt&&!co,nu=!Et&&mn("safari"),Ks=mn("phantom"),iu="OTransition"in Ws,Sr=navigator.platform.indexOf("Win")===0,Js=co&&"transition"in Ws,mo="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!po,go="MozPerspective"in Ws,Gd=!window.L_DISABLE_3D&&(Js||mo||go)&&!iu&&!Ks,xr=typeof orientation<"u"||mn("mobile"),Zs=xr&&fo,ru=xr&&mo,Ys=!window.PointerEvent&&window.MSPointerEvent,Fi=!!(window.PointerEvent||Ys),_o="ontouchstart"in window||!!window.TouchEvent,Qs=!window.L_NO_TOUCH&&(_o||Fi),li=xr&&dt,ou=xr&&Ir,yo=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,su=function(){var s=!1;try{var l=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",y,l),window.removeEventListener("testPassiveEventSupport",y,l)}catch{}return s}(),Ar=function(){return!!document.createElement("canvas").getContext}(),vo=!!(document.createElementNS&&uo("svg").createSVGRect),At=!!vo&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),au=!vo&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var l=s.firstChild;return l.style.behavior="url(#default#VML)",l&&typeof l.adj=="object"}catch{return!1}}(),Pr=navigator.platform.indexOf("Mac")===0,Rr=navigator.platform.indexOf("Linux")===0;function mn(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var ue={ie:co,ielt9:jl,edge:ho,webkit:fo,android:eu,android23:po,androidStock:tu,opera:dt,chrome:Et,gecko:Ir,safari:nu,phantom:Ks,opera12:iu,win:Sr,ie3d:Js,webkit3d:mo,gecko3d:go,any3d:Gd,mobile:xr,mobileWebkit:Zs,mobileWebkit3d:ru,msPointer:Ys,pointer:Fi,touch:Qs,touchNative:_o,mobileOpera:li,mobileGecko:ou,retina:yo,passiveEvents:su,canvas:Ar,svg:vo,vml:au,inlineSvg:At,mac:Pr,linux:Rr},ui=ue.msPointer?"MSPointerDown":"pointerdown",lu=ue.msPointer?"MSPointerMove":"pointermove",uu=ue.msPointer?"MSPointerUp":"pointerup",Nr=ue.msPointer?"MSPointerCancel":"pointercancel",To={touchstart:ui,touchmove:lu,touchend:uu,touchcancel:Nr},Eo={touchstart:Co,touchmove:wo,touchend:wo,touchcancel:wo},kn={},Mn=!1;function cu(s,l,m){return l==="touchstart"&&hu(),Eo[l]?(m=Eo[l].bind(this,m),s.addEventListener(To[l],m,!1),m):(console.warn("wrong event specified:",l),y)}function du(s,l,m){if(!To[l]){console.warn("wrong event specified:",l);return}s.removeEventListener(To[l],m,!1)}function Xs(s){kn[s.pointerId]=s}function js(s){kn[s.pointerId]&&(kn[s.pointerId]=s)}function ea(s){delete kn[s.pointerId]}function hu(){Mn||(document.addEventListener(ui,Xs,!0),document.addEventListener(lu,js,!0),document.addEventListener(uu,ea,!0),document.addEventListener(Nr,ea,!0),Mn=!0)}function wo(s,l){if(l.pointerType!==(l.MSPOINTER_TYPE_MOUSE||"mouse")){l.touches=[];for(var m in kn)l.touches.push(kn[m]);l.changedTouches=[l],s(l)}}function Co(s,l){l.MSPOINTER_TYPE_TOUCH&&l.pointerType===l.MSPOINTER_TYPE_TOUCH&&et(l),wo(s,l)}function fu(s){var l={},m,_;for(_ in s)m=s[_],l[_]=m&&m.bind?m.bind(s):m;return s=l,l.type="dblclick",l.detail=2,l.isTrusted=!1,l._simulated=!0,l}var ta=200;function kr(s,l){s.addEventListener("dblclick",l);var m=0,_;function E(S){if(S.detail!==1){_=S.detail;return}if(!(S.pointerType==="mouse"||S.sourceCapabilities&&!S.sourceCapabilities.firesTouchEvents)){var O=fa(S);if(!(O.some(function($){return $ instanceof HTMLLabelElement&&$.attributes.for})&&!O.some(function($){return $ instanceof HTMLInputElement||$ instanceof HTMLSelectElement}))){var G=Date.now();G-m<=ta?(_++,_===2&&l(fu(S))):_=1,m=G}}}return s.addEventListener("click",E),{dblclick:l,simDblclick:E}}function ci(s,l){s.removeEventListener("dblclick",l.dblclick),s.removeEventListener("click",l.simDblclick)}var Mr=hi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Lr=hi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),na=Lr==="webkitTransition"||Lr==="OTransition"?Lr+"End":"transitionend";function ia(s){return typeof s=="string"?document.getElementById(s):s}function Ui(s,l){var m=s.style[l]||s.currentStyle&&s.currentStyle[l];if((!m||m==="auto")&&document.defaultView){var _=document.defaultView.getComputedStyle(s,null);m=_?_[l]:null}return m==="auto"?null:m}function Pe(s,l,m){var _=document.createElement(s);return _.className=l||"",m&&m.appendChild(_),_}function Ge(s){var l=s.parentNode;l&&l.removeChild(s)}function Dr(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function di(s){var l=s.parentNode;l&&l.lastChild!==s&&l.appendChild(s)}function Oi(s){var l=s.parentNode;l&&l.firstChild!==s&&l.insertBefore(s,l.firstChild)}function ra(s,l){if(s.classList!==void 0)return s.classList.contains(l);var m=gn(s);return m.length>0&&new RegExp("(^|\\s)"+l+"(\\s|$)").test(m)}function Te(s,l){if(s.classList!==void 0)for(var m=V(l),_=0,E=m.length;_<E;_++)s.classList.add(m[_]);else if(!ra(s,l)){var S=gn(s);oa(s,(S?S+" ":"")+l)}}function Qe(s,l){s.classList!==void 0?s.classList.remove(l):oa(s,I((" "+gn(s)+" ").replace(" "+l+" "," ")))}function oa(s,l){s.className.baseVal===void 0?s.className=l:s.className.baseVal=l}function gn(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function st(s,l){"opacity"in s.style?s.style.opacity=l:"filter"in s.style&&Io(s,l)}function Io(s,l){var m=!1,_="DXImageTransform.Microsoft.Alpha";try{m=s.filters.item(_)}catch{if(l===1)return}l=Math.round(l*100),m?(m.Enabled=l!==100,m.Opacity=l):s.style.filter+=" progid:"+_+"(opacity="+l+")"}function hi(s){for(var l=document.documentElement.style,m=0;m<s.length;m++)if(s[m]in l)return s[m];return!1}function Kn(s,l,m){var _=l||new Z(0,0);s.style[Mr]=(ue.ie3d?"translate("+_.x+"px,"+_.y+"px)":"translate3d("+_.x+"px,"+_.y+"px,0)")+(m?" scale("+m+")":"")}function me(s,l){s._leaflet_pos=l,ue.any3d?Kn(s,l):(s.style.left=l.x+"px",s.style.top=l.y+"px")}function _n(s){return s._leaflet_pos||new Z(0,0)}var Ln,Dn,sa;if("onselectstart"in document)Ln=function(){de(window,"selectstart",et)},Dn=function(){qe(window,"selectstart",et)};else{var Bi=hi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ln=function(){if(Bi){var s=document.documentElement.style;sa=s[Bi],s[Bi]="none"}},Dn=function(){Bi&&(document.documentElement.style[Bi]=sa,sa=void 0)}}function aa(){de(window,"dragstart",et)}function la(){qe(window,"dragstart",et)}var So,ua;function fi(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(on(),So=s,ua=s.style.outlineStyle,s.style.outlineStyle="none",de(window,"keydown",on))}function on(){So&&(So.style.outlineStyle=ua,So=void 0,ua=void 0,qe(window,"keydown",on))}function ca(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function xo(s){var l=s.getBoundingClientRect();return{x:l.width/s.offsetWidth||1,y:l.height/s.offsetHeight||1,boundingClientRect:l}}var pu={__proto__:null,TRANSFORM:Mr,TRANSITION:Lr,TRANSITION_END:na,get:ia,getStyle:Ui,create:Pe,remove:Ge,empty:Dr,toFront:di,toBack:Oi,hasClass:ra,addClass:Te,removeClass:Qe,setClass:oa,getClass:gn,setOpacity:st,testProp:hi,setTransform:Kn,setPosition:me,getPosition:_n,get disableTextSelection(){return Ln},get enableTextSelection(){return Dn},disableImageDrag:aa,enableImageDrag:la,preventOutline:fi,restoreOutline:on,getSizedParentNode:ca,getScale:xo};function de(s,l,m,_){if(l&&typeof l=="object")for(var E in l)da(s,E,l[E],m);else{l=V(l);for(var S=0,O=l.length;S<O;S++)da(s,l[S],m,_)}return this}var yn="_leaflet_events";function qe(s,l,m,_){if(arguments.length===1)mu(s),delete s[yn];else if(l&&typeof l=="object")for(var E in l)ha(s,E,l[E],m);else if(l=V(l),arguments.length===2)mu(s,function(G){return z(l,G)!==-1});else for(var S=0,O=l.length;S<O;S++)ha(s,l[S],m,_);return this}function mu(s,l){for(var m in s[yn]){var _=m.split(/\d/)[0];(!l||l(_))&&ha(s,_,null,null,m)}}var vn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function da(s,l,m,_){var E=l+d(m)+(_?"_"+d(_):"");if(s[yn]&&s[yn][E])return this;var S=function(G){return m.call(_||s,G||window.event)},O=S;!ue.touchNative&&ue.pointer&&l.indexOf("touch")===0?S=cu(s,l,S):ue.touch&&l==="dblclick"?S=kr(s,S):"addEventListener"in s?l==="touchstart"||l==="touchmove"||l==="wheel"||l==="mousewheel"?s.addEventListener(vn[l]||l,S,ue.passiveEvents?{passive:!1}:!1):l==="mouseenter"||l==="mouseleave"?(S=function(G){G=G||window.event,pa(s,G)&&O(G)},s.addEventListener(vn[l],S,!1)):s.addEventListener(l,O,!1):s.attachEvent("on"+l,S),s[yn]=s[yn]||{},s[yn][E]=S}function ha(s,l,m,_,E){E=E||l+d(m)+(_?"_"+d(_):"");var S=s[yn]&&s[yn][E];if(!S)return this;!ue.touchNative&&ue.pointer&&l.indexOf("touch")===0?du(s,l,S):ue.touch&&l==="dblclick"?ci(s,S):"removeEventListener"in s?s.removeEventListener(vn[l]||l,S,!1):s.detachEvent("on"+l,S),s[yn][E]=null}function Tn(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function zi(s){return da(s,"wheel",Tn),this}function qi(s){return de(s,"mousedown touchstart dblclick contextmenu",Tn),s._leaflet_disable_click=!0,this}function et(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function sn(s){return et(s),Tn(s),this}function fa(s){if(s.composedPath)return s.composedPath();for(var l=[],m=s.target;m;)l.push(m),m=m.parentNode;return l}function Ao(s,l){if(!l)return new Z(s.clientX,s.clientY);var m=xo(l),_=m.boundingClientRect;return new Z((s.clientX-_.left)/m.x-l.clientLeft,(s.clientY-_.top)/m.y-l.clientTop)}var Xe=ue.linux&&ue.chrome?window.devicePixelRatio:ue.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function gu(s){return ue.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/Xe:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function pa(s,l){var m=l.relatedTarget;if(!m)return!0;try{for(;m&&m!==s;)m=m.parentNode}catch{return!1}return m!==s}var _u={__proto__:null,on:de,off:qe,stopPropagation:Tn,disableScrollPropagation:zi,disableClickPropagation:qi,preventDefault:et,stop:sn,getPropagationPath:fa,getMousePosition:Ao,getWheelDelta:gu,isExternalTarget:pa,addListener:de,removeListener:qe},ma=Fe.extend({run:function(s,l,m,_){this.stop(),this._el=s,this._inProgress=!0,this._duration=m||.25,this._easeOutPower=1/Math.max(_||.5,.2),this._startPos=_n(s),this._offset=l.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=B(this._animate,this),this._step()},_step:function(s){var l=+new Date-this._startTime,m=this._duration*1e3;l<m?this._runFrame(this._easeOut(l/m),s):(this._runFrame(1),this._complete())},_runFrame:function(s,l){var m=this._startPos.add(this._offset.multiplyBy(s));l&&m._round(),me(this._el,m),this.fire("step")},_complete:function(){U(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Se=Fe.extend({options:{crs:Cr,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,l){l=b(this,l),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),l.maxBounds&&this.setMaxBounds(l.maxBounds),l.zoom!==void 0&&(this._zoom=this._limitZoom(l.zoom)),l.center&&l.zoom!==void 0&&this.setView(_e(l.center),l.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Lr&&ue.any3d&&!ue.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),de(this._proxy,na,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,l,m){if(l=l===void 0?this._zoom:this._limitZoom(l),s=this._limitCenter(_e(s),l,this.options.maxBounds),m=m||{},this._stop(),this._loaded&&!m.reset&&m!==!0){m.animate!==void 0&&(m.zoom=r({animate:m.animate},m.zoom),m.pan=r({animate:m.animate,duration:m.duration},m.pan));var _=this._zoom!==l?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,l,m.zoom):this._tryAnimatedPan(s,m.pan);if(_)return clearTimeout(this._sizeTimer),this}return this._resetView(s,l,m.pan&&m.pan.noMoveStart),this},setZoom:function(s,l){return this._loaded?this.setView(this.getCenter(),s,{zoom:l}):(this._zoom=s,this)},zoomIn:function(s,l){return s=s||(ue.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,l)},zoomOut:function(s,l){return s=s||(ue.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,l)},setZoomAround:function(s,l,m){var _=this.getZoomScale(l),E=this.getSize().divideBy(2),S=s instanceof Z?s:this.latLngToContainerPoint(s),O=S.subtract(E).multiplyBy(1-1/_),G=this.containerPointToLatLng(E.add(O));return this.setView(G,l,{zoom:m})},_getBoundsCenterZoom:function(s,l){l=l||{},s=s.getBounds?s.getBounds():Ue(s);var m=ee(l.paddingTopLeft||l.padding||[0,0]),_=ee(l.paddingBottomRight||l.padding||[0,0]),E=this.getBoundsZoom(s,!1,m.add(_));if(E=typeof l.maxZoom=="number"?Math.min(l.maxZoom,E):E,E===1/0)return{center:s.getCenter(),zoom:E};var S=_.subtract(m).divideBy(2),O=this.project(s.getSouthWest(),E),G=this.project(s.getNorthEast(),E),$=this.unproject(O.add(G).divideBy(2).add(S),E);return{center:$,zoom:E}},fitBounds:function(s,l){if(s=Ue(s),!s.isValid())throw new Error("Bounds are not valid.");var m=this._getBoundsCenterZoom(s,l);return this.setView(m.center,m.zoom,l)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,l){return this.setView(s,this._zoom,{pan:l})},panBy:function(s,l){if(s=ee(s).round(),l=l||{},!s.x&&!s.y)return this.fire("moveend");if(l.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ma,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),l.noMoveStart||this.fire("movestart"),l.animate!==!1){Te(this._mapPane,"leaflet-pan-anim");var m=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,m,l.duration||.25,l.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,l,m){if(m=m||{},m.animate===!1||!ue.any3d)return this.setView(s,l,m);this._stop();var _=this.project(this.getCenter()),E=this.project(s),S=this.getSize(),O=this._zoom;s=_e(s),l=l===void 0?O:l;var G=Math.max(S.x,S.y),$=G*this.getZoomScale(O,l),Q=E.distanceTo(_)||1,re=1.42,he=re*re;function Ie(ft){var Lu=ft?-1:1,lI=ft?$:G,uI=$*$-G*G+Lu*he*he*Q*Q,cI=2*lI*he*Q,Qd=uI/cI,yg=Math.sqrt(Qd*Qd+1)-Qd,dI=yg<1e-9?-18:Math.log(yg);return dI}function Gt(ft){return(Math.exp(ft)-Math.exp(-ft))/2}function Ct(ft){return(Math.exp(ft)+Math.exp(-ft))/2}function wn(ft){return Gt(ft)/Ct(ft)}var Yt=Ie(0);function Bo(ft){return G*(Ct(Yt)/Ct(Yt+re*ft))}function rI(ft){return G*(Ct(Yt)*wn(Yt+re*ft)-Gt(Yt))/he}function oI(ft){return 1-Math.pow(1-ft,1.5)}var sI=Date.now(),gg=(Ie(1)-Yt)/re,aI=m.duration?1e3*m.duration:1e3*gg*.8;function _g(){var ft=(Date.now()-sI)/aI,Lu=oI(ft)*gg;ft<=1?(this._flyToFrame=B(_g,this),this._move(this.unproject(_.add(E.subtract(_).multiplyBy(rI(Lu)/Q)),O),this.getScaleZoom(G/Bo(Lu),O),{flyTo:!0})):this._move(s,l)._moveEnd(!0)}return this._moveStart(!0,m.noMoveStart),_g.call(this),this},flyToBounds:function(s,l){var m=this._getBoundsCenterZoom(s,l);return this.flyTo(m.center,m.zoom,l)},setMaxBounds:function(s){return s=Ue(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var l=this.options.minZoom;return this.options.minZoom=s,this._loaded&&l!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var l=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&l!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,l){this._enforcingBounds=!0;var m=this.getCenter(),_=this._limitCenter(m,this._zoom,Ue(s));return m.equals(_)||this.panTo(_,l),this._enforcingBounds=!1,this},panInside:function(s,l){l=l||{};var m=ee(l.paddingTopLeft||l.padding||[0,0]),_=ee(l.paddingBottomRight||l.padding||[0,0]),E=this.project(this.getCenter()),S=this.project(s),O=this.getPixelBounds(),G=Ee([O.min.add(m),O.max.subtract(_)]),$=G.getSize();if(!G.contains(S)){this._enforcingBounds=!0;var Q=S.subtract(G.getCenter()),re=G.extend(S).getSize().subtract($);E.x+=Q.x<0?-re.x:re.x,E.y+=Q.y<0?-re.y:re.y,this.panTo(this.unproject(E),l),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=r({animate:!1,pan:!0},s===!0?{animate:!0}:s);var l=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var m=this.getSize(),_=l.divideBy(2).round(),E=m.divideBy(2).round(),S=_.subtract(E);return!S.x&&!S.y?this:(s.animate&&s.pan?this.panBy(S):(s.pan&&this._rawPanBy(S),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:l,newSize:m}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=r({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var l=a(this._handleGeolocationResponse,this),m=a(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(l,m,s):navigator.geolocation.getCurrentPosition(l,m,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var l=s.code,m=s.message||(l===1?"permission denied":l===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:l,message:"Geolocation error: "+m+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var l=s.coords.latitude,m=s.coords.longitude,_=new Ce(l,m),E=_.toBounds(s.coords.accuracy*2),S=this._locateOptions;if(S.setView){var O=this.getBoundsZoom(E);this.setView(_,S.maxZoom?Math.min(O,S.maxZoom):O)}var G={latlng:_,bounds:E,timestamp:s.timestamp};for(var $ in s.coords)typeof s.coords[$]=="number"&&(G[$]=s.coords[$]);this.fire("locationfound",G)}},addHandler:function(s,l){if(!l)return this;var m=this[s]=new l(this);return this._handlers.push(m),this.options[s]&&m.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Ge(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(U(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)Ge(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,l){var m="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),_=Pe("div",m,l||this._mapPane);return s&&(this._panes[s]=_),_},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),l=this.unproject(s.getBottomLeft()),m=this.unproject(s.getTopRight());return new Ae(l,m)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,l,m){s=Ue(s),m=ee(m||[0,0]);var _=this.getZoom()||0,E=this.getMinZoom(),S=this.getMaxZoom(),O=s.getNorthWest(),G=s.getSouthEast(),$=this.getSize().subtract(m),Q=Ee(this.project(G,_),this.project(O,_)).getSize(),re=ue.any3d?this.options.zoomSnap:1,he=$.x/Q.x,Ie=$.y/Q.y,Gt=l?Math.max(he,Ie):Math.min(he,Ie);return _=this.getScaleZoom(Gt,_),re&&(_=Math.round(_/(re/100))*(re/100),_=l?Math.ceil(_/re)*re:Math.floor(_/re)*re),Math.max(E,Math.min(S,_))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Z(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,l){var m=this._getTopLeftPoint(s,l);return new pe(m,m.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,l){var m=this.options.crs;return l=l===void 0?this._zoom:l,m.scale(s)/m.scale(l)},getScaleZoom:function(s,l){var m=this.options.crs;l=l===void 0?this._zoom:l;var _=m.zoom(s*m.scale(l));return isNaN(_)?1/0:_},project:function(s,l){return l=l===void 0?this._zoom:l,this.options.crs.latLngToPoint(_e(s),l)},unproject:function(s,l){return l=l===void 0?this._zoom:l,this.options.crs.pointToLatLng(ee(s),l)},layerPointToLatLng:function(s){var l=ee(s).add(this.getPixelOrigin());return this.unproject(l)},latLngToLayerPoint:function(s){var l=this.project(_e(s))._round();return l._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(_e(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(Ue(s))},distance:function(s,l){return this.options.crs.distance(_e(s),_e(l))},containerPointToLayerPoint:function(s){return ee(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return ee(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var l=this.containerPointToLayerPoint(ee(s));return this.layerPointToLatLng(l)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(_e(s)))},mouseEventToContainerPoint:function(s){return Ao(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var l=this._container=ia(s);if(l){if(l._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");de(l,"scroll",this._onScroll,this),this._containerId=d(l)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&ue.any3d,Te(s,"leaflet-container"+(ue.touch?" leaflet-touch":"")+(ue.retina?" leaflet-retina":"")+(ue.ielt9?" leaflet-oldie":"")+(ue.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var l=Ui(s,"position");l!=="absolute"&&l!=="relative"&&l!=="fixed"&&l!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),me(this._mapPane,new Z(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Te(s.markerPane,"leaflet-zoom-hide"),Te(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,l,m){me(this._mapPane,new Z(0,0));var _=!this._loaded;this._loaded=!0,l=this._limitZoom(l),this.fire("viewprereset");var E=this._zoom!==l;this._moveStart(E,m)._move(s,l)._moveEnd(E),this.fire("viewreset"),_&&this.fire("load")},_moveStart:function(s,l){return s&&this.fire("zoomstart"),l||this.fire("movestart"),this},_move:function(s,l,m,_){l===void 0&&(l=this._zoom);var E=this._zoom!==l;return this._zoom=l,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),_?m&&m.pinch&&this.fire("zoom",m):((E||m&&m.pinch)&&this.fire("zoom",m),this.fire("move",m)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return U(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){me(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[d(this._container)]=this;var l=s?qe:de;l(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&l(window,"resize",this._onResize,this),ue.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){U(this._resizeRequest),this._resizeRequest=B(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,l){for(var m=[],_,E=l==="mouseout"||l==="mouseover",S=s.target||s.srcElement,O=!1;S;){if(_=this._targets[d(S)],_&&(l==="click"||l==="preclick")&&this._draggableMoved(_)){O=!0;break}if(_&&_.listens(l,!0)&&(E&&!pa(S,s)||(m.push(_),E))||S===this._container)break;S=S.parentNode}return!m.length&&!O&&!E&&this.listens(l,!0)&&(m=[this]),m},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var l=s.target||s.srcElement;if(!(!this._loaded||l._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(l))){var m=s.type;m==="mousedown"&&fi(l),this._fireDOMEvent(s,m)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,l,m){if(s.type==="click"){var _=r({},s);_.type="preclick",this._fireDOMEvent(_,_.type,m)}var E=this._findEventTargets(s,l);if(m){for(var S=[],O=0;O<m.length;O++)m[O].listens(l,!0)&&S.push(m[O]);E=S.concat(E)}if(E.length){l==="contextmenu"&&et(s);var G=E[0],$={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var Q=G.getLatLng&&(!G._radius||G._radius<=10);$.containerPoint=Q?this.latLngToContainerPoint(G.getLatLng()):this.mouseEventToContainerPoint(s),$.layerPoint=this.containerPointToLayerPoint($.containerPoint),$.latlng=Q?G.getLatLng():this.layerPointToLatLng($.layerPoint)}for(O=0;O<E.length;O++)if(E[O].fire(l,$,!0),$.originalEvent._stopped||E[O].options.bubblingMouseEvents===!1&&z(this._mouseEvents,l)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,l=this._handlers.length;s<l;s++)this._handlers[s].disable()},whenReady:function(s,l){return this._loaded?s.call(l||this,{target:this}):this.on("load",s,l),this},_getMapPanePos:function(){return _n(this._mapPane)||new Z(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,l){var m=s&&l!==void 0?this._getNewPixelOrigin(s,l):this.getPixelOrigin();return m.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,l){var m=this.getSize()._divideBy(2);return this.project(s,l)._subtract(m)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,l,m){var _=this._getNewPixelOrigin(m,l);return this.project(s,l)._subtract(_)},_latLngBoundsToNewLayerBounds:function(s,l,m){var _=this._getNewPixelOrigin(m,l);return Ee([this.project(s.getSouthWest(),l)._subtract(_),this.project(s.getNorthWest(),l)._subtract(_),this.project(s.getSouthEast(),l)._subtract(_),this.project(s.getNorthEast(),l)._subtract(_)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,l,m){if(!m)return s;var _=this.project(s,l),E=this.getSize().divideBy(2),S=new pe(_.subtract(E),_.add(E)),O=this._getBoundsOffset(S,m,l);return Math.abs(O.x)<=1&&Math.abs(O.y)<=1?s:this.unproject(_.add(O),l)},_limitOffset:function(s,l){if(!l)return s;var m=this.getPixelBounds(),_=new pe(m.min.add(s),m.max.add(s));return s.add(this._getBoundsOffset(_,l))},_getBoundsOffset:function(s,l,m){var _=Ee(this.project(l.getNorthEast(),m),this.project(l.getSouthWest(),m)),E=_.min.subtract(s.min),S=_.max.subtract(s.max),O=this._rebound(E.x,-S.x),G=this._rebound(E.y,-S.y);return new Z(O,G)},_rebound:function(s,l){return s+l>0?Math.round(s-l)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(l))},_limitZoom:function(s){var l=this.getMinZoom(),m=this.getMaxZoom(),_=ue.any3d?this.options.zoomSnap:1;return _&&(s=Math.round(s/_)*_),Math.max(l,Math.min(m,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Qe(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,l){var m=this._getCenterOffset(s)._trunc();return(l&&l.animate)!==!0&&!this.getSize().contains(m)?!1:(this.panBy(m,l),!0)},_createAnimProxy:function(){var s=this._proxy=Pe("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(l){var m=Mr,_=this._proxy.style[m];Kn(this._proxy,this.project(l.center,l.zoom),this.getZoomScale(l.zoom,1)),_===this._proxy.style[m]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Ge(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),l=this.getZoom();Kn(this._proxy,this.project(s,l),this.getZoomScale(l,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,l,m){if(this._animatingZoom)return!0;if(m=m||{},!this._zoomAnimated||m.animate===!1||this._nothingToAnimate()||Math.abs(l-this._zoom)>this.options.zoomAnimationThreshold)return!1;var _=this.getZoomScale(l),E=this._getCenterOffset(s)._divideBy(1-1/_);return m.animate!==!0&&!this.getSize().contains(E)?!1:(B(function(){this._moveStart(!0,m.noMoveStart||!1)._animateZoom(s,l,!0)},this),!0)},_animateZoom:function(s,l,m,_){this._mapPane&&(m&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=l,Te(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:l,noUpdate:_}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Qe(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Po(s,l){return new Se(s,l)}var Zt=le.extend({options:{position:"topright"},initialize:function(s){b(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var l=this._map;return l&&l.removeControl(this),this.options.position=s,l&&l.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var l=this._container=this.onAdd(s),m=this.getPosition(),_=s._controlCorners[m];return Te(l,"leaflet-control"),m.indexOf("bottom")!==-1?_.insertBefore(l,_.firstChild):_.appendChild(l),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Ge(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Ht=function(s){return new Zt(s)};Se.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},l="leaflet-",m=this._controlContainer=Pe("div",l+"control-container",this._container);function _(E,S){var O=l+E+" "+l+S;s[E+S]=Pe("div",O,m)}_("top","left"),_("top","right"),_("bottom","left"),_("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)Ge(this._controlCorners[s]);Ge(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var ga=Zt.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,l,m,_){return m<_?-1:_<m?1:0}},initialize:function(s,l,m){b(this,m),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var _ in s)this._addLayer(s[_],_);for(_ in l)this._addLayer(l[_],_,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Zt.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,l){return this._addLayer(s,l),this._map?this._update():this},addOverlay:function(s,l){return this._addLayer(s,l,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var l=this._getLayer(d(s));return l&&this._layers.splice(this._layers.indexOf(l),1),this._map?this._update():this},expand:function(){Te(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(Te(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Qe(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Qe(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",l=this._container=Pe("div",s),m=this.options.collapsed;l.setAttribute("aria-haspopup",!0),qi(l),zi(l);var _=this._section=Pe("section",s+"-list");m&&(this._map.on("click",this.collapse,this),de(l,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var E=this._layersLink=Pe("a",s+"-toggle",l);E.href="#",E.title="Layers",E.setAttribute("role","button"),de(E,{keydown:function(S){S.keyCode===13&&this._expandSafely()},click:function(S){et(S),this._expandSafely()}},this),m||this.expand(),this._baseLayersList=Pe("div",s+"-base",_),this._separator=Pe("div",s+"-separator",_),this._overlaysList=Pe("div",s+"-overlays",_),l.appendChild(_)},_getLayer:function(s){for(var l=0;l<this._layers.length;l++)if(this._layers[l]&&d(this._layers[l].layer)===s)return this._layers[l]},_addLayer:function(s,l,m){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:l,overlay:m}),this.options.sortLayers&&this._layers.sort(a(function(_,E){return this.options.sortFunction(_.layer,E.layer,_.name,E.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Dr(this._baseLayersList),Dr(this._overlaysList),this._layerControlInputs=[];var s,l,m,_,E=0;for(m=0;m<this._layers.length;m++)_=this._layers[m],this._addItem(_),l=l||_.overlay,s=s||!_.overlay,E+=_.overlay?0:1;return this.options.hideSingleBase&&(s=s&&E>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=l&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var l=this._getLayer(d(s.target)),m=l.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;m&&this._map.fire(m,l)},_createRadioElement:function(s,l){var m='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(l?' checked="checked"':"")+"/>",_=document.createElement("div");return _.innerHTML=m,_.firstChild},_addItem:function(s){var l=document.createElement("label"),m=this._map.hasLayer(s.layer),_;s.overlay?(_=document.createElement("input"),_.type="checkbox",_.className="leaflet-control-layers-selector",_.defaultChecked=m):_=this._createRadioElement("leaflet-base-layers_"+d(this),m),this._layerControlInputs.push(_),_.layerId=d(s.layer),de(_,"click",this._onInputClick,this);var E=document.createElement("span");E.innerHTML=" "+s.name;var S=document.createElement("span");l.appendChild(S),S.appendChild(_),S.appendChild(E);var O=s.overlay?this._overlaysList:this._baseLayersList;return O.appendChild(l),this._checkDisabledLayers(),l},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,l,m,_=[],E=[];this._handlingClick=!0;for(var S=s.length-1;S>=0;S--)l=s[S],m=this._getLayer(l.layerId).layer,l.checked?_.push(m):l.checked||E.push(m);for(S=0;S<E.length;S++)this._map.hasLayer(E[S])&&this._map.removeLayer(E[S]);for(S=0;S<_.length;S++)this._map.hasLayer(_[S])||this._map.addLayer(_[S]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,l,m,_=this._map.getZoom(),E=s.length-1;E>=0;E--)l=s[E],m=this._getLayer(l.layerId).layer,l.disabled=m.options.minZoom!==void 0&&_<m.options.minZoom||m.options.maxZoom!==void 0&&_>m.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,de(s,"click",et),this.expand();var l=this;setTimeout(function(){qe(s,"click",et),l._preventClick=!1})}}),Wd=function(s,l,m){return new ga(s,l,m)},pi=Zt.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var l="leaflet-control-zoom",m=Pe("div",l+" leaflet-bar"),_=this.options;return this._zoomInButton=this._createButton(_.zoomInText,_.zoomInTitle,l+"-in",m,this._zoomIn),this._zoomOutButton=this._createButton(_.zoomOutText,_.zoomOutTitle,l+"-out",m,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),m},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,l,m,_,E){var S=Pe("a",m,_);return S.innerHTML=s,S.href="#",S.title=l,S.setAttribute("role","button"),S.setAttribute("aria-label",l),qi(S),de(S,"click",sn),de(S,"click",E,this),de(S,"click",this._refocusOnMap,this),S},_updateDisabled:function(){var s=this._map,l="leaflet-disabled";Qe(this._zoomInButton,l),Qe(this._zoomOutButton,l),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(Te(this._zoomOutButton,l),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(Te(this._zoomInButton,l),this._zoomInButton.setAttribute("aria-disabled","true"))}});Se.mergeOptions({zoomControl:!0}),Se.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new pi,this.addControl(this.zoomControl))});var yu=function(s){return new pi(s)},Ro=Zt.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var l="leaflet-control-scale",m=Pe("div",l),_=this.options;return this._addScales(_,l+"-line",m),s.on(_.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),m},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,l,m){s.metric&&(this._mScale=Pe("div",l,m)),s.imperial&&(this._iScale=Pe("div",l,m))},_update:function(){var s=this._map,l=s.getSize().y/2,m=s.distance(s.containerPointToLatLng([0,l]),s.containerPointToLatLng([this.options.maxWidth,l]));this._updateScales(m)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var l=this._getRoundNum(s),m=l<1e3?l+" m":l/1e3+" km";this._updateScale(this._mScale,m,l/s)},_updateImperial:function(s){var l=s*3.2808399,m,_,E;l>5280?(m=l/5280,_=this._getRoundNum(m),this._updateScale(this._iScale,_+" mi",_/m)):(E=this._getRoundNum(l),this._updateScale(this._iScale,E+" ft",E/l))},_updateScale:function(s,l,m){s.style.width=Math.round(this.options.maxWidth*m)+"px",s.innerHTML=l},_getRoundNum:function(s){var l=Math.pow(10,(Math.floor(s)+"").length-1),m=s/l;return m=m>=10?10:m>=5?5:m>=3?3:m>=2?2:1,l*m}}),No=function(s){return new Ro(s)},vu='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Hi=Zt.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ue.inlineSvg?vu+" ":"")+"Leaflet</a>"},initialize:function(s){b(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Pe("div","leaflet-control-attribution"),qi(this._container);for(var l in s._layers)s._layers[l].getAttribution&&this.addAttribution(s._layers[l].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var l in this._attributions)this._attributions[l]&&s.push(l);var m=[];this.options.prefix&&m.push(this.options.prefix),s.length&&m.push(s.join(", ")),this._container.innerHTML=m.join(' <span aria-hidden="true">|</span> ')}}});Se.mergeOptions({attributionControl:!0}),Se.addInitHook(function(){this.options.attributionControl&&new Hi().addTo(this)});var $d=function(s){return new Hi(s)};Zt.Layers=ga,Zt.Zoom=pi,Zt.Scale=Ro,Zt.Attribution=Hi,Ht.layers=Wd,Ht.zoom=yu,Ht.scale=No,Ht.attribution=$d;var an=le.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});an.addTo=function(s,l){return s.addHandler(l,this),this};var Vr={Events:we},_a=ue.touch?"touchstart mousedown":"mousedown",Vn=Fe.extend({options:{clickTolerance:3},initialize:function(s,l,m,_){b(this,_),this._element=s,this._dragStartTarget=l||s,this._preventOutline=m},enable:function(){this._enabled||(de(this._dragStartTarget,_a,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Vn._dragging===this&&this.finishDrag(!0),qe(this._dragStartTarget,_a,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!ra(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Vn._dragging===this&&this.finishDrag();return}if(!(Vn._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Vn._dragging=this,this._preventOutline&&fi(this._element),aa(),Ln(),!this._moving)){this.fire("down");var l=s.touches?s.touches[0]:s,m=ca(this._element);this._startPoint=new Z(l.clientX,l.clientY),this._startPos=_n(this._element),this._parentScale=xo(m);var _=s.type==="mousedown";de(document,_?"mousemove":"touchmove",this._onMove,this),de(document,_?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var l=s.touches&&s.touches.length===1?s.touches[0]:s,m=new Z(l.clientX,l.clientY)._subtract(this._startPoint);!m.x&&!m.y||Math.abs(m.x)+Math.abs(m.y)<this.options.clickTolerance||(m.x/=this._parentScale.x,m.y/=this._parentScale.y,et(s),this._moved||(this.fire("dragstart"),this._moved=!0,Te(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Te(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(m),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),me(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Qe(document.body,"leaflet-dragging"),this._lastTarget&&(Qe(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),qe(document,"mousemove touchmove",this._onMove,this),qe(document,"mouseup touchend touchcancel",this._onUp,this),la(),Dn();var l=this._moved&&this._moving;this._moving=!1,Vn._dragging=!1,l&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function ko(s,l,m){var _,E=[1,4,2,8],S,O,G,$,Q,re,he,Ie;for(S=0,re=s.length;S<re;S++)s[S]._code=Jn(s[S],l);for(G=0;G<4;G++){for(he=E[G],_=[],S=0,re=s.length,O=re-1;S<re;O=S++)$=s[S],Q=s[O],$._code&he?Q._code&he||(Ie=wt(Q,$,he,l,m),Ie._code=Jn(Ie,l),_.push(Ie)):(Q._code&he&&(Ie=wt(Q,$,he,l,m),Ie._code=Jn(Ie,l),_.push(Ie)),_.push($));s=_}return s}function Mo(s,l){var m,_,E,S,O,G,$,Q,re;if(!s||s.length===0)throw new Error("latlngs not passed");h(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var he=_e([0,0]),Ie=Ue(s),Gt=Ie.getNorthWest().distanceTo(Ie.getSouthWest())*Ie.getNorthEast().distanceTo(Ie.getNorthWest());Gt<1700&&(he=Lo(s));var Ct=s.length,wn=[];for(m=0;m<Ct;m++){var Yt=_e(s[m]);wn.push(l.project(_e([Yt.lat-he.lat,Yt.lng-he.lng])))}for(G=$=Q=0,m=0,_=Ct-1;m<Ct;_=m++)E=wn[m],S=wn[_],O=E.y*S.x-S.y*E.x,$+=(E.x+S.x)*O,Q+=(E.y+S.y)*O,G+=O*3;G===0?re=wn[0]:re=[$/G,Q/G];var Bo=l.unproject(ee(re));return _e([Bo.lat+he.lat,Bo.lng+he.lng])}function Lo(s){for(var l=0,m=0,_=0,E=0;E<s.length;E++){var S=_e(s[E]);l+=S.lat,m+=S.lng,_++}return _e([l/_,m/_])}var Do={__proto__:null,clipPolygon:ko,polygonCenter:Mo,centroid:Lo};function ya(s,l){if(!l||!s.length)return s.slice();var m=l*l;return s=Eu(s,m),s=Tu(s,m),s}function va(s,l,m){return Math.sqrt(En(s,l,m,!0))}function mi(s,l,m){return En(s,l,m)}function Tu(s,l){var m=s.length,_=typeof Uint8Array<"u"?Uint8Array:Array,E=new _(m);E[0]=E[m-1]=1,Vo(s,E,l,0,m-1);var S,O=[];for(S=0;S<m;S++)E[S]&&O.push(s[S]);return O}function Vo(s,l,m,_,E){var S=0,O,G,$;for(G=_+1;G<=E-1;G++)$=En(s[G],s[_],s[E],!0),$>S&&(O=G,S=$);S>m&&(l[O]=1,Vo(s,l,m,_,O),Vo(s,l,m,O,E))}function Eu(s,l){for(var m=[s[0]],_=1,E=0,S=s.length;_<S;_++)wu(s[_],s[E])>l&&(m.push(s[_]),E=_);return E<S-1&&m.push(s[S-1]),m}var Ta;function br(s,l,m,_,E){var S=_?Ta:Jn(s,m),O=Jn(l,m),G,$,Q;for(Ta=O;;){if(!(S|O))return[s,l];if(S&O)return!1;G=S||O,$=wt(s,l,G,m,E),Q=Jn($,m),G===S?(s=$,S=Q):(l=$,O=Q)}}function wt(s,l,m,_,E){var S=l.x-s.x,O=l.y-s.y,G=_.min,$=_.max,Q,re;return m&8?(Q=s.x+S*($.y-s.y)/O,re=$.y):m&4?(Q=s.x+S*(G.y-s.y)/O,re=G.y):m&2?(Q=$.x,re=s.y+O*($.x-s.x)/S):m&1&&(Q=G.x,re=s.y+O*(G.x-s.x)/S),new Z(Q,re,E)}function Jn(s,l){var m=0;return s.x<l.min.x?m|=1:s.x>l.max.x&&(m|=2),s.y<l.min.y?m|=4:s.y>l.max.y&&(m|=8),m}function wu(s,l){var m=l.x-s.x,_=l.y-s.y;return m*m+_*_}function En(s,l,m,_){var E=l.x,S=l.y,O=m.x-E,G=m.y-S,$=O*O+G*G,Q;return $>0&&(Q=((s.x-E)*O+(s.y-S)*G)/$,Q>1?(E=m.x,S=m.y):Q>0&&(E+=O*Q,S+=G*Q)),O=s.x-E,G=s.y-S,_?O*O+G*G:new Z(E,S)}function h(s){return!R(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function v(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),h(s)}function w(s,l){var m,_,E,S,O,G,$,Q;if(!s||s.length===0)throw new Error("latlngs not passed");h(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var re=_e([0,0]),he=Ue(s),Ie=he.getNorthWest().distanceTo(he.getSouthWest())*he.getNorthEast().distanceTo(he.getNorthWest());Ie<1700&&(re=Lo(s));var Gt=s.length,Ct=[];for(m=0;m<Gt;m++){var wn=_e(s[m]);Ct.push(l.project(_e([wn.lat-re.lat,wn.lng-re.lng])))}for(m=0,_=0;m<Gt-1;m++)_+=Ct[m].distanceTo(Ct[m+1])/2;if(_===0)Q=Ct[0];else for(m=0,S=0;m<Gt-1;m++)if(O=Ct[m],G=Ct[m+1],E=O.distanceTo(G),S+=E,S>_){$=(S-_)/E,Q=[G.x-$*(G.x-O.x),G.y-$*(G.y-O.y)];break}var Yt=l.unproject(ee(Q));return _e([Yt.lat+re.lat,Yt.lng+re.lng])}var P={__proto__:null,simplify:ya,pointToSegmentDistance:va,closestPointOnSegment:mi,clipSegment:br,_getEdgeIntersection:wt,_getBitCode:Jn,_sqClosestPointOnSegment:En,isFlat:h,_flat:v,polylineCenter:w},H={project:function(s){return new Z(s.lng,s.lat)},unproject:function(s){return new Ce(s.y,s.x)},bounds:new pe([-180,-90],[180,90])},K={R:6378137,R_MINOR:6356752314245179e-9,bounds:new pe([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var l=Math.PI/180,m=this.R,_=s.lat*l,E=this.R_MINOR/m,S=Math.sqrt(1-E*E),O=S*Math.sin(_),G=Math.tan(Math.PI/4-_/2)/Math.pow((1-O)/(1+O),S/2);return _=-m*Math.log(Math.max(G,1e-10)),new Z(s.lng*l*m,_)},unproject:function(s){for(var l=180/Math.PI,m=this.R,_=this.R_MINOR/m,E=Math.sqrt(1-_*_),S=Math.exp(-s.y/m),O=Math.PI/2-2*Math.atan(S),G=0,$=.1,Q;G<15&&Math.abs($)>1e-7;G++)Q=E*Math.sin(O),Q=Math.pow((1-Q)/(1+Q),E/2),$=Math.PI/2-2*Math.atan(S*Q)-O,O+=$;return new Ce(O*l,s.x*l/m)}},te={__proto__:null,LonLat:H,Mercator:K,SphericalMercator:Vi},Oe=r({},$n,{code:"EPSG:3395",projection:K,transformation:function(){var s=.5/(Math.PI*K.R);return ai(s,.5,-s,.5)}()}),ht=r({},$n,{code:"EPSG:4326",projection:H,transformation:ai(1/180,1,-1/180,.5)}),Ne=r({},_t,{projection:H,transformation:ai(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,l){var m=l.lng-s.lng,_=l.lat-s.lat;return Math.sqrt(m*m+_*_)},infinite:!0});_t.Earth=$n,_t.EPSG3395=Oe,_t.EPSG3857=Cr,_t.EPSG900913=Hs,_t.EPSG4326=ht,_t.Simple=Ne;var He=Fe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[d(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[d(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var l=s.target;if(l.hasLayer(this)){if(this._map=l,this._zoomAnimated=l._zoomAnimated,this.getEvents){var m=this.getEvents();l.on(m,this),this.once("remove",function(){l.off(m,this)},this)}this.onAdd(l),this.fire("add"),l.fire("layeradd",{layer:this})}}});Se.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var l=d(s);return this._layers[l]?this:(this._layers[l]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var l=d(s);return this._layers[l]?(this._loaded&&s.onRemove(this),delete this._layers[l],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return d(s)in this._layers},eachLayer:function(s,l){for(var m in this._layers)s.call(l,this._layers[m]);return this},_addLayers:function(s){s=s?R(s)?s:[s]:[];for(var l=0,m=s.length;l<m;l++)this.addLayer(s[l])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[d(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var l=d(s);this._zoomBoundLayers[l]&&(delete this._zoomBoundLayers[l],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,l=-1/0,m=this._getZoomSpan();for(var _ in this._zoomBoundLayers){var E=this._zoomBoundLayers[_].options;s=E.minZoom===void 0?s:Math.min(s,E.minZoom),l=E.maxZoom===void 0?l:Math.max(l,E.maxZoom)}this._layersMaxZoom=l===-1/0?void 0:l,this._layersMinZoom=s===1/0?void 0:s,m!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var tt=He.extend({initialize:function(s,l){b(this,l),this._layers={};var m,_;if(s)for(m=0,_=s.length;m<_;m++)this.addLayer(s[m])},addLayer:function(s){var l=this.getLayerId(s);return this._layers[l]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var l=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[l]&&this._map.removeLayer(this._layers[l]),delete this._layers[l],this},hasLayer:function(s){var l=typeof s=="number"?s:this.getLayerId(s);return l in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var l=Array.prototype.slice.call(arguments,1),m,_;for(m in this._layers)_=this._layers[m],_[s]&&_[s].apply(_,l);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,l){for(var m in this._layers)s.call(l,this._layers[m]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return d(s)}}),Gi=function(s,l){return new tt(s,l)},lt=tt.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),tt.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),tt.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new Ae;for(var l in this._layers){var m=this._layers[l];s.extend(m.getBounds?m.getBounds():m.getLatLng())}return s}}),bo=function(s,l){return new lt(s,l)},Zn=le.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){b(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,l){var m=this._getIconUrl(s);if(!m){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var _=this._createImg(m,l&&l.tagName==="IMG"?l:null);return this._setIconStyles(_,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),_},_setIconStyles:function(s,l){var m=this.options,_=m[l+"Size"];typeof _=="number"&&(_=[_,_]);var E=ee(_),S=ee(l==="shadow"&&m.shadowAnchor||m.iconAnchor||E&&E.divideBy(2,!0));s.className="leaflet-marker-"+l+" "+(m.className||""),S&&(s.style.marginLeft=-S.x+"px",s.style.marginTop=-S.y+"px"),E&&(s.style.width=E.x+"px",s.style.height=E.y+"px")},_createImg:function(s,l){return l=l||document.createElement("img"),l.src=s,l},_getIconUrl:function(s){return ue.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function OC(s){return new Zn(s)}var Ea=Zn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Ea.imagePath!="string"&&(Ea.imagePath=this._detectIconPath()),(this.options.imagePath||Ea.imagePath)+Zn.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var l=function(m,_,E){var S=_.exec(m);return S&&S[E]};return s=l(s,/^url\((['"])?(.+)\1\)$/,2),s&&l(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Pe("div","leaflet-default-icon-path",document.body),l=Ui(s,"background-image")||Ui(s,"backgroundImage");if(document.body.removeChild(s),l=this._stripUrl(l),l)return l;var m=document.querySelector('link[href$="leaflet.css"]');return m?m.href.substring(0,m.href.length-11-1):""}}),Qm=an.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Vn(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Te(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Qe(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var l=this._marker,m=l._map,_=this._marker.options.autoPanSpeed,E=this._marker.options.autoPanPadding,S=_n(l._icon),O=m.getPixelBounds(),G=m.getPixelOrigin(),$=Ee(O.min._subtract(G).add(E),O.max._subtract(G).subtract(E));if(!$.contains(S)){var Q=ee((Math.max($.max.x,S.x)-$.max.x)/(O.max.x-$.max.x)-(Math.min($.min.x,S.x)-$.min.x)/(O.min.x-$.min.x),(Math.max($.max.y,S.y)-$.max.y)/(O.max.y-$.max.y)-(Math.min($.min.y,S.y)-$.min.y)/(O.min.y-$.min.y)).multiplyBy(_);m.panBy(Q,{animate:!1}),this._draggable._newPos._add(Q),this._draggable._startPos._add(Q),me(l._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=B(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(U(this._panRequest),this._panRequest=B(this._adjustPan.bind(this,s)))},_onDrag:function(s){var l=this._marker,m=l._shadow,_=_n(l._icon),E=l._map.layerPointToLatLng(_);m&&me(m,_),l._latlng=E,s.latlng=E,s.oldLatLng=this._oldLatLng,l.fire("move",s).fire("drag",s)},_onDragEnd:function(s){U(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Cu=He.extend({options:{icon:new Ea,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,l){b(this,l),this._latlng=_e(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var l=this._latlng;return this._latlng=_e(s),this.update(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,l="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),m=s.icon.createIcon(this._icon),_=!1;m!==this._icon&&(this._icon&&this._removeIcon(),_=!0,s.title&&(m.title=s.title),m.tagName==="IMG"&&(m.alt=s.alt||"")),Te(m,l),s.keyboard&&(m.tabIndex="0",m.setAttribute("role","button")),this._icon=m,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&de(m,"focus",this._panOnFocus,this);var E=s.icon.createShadow(this._shadow),S=!1;E!==this._shadow&&(this._removeShadow(),S=!0),E&&(Te(E,l),E.alt=""),this._shadow=E,s.opacity<1&&this._updateOpacity(),_&&this.getPane().appendChild(this._icon),this._initInteraction(),E&&S&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&qe(this._icon,"focus",this._panOnFocus,this),Ge(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Ge(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&me(this._icon,s),this._shadow&&me(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var l=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(l)},_initInteraction:function(){if(this.options.interactive&&(Te(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Qm)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Qm(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&st(this._icon,s),this._shadow&&st(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var l=this.options.icon.options,m=l.iconSize?ee(l.iconSize):ee(0,0),_=l.iconAnchor?ee(l.iconAnchor):ee(0,0);s.panInside(this._latlng,{paddingTopLeft:_,paddingBottomRight:m.subtract(_)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function BC(s,l){return new Cu(s,l)}var Wi=He.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return b(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Iu=Wi.extend({options:{fill:!0,radius:10},initialize:function(s,l){b(this,l),this._latlng=_e(s),this._radius=this.options.radius},setLatLng:function(s){var l=this._latlng;return this._latlng=_e(s),this.redraw(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var l=s&&s.radius||this._radius;return Wi.prototype.setStyle.call(this,s),this.setRadius(l),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,l=this._radiusY||s,m=this._clickTolerance(),_=[s+m,l+m];this._pxBounds=new pe(this._point.subtract(_),this._point.add(_))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function zC(s,l){return new Iu(s,l)}var Kd=Iu.extend({initialize:function(s,l,m){if(typeof l=="number"&&(l=r({},m,{radius:l})),b(this,l),this._latlng=_e(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new Ae(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:Wi.prototype.setStyle,_project:function(){var s=this._latlng.lng,l=this._latlng.lat,m=this._map,_=m.options.crs;if(_.distance===$n.distance){var E=Math.PI/180,S=this._mRadius/$n.R/E,O=m.project([l+S,s]),G=m.project([l-S,s]),$=O.add(G).divideBy(2),Q=m.unproject($).lat,re=Math.acos((Math.cos(S*E)-Math.sin(l*E)*Math.sin(Q*E))/(Math.cos(l*E)*Math.cos(Q*E)))/E;(isNaN(re)||re===0)&&(re=S/Math.cos(Math.PI/180*l)),this._point=$.subtract(m.getPixelOrigin()),this._radius=isNaN(re)?0:$.x-m.project([Q,s-re]).x,this._radiusY=$.y-O.y}else{var he=_.unproject(_.project(this._latlng).subtract([this._mRadius,0]));this._point=m.latLngToLayerPoint(this._latlng),this._radius=this._point.x-m.latLngToLayerPoint(he).x}this._updateBounds()}});function qC(s,l,m){return new Kd(s,l,m)}var gi=Wi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,l){b(this,l),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var l=1/0,m=null,_=En,E,S,O=0,G=this._parts.length;O<G;O++)for(var $=this._parts[O],Q=1,re=$.length;Q<re;Q++){E=$[Q-1],S=$[Q];var he=_(s,E,S,!0);he<l&&(l=he,m=_(s,E,S))}return m&&(m.distance=Math.sqrt(l)),m},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return w(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,l){return l=l||this._defaultShape(),s=_e(s),l.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new Ae,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return h(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var l=[],m=h(s),_=0,E=s.length;_<E;_++)m?(l[_]=_e(s[_]),this._bounds.extend(l[_])):l[_]=this._convertLatLngs(s[_]);return l},_project:function(){var s=new pe;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),l=new Z(s,s);this._rawPxBounds&&(this._pxBounds=new pe([this._rawPxBounds.min.subtract(l),this._rawPxBounds.max.add(l)]))},_projectLatlngs:function(s,l,m){var _=s[0]instanceof Ce,E=s.length,S,O;if(_){for(O=[],S=0;S<E;S++)O[S]=this._map.latLngToLayerPoint(s[S]),m.extend(O[S]);l.push(O)}else for(S=0;S<E;S++)this._projectLatlngs(s[S],l,m)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var l=this._parts,m,_,E,S,O,G,$;for(m=0,E=0,S=this._rings.length;m<S;m++)for($=this._rings[m],_=0,O=$.length;_<O-1;_++)G=br($[_],$[_+1],s,_,!0),G&&(l[E]=l[E]||[],l[E].push(G[0]),(G[1]!==$[_+1]||_===O-2)&&(l[E].push(G[1]),E++))}},_simplifyPoints:function(){for(var s=this._parts,l=this.options.smoothFactor,m=0,_=s.length;m<_;m++)s[m]=ya(s[m],l)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,l){var m,_,E,S,O,G,$=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(m=0,S=this._parts.length;m<S;m++)for(G=this._parts[m],_=0,O=G.length,E=O-1;_<O;E=_++)if(!(!l&&_===0)&&va(s,G[E],G[_])<=$)return!0;return!1}});function HC(s,l){return new gi(s,l)}gi._flat=v;var Fo=gi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Mo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var l=gi.prototype._convertLatLngs.call(this,s),m=l.length;return m>=2&&l[0]instanceof Ce&&l[0].equals(l[m-1])&&l.pop(),l},_setLatLngs:function(s){gi.prototype._setLatLngs.call(this,s),h(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return h(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,l=this.options.weight,m=new Z(l,l);if(s=new pe(s.min.subtract(m),s.max.add(m)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var _=0,E=this._rings.length,S;_<E;_++)S=ko(this._rings[_],s,!0),S.length&&this._parts.push(S)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var l=!1,m,_,E,S,O,G,$,Q;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(S=0,$=this._parts.length;S<$;S++)for(m=this._parts[S],O=0,Q=m.length,G=Q-1;O<Q;G=O++)_=m[O],E=m[G],_.y>s.y!=E.y>s.y&&s.x<(E.x-_.x)*(s.y-_.y)/(E.y-_.y)+_.x&&(l=!l);return l||gi.prototype._containsPoint.call(this,s,!0)}});function GC(s,l){return new Fo(s,l)}var _i=lt.extend({initialize:function(s,l){b(this,l),this._layers={},s&&this.addData(s)},addData:function(s){var l=R(s)?s:s.features,m,_,E;if(l){for(m=0,_=l.length;m<_;m++)E=l[m],(E.geometries||E.geometry||E.features||E.coordinates)&&this.addData(E);return this}var S=this.options;if(S.filter&&!S.filter(s))return this;var O=Su(s,S);return O?(O.feature=Pu(s),O.defaultOptions=O.options,this.resetStyle(O),S.onEachFeature&&S.onEachFeature(s,O),this.addLayer(O)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=r({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(l){this._setLayerStyle(l,s)},this)},_setLayerStyle:function(s,l){s.setStyle&&(typeof l=="function"&&(l=l(s.feature)),s.setStyle(l))}});function Su(s,l){var m=s.type==="Feature"?s.geometry:s,_=m?m.coordinates:null,E=[],S=l&&l.pointToLayer,O=l&&l.coordsToLatLng||Jd,G,$,Q,re;if(!_&&!m)return null;switch(m.type){case"Point":return G=O(_),Xm(S,s,G,l);case"MultiPoint":for(Q=0,re=_.length;Q<re;Q++)G=O(_[Q]),E.push(Xm(S,s,G,l));return new lt(E);case"LineString":case"MultiLineString":return $=xu(_,m.type==="LineString"?0:1,O),new gi($,l);case"Polygon":case"MultiPolygon":return $=xu(_,m.type==="Polygon"?1:2,O),new Fo($,l);case"GeometryCollection":for(Q=0,re=m.geometries.length;Q<re;Q++){var he=Su({geometry:m.geometries[Q],type:"Feature",properties:s.properties},l);he&&E.push(he)}return new lt(E);case"FeatureCollection":for(Q=0,re=m.features.length;Q<re;Q++){var Ie=Su(m.features[Q],l);Ie&&E.push(Ie)}return new lt(E);default:throw new Error("Invalid GeoJSON object.")}}function Xm(s,l,m,_){return s?s(l,m):new Cu(m,_&&_.markersInheritOptions&&_)}function Jd(s){return new Ce(s[1],s[0],s[2])}function xu(s,l,m){for(var _=[],E=0,S=s.length,O;E<S;E++)O=l?xu(s[E],l-1,m):(m||Jd)(s[E]),_.push(O);return _}function Zd(s,l){return s=_e(s),s.alt!==void 0?[T(s.lng,l),T(s.lat,l),T(s.alt,l)]:[T(s.lng,l),T(s.lat,l)]}function Au(s,l,m,_){for(var E=[],S=0,O=s.length;S<O;S++)E.push(l?Au(s[S],h(s[S])?0:l-1,m,_):Zd(s[S],_));return!l&&m&&E.length>0&&E.push(E[0].slice()),E}function Uo(s,l){return s.feature?r({},s.feature,{geometry:l}):Pu(l)}function Pu(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Yd={toGeoJSON:function(s){return Uo(this,{type:"Point",coordinates:Zd(this.getLatLng(),s)})}};Cu.include(Yd),Kd.include(Yd),Iu.include(Yd),gi.include({toGeoJSON:function(s){var l=!h(this._latlngs),m=Au(this._latlngs,l?1:0,!1,s);return Uo(this,{type:(l?"Multi":"")+"LineString",coordinates:m})}}),Fo.include({toGeoJSON:function(s){var l=!h(this._latlngs),m=l&&!h(this._latlngs[0]),_=Au(this._latlngs,m?2:l?1:0,!0,s);return l||(_=[_]),Uo(this,{type:(m?"Multi":"")+"Polygon",coordinates:_})}}),tt.include({toMultiPoint:function(s){var l=[];return this.eachLayer(function(m){l.push(m.toGeoJSON(s).geometry.coordinates)}),Uo(this,{type:"MultiPoint",coordinates:l})},toGeoJSON:function(s){var l=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(l==="MultiPoint")return this.toMultiPoint(s);var m=l==="GeometryCollection",_=[];return this.eachLayer(function(E){if(E.toGeoJSON){var S=E.toGeoJSON(s);if(m)_.push(S.geometry);else{var O=Pu(S);O.type==="FeatureCollection"?_.push.apply(_,O.features):_.push(O)}}}),m?Uo(this,{geometries:_,type:"GeometryCollection"}):{type:"FeatureCollection",features:_}}});function jm(s,l){return new _i(s,l)}var WC=jm,Ru=He.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,l,m){this._url=s,this._bounds=Ue(l),b(this,m)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Te(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Ge(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&di(this._image),this},bringToBack:function(){return this._map&&Oi(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=Ue(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",l=this._image=s?this._url:Pe("img");if(Te(l,"leaflet-image-layer"),this._zoomAnimated&&Te(l,"leaflet-zoom-animated"),this.options.className&&Te(l,this.options.className),l.onselectstart=y,l.onmousemove=y,l.onload=a(this.fire,this,"load"),l.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(l.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=l.src;return}l.src=this._url,l.alt=this.options.alt},_animateZoom:function(s){var l=this._map.getZoomScale(s.zoom),m=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;Kn(this._image,m,l)},_reset:function(){var s=this._image,l=new pe(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),m=l.getSize();me(s,l.min),s.style.width=m.x+"px",s.style.height=m.y+"px"},_updateOpacity:function(){st(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),$C=function(s,l,m){return new Ru(s,l,m)},eg=Ru.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",l=this._image=s?this._url:Pe("video");if(Te(l,"leaflet-image-layer"),this._zoomAnimated&&Te(l,"leaflet-zoom-animated"),this.options.className&&Te(l,this.options.className),l.onselectstart=y,l.onmousemove=y,l.onloadeddata=a(this.fire,this,"load"),s){for(var m=l.getElementsByTagName("source"),_=[],E=0;E<m.length;E++)_.push(m[E].src);this._url=m.length>0?_:[l.src];return}R(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(l.style,"objectFit")&&(l.style.objectFit="fill"),l.autoplay=!!this.options.autoplay,l.loop=!!this.options.loop,l.muted=!!this.options.muted,l.playsInline=!!this.options.playsInline;for(var S=0;S<this._url.length;S++){var O=Pe("source");O.src=this._url[S],l.appendChild(O)}}});function KC(s,l,m){return new eg(s,l,m)}var tg=Ru.extend({_initImage:function(){var s=this._image=this._url;Te(s,"leaflet-image-layer"),this._zoomAnimated&&Te(s,"leaflet-zoom-animated"),this.options.className&&Te(s,this.options.className),s.onselectstart=y,s.onmousemove=y}});function JC(s,l,m){return new tg(s,l,m)}var Yn=He.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,l){s&&(s instanceof Ce||R(s))?(this._latlng=_e(s),b(this,l)):(b(this,s),this._source=l),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&st(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&st(this._container,1),this.bringToFront(),this.options.interactive&&(Te(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(st(this._container,0),this._removeTimeout=setTimeout(a(Ge,void 0,this._container),200)):Ge(this._container),this.options.interactive&&(Qe(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=_e(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&di(this._container),this},bringToBack:function(){return this._map&&Oi(this._container),this},_prepareOpen:function(s){var l=this._source;if(!l._map)return!1;if(l instanceof lt){l=null;var m=this._source._layers;for(var _ in m)if(m[_]._map){l=m[_];break}if(!l)return!1;this._source=l}if(!s)if(l.getCenter)s=l.getCenter();else if(l.getLatLng)s=l.getLatLng();else if(l.getBounds)s=l.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,l=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof l=="string")s.innerHTML=l;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(l)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),l=ee(this.options.offset),m=this._getAnchor();this._zoomAnimated?me(this._container,s.add(m)):l=l.add(s).add(m);var _=this._containerBottom=-l.y,E=this._containerLeft=-Math.round(this._containerWidth/2)+l.x;this._container.style.bottom=_+"px",this._container.style.left=E+"px"}},_getAnchor:function(){return[0,0]}});Se.include({_initOverlay:function(s,l,m,_){var E=l;return E instanceof s||(E=new s(_).setContent(l)),m&&E.setLatLng(m),E}}),He.include({_initOverlay:function(s,l,m,_){var E=m;return E instanceof s?(b(E,_),E._source=this):(E=l&&!_?l:new s(_,this),E.setContent(m)),E}});var Nu=Yn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,Yn.prototype.openOn.call(this,s)},onAdd:function(s){Yn.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Wi||this._source.on("preclick",Tn))},onRemove:function(s){Yn.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Wi||this._source.off("preclick",Tn))},getEvents:function(){var s=Yn.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",l=this._container=Pe("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),m=this._wrapper=Pe("div",s+"-content-wrapper",l);if(this._contentNode=Pe("div",s+"-content",m),qi(l),zi(this._contentNode),de(l,"contextmenu",Tn),this._tipContainer=Pe("div",s+"-tip-container",l),this._tip=Pe("div",s+"-tip",this._tipContainer),this.options.closeButton){var _=this._closeButton=Pe("a",s+"-close-button",l);_.setAttribute("role","button"),_.setAttribute("aria-label","Close popup"),_.href="#close",_.innerHTML='<span aria-hidden="true">&#215;</span>',de(_,"click",function(E){et(E),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,l=s.style;l.width="",l.whiteSpace="nowrap";var m=s.offsetWidth;m=Math.min(m,this.options.maxWidth),m=Math.max(m,this.options.minWidth),l.width=m+1+"px",l.whiteSpace="",l.height="";var _=s.offsetHeight,E=this.options.maxHeight,S="leaflet-popup-scrolled";E&&_>E?(l.height=E+"px",Te(s,S)):Qe(s,S),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var l=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),m=this._getAnchor();me(this._container,l.add(m))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,l=parseInt(Ui(this._container,"marginBottom"),10)||0,m=this._container.offsetHeight+l,_=this._containerWidth,E=new Z(this._containerLeft,-m-this._containerBottom);E._add(_n(this._container));var S=s.layerPointToContainerPoint(E),O=ee(this.options.autoPanPadding),G=ee(this.options.autoPanPaddingTopLeft||O),$=ee(this.options.autoPanPaddingBottomRight||O),Q=s.getSize(),re=0,he=0;S.x+_+$.x>Q.x&&(re=S.x+_-Q.x+$.x),S.x-re-G.x<0&&(re=S.x-G.x),S.y+m+$.y>Q.y&&(he=S.y+m-Q.y+$.y),S.y-he-G.y<0&&(he=S.y-G.y),(re||he)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([re,he]))}},_getAnchor:function(){return ee(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ZC=function(s,l){return new Nu(s,l)};Se.mergeOptions({closePopupOnClick:!0}),Se.include({openPopup:function(s,l,m){return this._initOverlay(Nu,s,l,m).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),He.include({bindPopup:function(s,l){return this._popup=this._initOverlay(Nu,this._popup,s,l),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof lt||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){sn(s);var l=s.layer||s.target;if(this._popup._source===l&&!(l instanceof Wi)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=l,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var ku=Yn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){Yn.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){Yn.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=Yn.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",l=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Pe("div",l),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var l,m,_=this._map,E=this._container,S=_.latLngToContainerPoint(_.getCenter()),O=_.layerPointToContainerPoint(s),G=this.options.direction,$=E.offsetWidth,Q=E.offsetHeight,re=ee(this.options.offset),he=this._getAnchor();G==="top"?(l=$/2,m=Q):G==="bottom"?(l=$/2,m=0):G==="center"?(l=$/2,m=Q/2):G==="right"?(l=0,m=Q/2):G==="left"?(l=$,m=Q/2):O.x<S.x?(G="right",l=0,m=Q/2):(G="left",l=$+(re.x+he.x)*2,m=Q/2),s=s.subtract(ee(l,m,!0)).add(re).add(he),Qe(E,"leaflet-tooltip-right"),Qe(E,"leaflet-tooltip-left"),Qe(E,"leaflet-tooltip-top"),Qe(E,"leaflet-tooltip-bottom"),Te(E,"leaflet-tooltip-"+G),me(E,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&st(this._container,s)},_animateZoom:function(s){var l=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(l)},_getAnchor:function(){return ee(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),YC=function(s,l){return new ku(s,l)};Se.include({openTooltip:function(s,l,m){return this._initOverlay(ku,s,l,m).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),He.include({bindTooltip:function(s,l){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ku,this._tooltip,s,l),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var l=s?"off":"on",m={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?m.add=this._openTooltip:(m.mouseover=this._openTooltip,m.mouseout=this.closeTooltip,m.click=this._openTooltip,this._map?this._addFocusListeners():m.add=this._addFocusListeners),this._tooltip.options.sticky&&(m.mousemove=this._moveTooltip),this[l](m),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof lt||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var l=typeof s.getElement=="function"&&s.getElement();l&&(de(l,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),de(l,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var l=typeof s.getElement=="function"&&s.getElement();l&&l.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var l=this;this._map.once("moveend",function(){l._openOnceFlag=!1,l._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var l=s.latlng,m,_;this._tooltip.options.sticky&&s.originalEvent&&(m=this._map.mouseEventToContainerPoint(s.originalEvent),_=this._map.containerPointToLayerPoint(m),l=this._map.layerPointToLatLng(_)),this._tooltip.setLatLng(l)}});var ng=Zn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var l=s&&s.tagName==="DIV"?s:document.createElement("div"),m=this.options;if(m.html instanceof Element?(Dr(l),l.appendChild(m.html)):l.innerHTML=m.html!==!1?m.html:"",m.bgPos){var _=ee(m.bgPos);l.style.backgroundPosition=-_.x+"px "+-_.y+"px"}return this._setIconStyles(l,"icon"),l},createShadow:function(){return null}});function QC(s){return new ng(s)}Zn.Default=Ea;var wa=He.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ue.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){b(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),Ge(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(di(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Oi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof Z?s:new Z(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var l=this.getPane().children,m=-s(-1/0,1/0),_=0,E=l.length,S;_<E;_++)S=l[_].style.zIndex,l[_]!==this._container&&S&&(m=s(m,+S));isFinite(m)&&(this.options.zIndex=m+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ue.ielt9){st(this._container,this.options.opacity);var s=+new Date,l=!1,m=!1;for(var _ in this._tiles){var E=this._tiles[_];if(!(!E.current||!E.loaded)){var S=Math.min(1,(s-E.loaded)/200);st(E.el,S),S<1?l=!0:(E.active?m=!0:this._onOpaqueTile(E),E.active=!0)}}m&&!this._noPrune&&this._pruneTiles(),l&&(U(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=Pe("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,l=this.options.maxZoom;if(s!==void 0){for(var m in this._levels)m=Number(m),this._levels[m].el.children.length||m===s?(this._levels[m].el.style.zIndex=l-Math.abs(s-m),this._onUpdateLevel(m)):(Ge(this._levels[m].el),this._removeTilesAtZoom(m),this._onRemoveLevel(m),delete this._levels[m]);var _=this._levels[s],E=this._map;return _||(_=this._levels[s]={},_.el=Pe("div","leaflet-tile-container leaflet-zoom-animated",this._container),_.el.style.zIndex=l,_.origin=E.project(E.unproject(E.getPixelOrigin()),s).round(),_.zoom=s,this._setZoomTransform(_,E.getCenter(),E.getZoom()),y(_.el.offsetWidth),this._onCreateLevel(_)),this._level=_,_}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var s,l,m=this._map.getZoom();if(m>this.options.maxZoom||m<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)l=this._tiles[s],l.retain=l.current;for(s in this._tiles)if(l=this._tiles[s],l.current&&!l.active){var _=l.coords;this._retainParent(_.x,_.y,_.z,_.z-5)||this._retainChildren(_.x,_.y,_.z,_.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var l in this._tiles)this._tiles[l].coords.z===s&&this._removeTile(l)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)Ge(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,l,m,_){var E=Math.floor(s/2),S=Math.floor(l/2),O=m-1,G=new Z(+E,+S);G.z=+O;var $=this._tileCoordsToKey(G),Q=this._tiles[$];return Q&&Q.active?(Q.retain=!0,!0):(Q&&Q.loaded&&(Q.retain=!0),O>_?this._retainParent(E,S,O,_):!1)},_retainChildren:function(s,l,m,_){for(var E=2*s;E<2*s+2;E++)for(var S=2*l;S<2*l+2;S++){var O=new Z(E,S);O.z=m+1;var G=this._tileCoordsToKey(O),$=this._tiles[G];if($&&$.active){$.retain=!0;continue}else $&&$.loaded&&($.retain=!0);m+1<_&&this._retainChildren(E,S,m+1,_)}},_resetView:function(s){var l=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),l,l)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var l=this.options;return l.minNativeZoom!==void 0&&s<l.minNativeZoom?l.minNativeZoom:l.maxNativeZoom!==void 0&&l.maxNativeZoom<s?l.maxNativeZoom:s},_setView:function(s,l,m,_){var E=Math.round(l);this.options.maxZoom!==void 0&&E>this.options.maxZoom||this.options.minZoom!==void 0&&E<this.options.minZoom?E=void 0:E=this._clampZoom(E);var S=this.options.updateWhenZooming&&E!==this._tileZoom;(!_||S)&&(this._tileZoom=E,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),E!==void 0&&this._update(s),m||this._pruneTiles(),this._noPrune=!!m),this._setZoomTransforms(s,l)},_setZoomTransforms:function(s,l){for(var m in this._levels)this._setZoomTransform(this._levels[m],s,l)},_setZoomTransform:function(s,l,m){var _=this._map.getZoomScale(m,s.zoom),E=s.origin.multiplyBy(_).subtract(this._map._getNewPixelOrigin(l,m)).round();ue.any3d?Kn(s.el,E,_):me(s.el,E)},_resetGrid:function(){var s=this._map,l=s.options.crs,m=this._tileSize=this.getTileSize(),_=this._tileZoom,E=this._map.getPixelWorldBounds(this._tileZoom);E&&(this._globalTileRange=this._pxBoundsToTileRange(E)),this._wrapX=l.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,l.wrapLng[0]],_).x/m.x),Math.ceil(s.project([0,l.wrapLng[1]],_).x/m.y)],this._wrapY=l.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([l.wrapLat[0],0],_).y/m.x),Math.ceil(s.project([l.wrapLat[1],0],_).y/m.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var l=this._map,m=l._animatingZoom?Math.max(l._animateToZoom,l.getZoom()):l.getZoom(),_=l.getZoomScale(m,this._tileZoom),E=l.project(s,this._tileZoom).floor(),S=l.getSize().divideBy(_*2);return new pe(E.subtract(S),E.add(S))},_update:function(s){var l=this._map;if(l){var m=this._clampZoom(l.getZoom());if(s===void 0&&(s=l.getCenter()),this._tileZoom!==void 0){var _=this._getTiledPixelBounds(s),E=this._pxBoundsToTileRange(_),S=E.getCenter(),O=[],G=this.options.keepBuffer,$=new pe(E.getBottomLeft().subtract([G,-G]),E.getTopRight().add([G,-G]));if(!(isFinite(E.min.x)&&isFinite(E.min.y)&&isFinite(E.max.x)&&isFinite(E.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Q in this._tiles){var re=this._tiles[Q].coords;(re.z!==this._tileZoom||!$.contains(new Z(re.x,re.y)))&&(this._tiles[Q].current=!1)}if(Math.abs(m-this._tileZoom)>1){this._setView(s,m);return}for(var he=E.min.y;he<=E.max.y;he++)for(var Ie=E.min.x;Ie<=E.max.x;Ie++){var Gt=new Z(Ie,he);if(Gt.z=this._tileZoom,!!this._isValidTile(Gt)){var Ct=this._tiles[this._tileCoordsToKey(Gt)];Ct?Ct.current=!0:O.push(Gt)}}if(O.sort(function(Yt,Bo){return Yt.distanceTo(S)-Bo.distanceTo(S)}),O.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var wn=document.createDocumentFragment();for(Ie=0;Ie<O.length;Ie++)this._addTile(O[Ie],wn);this._level.el.appendChild(wn)}}}},_isValidTile:function(s){var l=this._map.options.crs;if(!l.infinite){var m=this._globalTileRange;if(!l.wrapLng&&(s.x<m.min.x||s.x>m.max.x)||!l.wrapLat&&(s.y<m.min.y||s.y>m.max.y))return!1}if(!this.options.bounds)return!0;var _=this._tileCoordsToBounds(s);return Ue(this.options.bounds).overlaps(_)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var l=this._map,m=this.getTileSize(),_=s.scaleBy(m),E=_.add(m),S=l.unproject(_,s.z),O=l.unproject(E,s.z);return[S,O]},_tileCoordsToBounds:function(s){var l=this._tileCoordsToNwSe(s),m=new Ae(l[0],l[1]);return this.options.noWrap||(m=this._map.wrapLatLngBounds(m)),m},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var l=s.split(":"),m=new Z(+l[0],+l[1]);return m.z=+l[2],m},_removeTile:function(s){var l=this._tiles[s];l&&(Ge(l.el),delete this._tiles[s],this.fire("tileunload",{tile:l.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){Te(s,"leaflet-tile");var l=this.getTileSize();s.style.width=l.x+"px",s.style.height=l.y+"px",s.onselectstart=y,s.onmousemove=y,ue.ielt9&&this.options.opacity<1&&st(s,this.options.opacity)},_addTile:function(s,l){var m=this._getTilePos(s),_=this._tileCoordsToKey(s),E=this.createTile(this._wrapCoords(s),a(this._tileReady,this,s));this._initTile(E),this.createTile.length<2&&B(a(this._tileReady,this,s,null,E)),me(E,m),this._tiles[_]={el:E,coords:s,current:!0},l.appendChild(E),this.fire("tileloadstart",{tile:E,coords:s})},_tileReady:function(s,l,m){l&&this.fire("tileerror",{error:l,tile:m,coords:s});var _=this._tileCoordsToKey(s);m=this._tiles[_],m&&(m.loaded=+new Date,this._map._fadeAnimated?(st(m.el,0),U(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this)):(m.active=!0,this._pruneTiles()),l||(Te(m.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:m.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ue.ielt9||!this._map._fadeAnimated?B(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var l=new Z(this._wrapX?g(s.x,this._wrapX):s.x,this._wrapY?g(s.y,this._wrapY):s.y);return l.z=s.z,l},_pxBoundsToTileRange:function(s){var l=this.getTileSize();return new pe(s.min.unscaleBy(l).floor(),s.max.unscaleBy(l).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function XC(s){return new wa(s)}var Oo=wa.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,l){this._url=s,l=b(this,l),l.detectRetina&&ue.retina&&l.maxZoom>0?(l.tileSize=Math.floor(l.tileSize/2),l.zoomReverse?(l.zoomOffset--,l.minZoom=Math.min(l.maxZoom,l.minZoom+1)):(l.zoomOffset++,l.maxZoom=Math.max(l.minZoom,l.maxZoom-1)),l.minZoom=Math.max(0,l.minZoom)):l.zoomReverse?l.minZoom=Math.min(l.maxZoom,l.minZoom):l.maxZoom=Math.max(l.minZoom,l.maxZoom),typeof l.subdomains=="string"&&(l.subdomains=l.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,l){return this._url===s&&l===void 0&&(l=!0),this._url=s,l||this.redraw(),this},createTile:function(s,l){var m=document.createElement("img");return de(m,"load",a(this._tileOnLoad,this,l,m)),de(m,"error",a(this._tileOnError,this,l,m)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(m.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(m.referrerPolicy=this.options.referrerPolicy),m.alt="",m.src=this.getTileUrl(s),m},getTileUrl:function(s){var l={r:ue.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var m=this._globalTileRange.max.y-s.y;this.options.tms&&(l.y=m),l["-y"]=m}return x(this._url,r(l,this.options))},_tileOnLoad:function(s,l){ue.ielt9?setTimeout(a(s,this,null,l),0):s(null,l)},_tileOnError:function(s,l,m){var _=this.options.errorTileUrl;_&&l.getAttribute("src")!==_&&(l.src=_),s(m,l)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,l=this.options.maxZoom,m=this.options.zoomReverse,_=this.options.zoomOffset;return m&&(s=l-s),s+_},_getSubdomain:function(s){var l=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[l]},_abortLoading:function(){var s,l;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(l=this._tiles[s].el,l.onload=y,l.onerror=y,!l.complete)){l.src=W;var m=this._tiles[s].coords;Ge(l),delete this._tiles[s],this.fire("tileabort",{tile:l,coords:m})}},_removeTile:function(s){var l=this._tiles[s];if(l)return l.el.setAttribute("src",W),wa.prototype._removeTile.call(this,s)},_tileReady:function(s,l,m){if(!(!this._map||m&&m.getAttribute("src")===W))return wa.prototype._tileReady.call(this,s,l,m)}});function ig(s,l){return new Oo(s,l)}var rg=Oo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,l){this._url=s;var m=r({},this.defaultWmsParams);for(var _ in l)_ in this.options||(m[_]=l[_]);l=b(this,l);var E=l.detectRetina&&ue.retina?2:1,S=this.getTileSize();m.width=S.x*E,m.height=S.y*E,this.wmsParams=m},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var l=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[l]=this._crs.code,Oo.prototype.onAdd.call(this,s)},getTileUrl:function(s){var l=this._tileCoordsToNwSe(s),m=this._crs,_=Ee(m.project(l[0]),m.project(l[1])),E=_.min,S=_.max,O=(this._wmsVersion>=1.3&&this._crs===ht?[E.y,E.x,S.y,S.x]:[E.x,E.y,S.x,S.y]).join(","),G=Oo.prototype.getTileUrl.call(this,s);return G+q(this.wmsParams,G,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+O},setParams:function(s,l){return r(this.wmsParams,s),l||this.redraw(),this}});function jC(s,l){return new rg(s,l)}Oo.WMS=rg,ig.wms=jC;var yi=He.extend({options:{padding:.1},initialize:function(s){b(this,s),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Te(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,l){var m=this._map.getZoomScale(l,this._zoom),_=this._map.getSize().multiplyBy(.5+this.options.padding),E=this._map.project(this._center,l),S=_.multiplyBy(-m).add(E).subtract(this._map._getNewPixelOrigin(s,l));ue.any3d?Kn(this._container,S,m):me(this._container,S)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,l=this._map.getSize(),m=this._map.containerPointToLayerPoint(l.multiplyBy(-s)).round();this._bounds=new pe(m,m.add(l.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),og=yi.extend({options:{tolerance:0},getEvents:function(){var s=yi.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){yi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");de(s,"mousemove",this._onMouseMove,this),de(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),de(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){U(this._redrawRequest),delete this._ctx,Ge(this._container),qe(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var l in this._layers)s=this._layers[l],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){yi.prototype._update.call(this);var s=this._bounds,l=this._container,m=s.getSize(),_=ue.retina?2:1;me(l,s.min),l.width=_*m.x,l.height=_*m.y,l.style.width=m.x+"px",l.style.height=m.y+"px",ue.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){yi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[d(s)]=s;var l=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=l),this._drawLast=l,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var l=s._order,m=l.next,_=l.prev;m?m.prev=_:this._drawLast=_,_?_.next=m:this._drawFirst=m,delete s._order,delete this._layers[d(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var l=s.options.dashArray.split(/[, ]+/),m=[],_,E;for(E=0;E<l.length;E++){if(_=Number(l[E]),isNaN(_))return;m.push(_)}s.options._dashArray=m}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||B(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var l=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new pe,this._redrawBounds.extend(s._pxBounds.min.subtract([l,l])),this._redrawBounds.extend(s._pxBounds.max.add([l,l]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var l=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,l.x,l.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,l=this._redrawBounds;if(this._ctx.save(),l){var m=l.getSize();this._ctx.beginPath(),this._ctx.rect(l.min.x,l.min.y,m.x,m.y),this._ctx.clip()}this._drawing=!0;for(var _=this._drawFirst;_;_=_.next)s=_.layer,(!l||s._pxBounds&&s._pxBounds.intersects(l))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,l){if(this._drawing){var m,_,E,S,O=s._parts,G=O.length,$=this._ctx;if(G){for($.beginPath(),m=0;m<G;m++){for(_=0,E=O[m].length;_<E;_++)S=O[m][_],$[_?"lineTo":"moveTo"](S.x,S.y);l&&$.closePath()}this._fillStroke($,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var l=s._point,m=this._ctx,_=Math.max(Math.round(s._radius),1),E=(Math.max(Math.round(s._radiusY),1)||_)/_;E!==1&&(m.save(),m.scale(1,E)),m.beginPath(),m.arc(l.x,l.y/E,_,0,Math.PI*2,!1),E!==1&&m.restore(),this._fillStroke(m,s)}},_fillStroke:function(s,l){var m=l.options;m.fill&&(s.globalAlpha=m.fillOpacity,s.fillStyle=m.fillColor||m.color,s.fill(m.fillRule||"evenodd")),m.stroke&&m.weight!==0&&(s.setLineDash&&s.setLineDash(l.options&&l.options._dashArray||[]),s.globalAlpha=m.opacity,s.lineWidth=m.weight,s.strokeStyle=m.color,s.lineCap=m.lineCap,s.lineJoin=m.lineJoin,s.stroke())},_onClick:function(s){for(var l=this._map.mouseEventToLayerPoint(s),m,_,E=this._drawFirst;E;E=E.next)m=E.layer,m.options.interactive&&m._containsPoint(l)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(m))&&(_=m);this._fireEvent(_?[_]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var l=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,l)}},_handleMouseOut:function(s){var l=this._hoveredLayer;l&&(Qe(this._container,"leaflet-interactive"),this._fireEvent([l],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,l){if(!this._mouseHoverThrottled){for(var m,_,E=this._drawFirst;E;E=E.next)m=E.layer,m.options.interactive&&m._containsPoint(l)&&(_=m);_!==this._hoveredLayer&&(this._handleMouseOut(s),_&&(Te(this._container,"leaflet-interactive"),this._fireEvent([_],s,"mouseover"),this._hoveredLayer=_)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,l,m){this._map._fireDOMEvent(l,m||l.type,s)},_bringToFront:function(s){var l=s._order;if(l){var m=l.next,_=l.prev;if(m)m.prev=_;else return;_?_.next=m:m&&(this._drawFirst=m),l.prev=this._drawLast,this._drawLast.next=l,l.next=null,this._drawLast=l,this._requestRedraw(s)}},_bringToBack:function(s){var l=s._order;if(l){var m=l.next,_=l.prev;if(_)_.next=m;else return;m?m.prev=_:_&&(this._drawLast=_),l.prev=null,l.next=this._drawFirst,this._drawFirst.prev=l,this._drawFirst=l,this._requestRedraw(s)}}});function sg(s){return ue.canvas?new og(s):null}var Ca=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),eI={_initContainer:function(){this._container=Pe("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(yi.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var l=s._container=Ca("shape");Te(l,"leaflet-vml-shape "+(this.options.className||"")),l.coordsize="1 1",s._path=Ca("path"),l.appendChild(s._path),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){var l=s._container;this._container.appendChild(l),s.options.interactive&&s.addInteractiveTarget(l)},_removePath:function(s){var l=s._container;Ge(l),s.removeInteractiveTarget(l),delete this._layers[d(s)]},_updateStyle:function(s){var l=s._stroke,m=s._fill,_=s.options,E=s._container;E.stroked=!!_.stroke,E.filled=!!_.fill,_.stroke?(l||(l=s._stroke=Ca("stroke")),E.appendChild(l),l.weight=_.weight+"px",l.color=_.color,l.opacity=_.opacity,_.dashArray?l.dashStyle=R(_.dashArray)?_.dashArray.join(" "):_.dashArray.replace(/( *, *)/g," "):l.dashStyle="",l.endcap=_.lineCap.replace("butt","flat"),l.joinstyle=_.lineJoin):l&&(E.removeChild(l),s._stroke=null),_.fill?(m||(m=s._fill=Ca("fill")),E.appendChild(m),m.color=_.fillColor||_.color,m.opacity=_.fillOpacity):m&&(E.removeChild(m),s._fill=null)},_updateCircle:function(s){var l=s._point.round(),m=Math.round(s._radius),_=Math.round(s._radiusY||m);this._setPath(s,s._empty()?"M0 0":"AL "+l.x+","+l.y+" "+m+","+_+" 0,"+65535*360)},_setPath:function(s,l){s._path.v=l},_bringToFront:function(s){di(s._container)},_bringToBack:function(s){Oi(s._container)}},Mu=ue.vml?Ca:uo,Ia=yi.extend({_initContainer:function(){this._container=Mu("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Mu("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Ge(this._container),qe(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){yi.prototype._update.call(this);var s=this._bounds,l=s.getSize(),m=this._container;(!this._svgSize||!this._svgSize.equals(l))&&(this._svgSize=l,m.setAttribute("width",l.x),m.setAttribute("height",l.y)),me(m,s.min),m.setAttribute("viewBox",[s.min.x,s.min.y,l.x,l.y].join(" ")),this.fire("update")}},_initPath:function(s){var l=s._path=Mu("path");s.options.className&&Te(l,s.options.className),s.options.interactive&&Te(l,"leaflet-interactive"),this._updateStyle(s),this._layers[d(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){Ge(s._path),s.removeInteractiveTarget(s._path),delete this._layers[d(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var l=s._path,m=s.options;l&&(m.stroke?(l.setAttribute("stroke",m.color),l.setAttribute("stroke-opacity",m.opacity),l.setAttribute("stroke-width",m.weight),l.setAttribute("stroke-linecap",m.lineCap),l.setAttribute("stroke-linejoin",m.lineJoin),m.dashArray?l.setAttribute("stroke-dasharray",m.dashArray):l.removeAttribute("stroke-dasharray"),m.dashOffset?l.setAttribute("stroke-dashoffset",m.dashOffset):l.removeAttribute("stroke-dashoffset")):l.setAttribute("stroke","none"),m.fill?(l.setAttribute("fill",m.fillColor||m.color),l.setAttribute("fill-opacity",m.fillOpacity),l.setAttribute("fill-rule",m.fillRule||"evenodd")):l.setAttribute("fill","none"))},_updatePoly:function(s,l){this._setPath(s,Gs(s._parts,l))},_updateCircle:function(s){var l=s._point,m=Math.max(Math.round(s._radius),1),_=Math.max(Math.round(s._radiusY),1)||m,E="a"+m+","+_+" 0 1,0 ",S=s._empty()?"M0 0":"M"+(l.x-m)+","+l.y+E+m*2+",0 "+E+-m*2+",0 ";this._setPath(s,S)},_setPath:function(s,l){s._path.setAttribute("d",l)},_bringToFront:function(s){di(s._path)},_bringToBack:function(s){Oi(s._path)}});ue.vml&&Ia.include(eI);function ag(s){return ue.svg||ue.vml?new Ia(s):null}Se.include({getRenderer:function(s){var l=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return l||(l=this._renderer=this._createRenderer()),this.hasLayer(l)||this.addLayer(l),l},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var l=this._paneRenderers[s];return l===void 0&&(l=this._createRenderer({pane:s}),this._paneRenderers[s]=l),l},_createRenderer:function(s){return this.options.preferCanvas&&sg(s)||ag(s)}});var lg=Fo.extend({initialize:function(s,l){Fo.prototype.initialize.call(this,this._boundsToLatLngs(s),l)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=Ue(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function tI(s,l){return new lg(s,l)}Ia.create=Mu,Ia.pointsToPath=Gs,_i.geometryToLayer=Su,_i.coordsToLatLng=Jd,_i.coordsToLatLngs=xu,_i.latLngToCoords=Zd,_i.latLngsToCoords=Au,_i.getFeature=Uo,_i.asFeature=Pu,Se.mergeOptions({boxZoom:!0});var ug=an.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){de(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){qe(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Ge(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ln(),aa(),this._startPoint=this._map.mouseEventToContainerPoint(s),de(document,{contextmenu:sn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Pe("div","leaflet-zoom-box",this._container),Te(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var l=new pe(this._point,this._startPoint),m=l.getSize();me(this._box,l.min),this._box.style.width=m.x+"px",this._box.style.height=m.y+"px"},_finish:function(){this._moved&&(Ge(this._box),Qe(this._container,"leaflet-crosshair")),Dn(),la(),qe(document,{contextmenu:sn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var l=new Ae(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(l).fire("boxzoomend",{boxZoomBounds:l})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Se.addInitHook("addHandler","boxZoom",ug),Se.mergeOptions({doubleClickZoom:!0});var cg=an.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var l=this._map,m=l.getZoom(),_=l.options.zoomDelta,E=s.originalEvent.shiftKey?m-_:m+_;l.options.doubleClickZoom==="center"?l.setZoom(E):l.setZoomAround(s.containerPoint,E)}});Se.addInitHook("addHandler","doubleClickZoom",cg),Se.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var dg=an.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Vn(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}Te(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Qe(this._map._container,"leaflet-grab"),Qe(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var l=Ue(this._map.options.maxBounds);this._offsetLimit=Ee(this._map.latLngToContainerPoint(l.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(l.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var l=this._lastTime=+new Date,m=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(m),this._times.push(l),this._prunePositions(l)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),l=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=l.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,l){return s-(s-l)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),l=this._offsetLimit;s.x<l.min.x&&(s.x=this._viscousLimit(s.x,l.min.x)),s.y<l.min.y&&(s.y=this._viscousLimit(s.y,l.min.y)),s.x>l.max.x&&(s.x=this._viscousLimit(s.x,l.max.x)),s.y>l.max.y&&(s.y=this._viscousLimit(s.y,l.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,l=Math.round(s/2),m=this._initialWorldOffset,_=this._draggable._newPos.x,E=(_-l+m)%s+l-m,S=(_+l+m)%s-l-m,O=Math.abs(E+m)<Math.abs(S+m)?E:S;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=O},_onDragEnd:function(s){var l=this._map,m=l.options,_=!m.inertia||s.noInertia||this._times.length<2;if(l.fire("dragend",s),_)l.fire("moveend");else{this._prunePositions(+new Date);var E=this._lastPos.subtract(this._positions[0]),S=(this._lastTime-this._times[0])/1e3,O=m.easeLinearity,G=E.multiplyBy(O/S),$=G.distanceTo([0,0]),Q=Math.min(m.inertiaMaxSpeed,$),re=G.multiplyBy(Q/$),he=Q/(m.inertiaDeceleration*O),Ie=re.multiplyBy(-he/2).round();!Ie.x&&!Ie.y?l.fire("moveend"):(Ie=l._limitOffset(Ie,l.options.maxBounds),B(function(){l.panBy(Ie,{duration:he,easeLinearity:O,noMoveStart:!0,animate:!0})}))}}});Se.addInitHook("addHandler","dragging",dg),Se.mergeOptions({keyboard:!0,keyboardPanDelta:80});var hg=an.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),de(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),qe(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,l=document.documentElement,m=s.scrollTop||l.scrollTop,_=s.scrollLeft||l.scrollLeft;this._map._container.focus(),window.scrollTo(_,m)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var l=this._panKeys={},m=this.keyCodes,_,E;for(_=0,E=m.left.length;_<E;_++)l[m.left[_]]=[-1*s,0];for(_=0,E=m.right.length;_<E;_++)l[m.right[_]]=[s,0];for(_=0,E=m.down.length;_<E;_++)l[m.down[_]]=[0,s];for(_=0,E=m.up.length;_<E;_++)l[m.up[_]]=[0,-1*s]},_setZoomDelta:function(s){var l=this._zoomKeys={},m=this.keyCodes,_,E;for(_=0,E=m.zoomIn.length;_<E;_++)l[m.zoomIn[_]]=s;for(_=0,E=m.zoomOut.length;_<E;_++)l[m.zoomOut[_]]=-s},_addHooks:function(){de(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){qe(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var l=s.keyCode,m=this._map,_;if(l in this._panKeys){if(!m._panAnim||!m._panAnim._inProgress)if(_=this._panKeys[l],s.shiftKey&&(_=ee(_).multiplyBy(3)),m.options.maxBounds&&(_=m._limitOffset(ee(_),m.options.maxBounds)),m.options.worldCopyJump){var E=m.wrapLatLng(m.unproject(m.project(m.getCenter()).add(_)));m.panTo(E)}else m.panBy(_)}else if(l in this._zoomKeys)m.setZoom(m.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[l]);else if(l===27&&m._popup&&m._popup.options.closeOnEscapeKey)m.closePopup();else return;sn(s)}}});Se.addInitHook("addHandler","keyboard",hg),Se.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var fg=an.extend({addHooks:function(){de(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){qe(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var l=gu(s),m=this._map.options.wheelDebounceTime;this._delta+=l,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var _=Math.max(m-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),_),sn(s)},_performZoom:function(){var s=this._map,l=s.getZoom(),m=this._map.options.zoomSnap||0;s._stop();var _=this._delta/(this._map.options.wheelPxPerZoomLevel*4),E=4*Math.log(2/(1+Math.exp(-Math.abs(_))))/Math.LN2,S=m?Math.ceil(E/m)*m:E,O=s._limitZoom(l+(this._delta>0?S:-S))-l;this._delta=0,this._startTime=null,O&&(s.options.scrollWheelZoom==="center"?s.setZoom(l+O):s.setZoomAround(this._lastMousePos,l+O))}});Se.addInitHook("addHandler","scrollWheelZoom",fg);var nI=600;Se.mergeOptions({tapHold:ue.touchNative&&ue.safari&&ue.mobile,tapTolerance:15});var pg=an.extend({addHooks:function(){de(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){qe(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var l=s.touches[0];this._startPos=this._newPos=new Z(l.clientX,l.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(de(document,"touchend",et),de(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",l))},this),nI),de(document,"touchend touchcancel contextmenu",this._cancel,this),de(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){qe(document,"touchend",et),qe(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),qe(document,"touchend touchcancel contextmenu",this._cancel,this),qe(document,"touchmove",this._onMove,this)},_onMove:function(s){var l=s.touches[0];this._newPos=new Z(l.clientX,l.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,l){var m=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:l.screenX,screenY:l.screenY,clientX:l.clientX,clientY:l.clientY});m._simulated=!0,l.target.dispatchEvent(m)}});Se.addInitHook("addHandler","tapHold",pg),Se.mergeOptions({touchZoom:ue.touch,bounceAtZoomLimits:!0});var mg=an.extend({addHooks:function(){Te(this._map._container,"leaflet-touch-zoom"),de(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Qe(this._map._container,"leaflet-touch-zoom"),qe(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var l=this._map;if(!(!s.touches||s.touches.length!==2||l._animatingZoom||this._zooming)){var m=l.mouseEventToContainerPoint(s.touches[0]),_=l.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=l.getSize()._divideBy(2),this._startLatLng=l.containerPointToLatLng(this._centerPoint),l.options.touchZoom!=="center"&&(this._pinchStartLatLng=l.containerPointToLatLng(m.add(_)._divideBy(2))),this._startDist=m.distanceTo(_),this._startZoom=l.getZoom(),this._moved=!1,this._zooming=!0,l._stop(),de(document,"touchmove",this._onTouchMove,this),de(document,"touchend touchcancel",this._onTouchEnd,this),et(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var l=this._map,m=l.mouseEventToContainerPoint(s.touches[0]),_=l.mouseEventToContainerPoint(s.touches[1]),E=m.distanceTo(_)/this._startDist;if(this._zoom=l.getScaleZoom(E,this._startZoom),!l.options.bounceAtZoomLimits&&(this._zoom<l.getMinZoom()&&E<1||this._zoom>l.getMaxZoom()&&E>1)&&(this._zoom=l._limitZoom(this._zoom)),l.options.touchZoom==="center"){if(this._center=this._startLatLng,E===1)return}else{var S=m._add(_)._divideBy(2)._subtract(this._centerPoint);if(E===1&&S.x===0&&S.y===0)return;this._center=l.unproject(l.project(this._pinchStartLatLng,this._zoom).subtract(S),this._zoom)}this._moved||(l._moveStart(!0,!1),this._moved=!0),U(this._animRequest);var O=a(l._move,l,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=B(O,this,!0),et(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,U(this._animRequest),qe(document,"touchmove",this._onTouchMove,this),qe(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Se.addInitHook("addHandler","touchZoom",mg),Se.BoxZoom=ug,Se.DoubleClickZoom=cg,Se.Drag=dg,Se.Keyboard=hg,Se.ScrollWheelZoom=fg,Se.TapHold=pg,Se.TouchZoom=mg,n.Bounds=pe,n.Browser=ue,n.CRS=_t,n.Canvas=og,n.Circle=Kd,n.CircleMarker=Iu,n.Class=le,n.Control=Zt,n.DivIcon=ng,n.DivOverlay=Yn,n.DomEvent=_u,n.DomUtil=pu,n.Draggable=Vn,n.Evented=Fe,n.FeatureGroup=lt,n.GeoJSON=_i,n.GridLayer=wa,n.Handler=an,n.Icon=Zn,n.ImageOverlay=Ru,n.LatLng=Ce,n.LatLngBounds=Ae,n.Layer=He,n.LayerGroup=tt,n.LineUtil=P,n.Map=Se,n.Marker=Cu,n.Mixin=Vr,n.Path=Wi,n.Point=Z,n.PolyUtil=Do,n.Polygon=Fo,n.Polyline=gi,n.Popup=Nu,n.PosAnimation=ma,n.Projection=te,n.Rectangle=lg,n.Renderer=yi,n.SVG=Ia,n.SVGOverlay=tg,n.TileLayer=Oo,n.Tooltip=ku,n.Transformation=bi,n.Util=M,n.VideoOverlay=eg,n.bind=a,n.bounds=Ee,n.canvas=sg,n.circle=qC,n.circleMarker=zC,n.control=Ht,n.divIcon=QC,n.extend=r,n.featureGroup=bo,n.geoJSON=jm,n.geoJson=WC,n.gridLayer=XC,n.icon=OC,n.imageOverlay=$C,n.latLng=_e,n.latLngBounds=Ue,n.layerGroup=Gi,n.map=Po,n.marker=BC,n.point=ee,n.polygon=GC,n.polyline=HC,n.popup=ZC,n.rectangle=tI,n.setOptions=b,n.stamp=d,n.svg=ag,n.svgOverlay=JC,n.tileLayer=ig,n.tooltip=YC,n.transformation=ai,n.version=i,n.videoOverlay=KC;var iI=window.L;n.noConflict=function(){return window.L=iI,this},window.L=n})})(rp,rp.exports);var lo=rp.exports;const bl=i0(lo);function Ql(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function Hd(t,e){return e==null?function(i,r){const o=ne.useRef();return o.current||(o.current=t(i,r)),o}:function(i,r){const o=ne.useRef();o.current||(o.current=t(i,r));const a=ne.useRef(i),{instance:u}=o.current;return ne.useEffect(function(){a.current!==i&&(e(u,i,a.current),a.current=i)},[u,i,r]),o}}function VC(t,e){ne.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var o;(o=e.layerContainer)==null||o.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function bC(t){return function(n){const i=zd(),r=t(qd(n,i),i);return kC(i.map,n.attribution),Ym(r.current,n.eventHandlers),VC(r.current,i),r}}function Kb(t,e){const n=ne.useRef();ne.useEffect(function(){if(e.pathOptions!==n.current){const r=e.pathOptions??{};t.instance.setStyle(r),n.current=r}},[t,e])}function Jb(t){return function(n){const i=zd(),r=t(qd(n,i),i);return Ym(r.current,n.eventHandlers),VC(r.current,i),Kb(r.current,n),r}}function Zb(t,e){const n=Hd(t,e),i=bC(n);return DC(i)}function Yb(t,e){const n=Hd(t),i=$b(n,e);return Gb(i)}function FC(t,e){const n=Hd(t,e),i=Jb(n);return DC(i)}function Qb(t,e){const n=Hd(t,e),i=bC(n);return Wb(i)}function Xb(t,e,n){const{opacity:i,zIndex:r}=e;i!=null&&i!==n.opacity&&t.setOpacity(i),r!=null&&r!==n.zIndex&&t.setZIndex(r)}function jb(){return zd().map}const eF=FC(function({center:e,children:n,...i},r){const o=new lo.Circle(e,i);return Ql(o,Zm(r,{overlayContainer:o}))},zb);function op(){return op=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},op.apply(this,arguments)}function tF({bounds:t,boundsOptions:e,center:n,children:i,className:r,id:o,placeholder:a,style:u,whenReady:d,zoom:p,...g},y){const[T]=ne.useState({className:r,id:o,style:u}),[I,V]=ne.useState(null);ne.useImperativeHandle(y,()=>(I==null?void 0:I.map)??null,[I]);const b=ne.useCallback(A=>{if(A!==null&&I===null){const x=new lo.Map(A,g);n!=null&&p!=null?x.setView(n,p):t!=null&&x.fitBounds(t,e),d!=null&&x.whenReady(d),V(Hb(x))}},[]);ne.useEffect(()=>()=>{I==null||I.map.remove()},[I]);const q=I?ms.createElement(LC,{value:I},i):a??null;return ms.createElement("div",op({},T,{ref:b}),q)}const nF=ne.forwardRef(tF),Lh=Zb(function({position:e,...n},i){const r=new lo.Marker(e,n);return Ql(r,Zm(i,{overlayContainer:r}))},function(e,n,i){n.position!==i.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==i.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==i.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==i.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==i.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),nc=FC(function({positions:e,...n},i){const r=new lo.Polyline(e,n);return Ql(r,Zm(i,{overlayContainer:r}))},function(e,n,i){n.positions!==i.positions&&e.setLatLngs(n.positions)}),ba=Yb(function(e,n){const i=new lo.Popup(e,n.overlayContainer);return Ql(i,n)},function(e,n,{position:i},r){ne.useEffect(function(){const{instance:a}=e;function u(p){p.popup===a&&(a.update(),r(!0))}function d(p){p.popup===a&&r(!1)}return n.map.on({popupopen:u,popupclose:d}),n.overlayContainer==null?(i!=null&&a.setLatLng(i),a.openOn(n.map)):n.overlayContainer.bindPopup(a),function(){var g;n.map.off({popupopen:u,popupclose:d}),(g=n.overlayContainer)==null||g.unbindPopup(),n.map.removeLayer(a)}},[e,n,r,i])}),iF=Qb(function({url:e,...n},i){const r=new lo.TileLayer(e,qd(n,i));return Ql(r,i)},function(e,n,i){Xb(e,n,i);const{url:r}=n;r!=null&&r!==i.url&&e.setUrl(r)});try{delete bl.Icon.Default.prototype._getIconUrl,bl.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"})}catch(t){console.warn("Leaflet icon fix warning:",t)}const rF=(t,e)=>bl.divIcon({className:"custom-div-icon",html:`<div style="background-color: ${e?"#22d3ee":"#374151"}; color: ${e?"#000":"#fff"}; width: 24px; height: 24px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">${t}</div>`,iconSize:[24,24],iconAnchor:[12,12]}),oF=bl.divIcon({className:"pulsing-user-marker",html:`
      <div class="relative w-8 h-8 flex items-center justify-center">
        <div class="absolute w-full h-full bg-blue-500 rounded-full opacity-30 animate-ping"></div>
        <div class="relative w-4 h-4 bg-blue-500 border-2 border-white rounded-full shadow-lg"></div>
      </div>
    `,iconSize:[32,32],iconAnchor:[16,16]}),sF=bl.divIcon({className:"bg-transparent",html:'<div style="color: #facc15; filter: drop-shadow(0 0 2px rgba(0,0,0,0.5));"><svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg></div>',iconSize:[28,28],iconAnchor:[14,28]}),Cn=(t,e)=>{const n=Number(t),i=Number(e);return!isNaN(n)&&!isNaN(i)&&n!==0&&i!==0},aF=({userLocation:t,firstLoad:e})=>{const n=jb();return ne.useEffect(()=>{e&&Cn(t[0],t[1])&&n.flyTo(t,16,{animate:!0,duration:2})},[e,t,n]),null},lF=({onClick:t})=>C.jsx("button",{onClick:t,className:"absolute bottom-6 right-6 z-[1000] bg-white p-3 rounded-full shadow-lg text-slate-700 hover:text-blue-600 hover:bg-slate-50 transition-all focus:outline-none focus:ring-2 focus:ring-blue-500",title:"My Location","aria-label":"Center map on my location",children:C.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),uF=({userLocation:t,userLocationAccuracy:e,steps:n=[],landmarks:i=[],traffic:r=[],currentStepIndex:o=0,itineraryLocations:a=[],itineraryLines:u=[],highlightedItineraryIndex:d=null})=>{var b,q;const[p,g]=ms.useState(null),[y,T]=ms.useState(!0);ne.useEffect(()=>{if(y&&Cn(t[0],t[1])){const A=setTimeout(()=>T(!1),3e3);return()=>clearTimeout(A)}},[t,y]);const I=((q=(b=n[o])==null?void 0:b.path)==null?void 0:q.filter(A=>Cn(A.lat,A.lng)).map(A=>[A.lat,A.lng]))||[],V=()=>{p&&Cn(t[0],t[1])&&p.flyTo(t,18,{animate:!0})};return C.jsxs("div",{className:"h-[400px] w-full rounded-lg overflow-hidden border border-gray-700 shadow-lg relative z-0",children:[C.jsxs(nF,{center:Cn(t[0],t[1])?t:[20.4795,85.8778],zoom:16,style:{height:"100%",width:"100%"},className:"z-0",ref:g,children:[C.jsx(iF,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors  <a href="https://carto.com/attributions">CARTO</a>',url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png"}),C.jsx(aF,{userLocation:t,firstLoad:y}),Cn(t[0],t[1])&&C.jsxs(C.Fragment,{children:[C.jsx(Lh,{position:t,icon:oF,children:C.jsx(ba,{children:"You are here"})}),e&&C.jsx(eF,{center:t,radius:e,pathOptions:{color:"#3b82f6",fillColor:"#3b82f6",fillOpacity:.1,weight:1,opacity:.3}})]}),n.map((A,x)=>{var z;const R=((z=A.path)==null?void 0:z.filter(W=>Cn(W.lat,W.lng)).map(W=>[W.lat,W.lng]))||[];return R.length<2?null:C.jsx(nc,{positions:R,pathOptions:{color:"#6b7280",weight:4,opacity:.5}},`bg-${x}`)}),r.map((A,x)=>{var W;const R=((W=A.path)==null?void 0:W.filter(J=>Cn(J.lat,J.lng)).map(J=>[J.lat,J.lng]))||[];if(R.length<2)return null;const z=A.level==="heavy"?"#ef4444":A.level==="moderate"?"#eab308":"#22c55e";return C.jsx(nc,{positions:R,pathOptions:{color:z,weight:6,opacity:.7},children:C.jsxs(ba,{children:[A.description," (",A.level," traffic)"]})},`traffic-${x}`)}),I.length>1&&C.jsx(nc,{positions:I,pathOptions:{color:"#06b6d4",weight:6,opacity:.9}}),i.map((A,x)=>{var R,z;return Cn((R=A.position)==null?void 0:R.lat,(z=A.position)==null?void 0:z.lng)?C.jsx(Lh,{position:[A.position.lat,A.position.lng],icon:sF,children:C.jsx(ba,{children:A.name})},`lm-${x}`):null}),u.map((A,x)=>{var R,z,W,J;return!Cn((R=A.start)==null?void 0:R.lat,(z=A.start)==null?void 0:z.lng)||!Cn((W=A.end)==null?void 0:W.lat,(J=A.end)==null?void 0:J.lng)?null:C.jsx(nc,{positions:[[A.start.lat,A.start.lng],[A.end.lat,A.end.lng]],pathOptions:{color:"#3b82f6",weight:3,dashArray:"10, 10",opacity:.8},children:C.jsxs(ba,{children:[C.jsx("strong",{children:A.name}),C.jsx("br",{}),A.transport," (",A.travelTime,")"]})},`line-${x}`)}),a.map((A,x)=>{if(!Cn(A.lat,A.lng))return null;const R=d===x;return C.jsx(Lh,{position:[A.lat,A.lng],icon:rF(A.sequence||x+1,R),zIndexOffset:R?1e3:0,children:C.jsxs(ba,{children:[C.jsxs("strong",{children:[A.sequence,". ",A.name]}),C.jsx("br",{}),A.time," - ",A.description]})},`loc-${x}`)})]}),C.jsx(lF,{onClick:V})]})},t0=({chunks:t})=>{if(!t||t.length===0)return null;const e=t.filter(n=>{var i,r;return((i=n.web)==null?void 0:i.uri)||((r=n.maps)==null?void 0:r.uri)});return C.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[C.jsxs("h4",{className:"font-semibold text-slate-700 flex items-center gap-2 text-sm uppercase tracking-wide",children:[C.jsx(Gx,{})," Sources:"]}),C.jsx("ul",{className:"list-disc list-inside mt-2 space-y-1 text-sm text-slate-600",children:e.map((n,i)=>{const r=n.web||n.maps;return r?C.jsx("li",{children:C.jsx("a",{href:r.uri,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline hover:text-blue-800",children:r.title||"Source link"})},i):null})})]})},n0=({onClick:t,disabled:e,children:n})=>C.jsx("button",{onClick:t,disabled:e,className:"bg-white border border-slate-300 hover:bg-slate-50 disabled:bg-slate-100 disabled:text-slate-400 disabled:cursor-not-allowed text-slate-700 font-bold py-2 px-4 rounded-lg flex items-center justify-center transition-colors shadow-sm",children:n}),cF=({location:t,manualLocation:e,language:n})=>{const[i,r]=ne.useState("route"),[o,a]=ne.useState(""),[u,d]=ne.useState(""),[p,g]=ne.useState(""),[y,T]=ne.useState(!1),[I,V]=ne.useState(null),[b,q]=ne.useState(null),[A,x]=ne.useState(0),[R,z]=ne.useState(null),[W,J]=ne.useState([]),k=Ls[n];ne.useEffect(()=>{try{const M=localStorage.getItem("scb_navi_saved_routes");M&&J(JSON.parse(M))}catch(M){console.error("Failed to load saved routes:",M)}},[]);const N=()=>{if(!I)return;const M=i==="route"?`Route to ${o}`:`Day Plan - ${new Date().toLocaleDateString()}`,le=window.prompt("Enter a name for this plan:",M);if(le){const we=[{id:Date.now().toString(),name:le,timestamp:Date.now(),mode:i,result:I,destination:i==="route"?o:void 0,notes:i==="route"?u:void 0,dayPlanPrompt:i==="dayPlan"?p:void 0},...W];J(we),localStorage.setItem("scb_navi_saved_routes",JSON.stringify(we)),alert("Plan saved successfully!")}},D=(M,le)=>{if(le.stopPropagation(),window.confirm("Are you sure you want to delete this saved plan?")){const De=W.filter(we=>we.id!==M);J(De),localStorage.setItem("scb_navi_saved_routes",JSON.stringify(De))}},F=M=>{r(M.mode),V(M.result),M.mode==="route"?(a(M.destination||""),d(M.notes||"")):g(M.dayPlanPrompt||""),x(0),z(null),window.scrollTo({top:0,behavior:"smooth"})},B=async M=>{M.preventDefault(),q(null),V(null),T(!0),x(0),z(null);const le=e||(t.latitude&&t.longitude?"My Current Location":"SCB Medical College Main Gate");try{if(i==="route"){if(!o.trim()){q("Please enter a destination."),T(!1);return}const De=await GM(le,o,u,t.latitude&&t.longitude?{latitude:t.latitude,longitude:t.longitude}:null,n);V({...De,locations:[],lines:[],summaryText:""})}else{if(!p.trim()){q("Please describe your day."),T(!1);return}const De=await HM(p,n);V({text:"",groundingChunks:[],steps:[],landmarks:[],trafficSegments:[],...De})}}catch(De){q("Failed to generate plan. Please try again."),console.error(De)}finally{T(!1)}},U=t.latitude&&t.longitude?[t.latitude,t.longitude]:[20.4795,85.8778];return C.jsxs("div",{className:"animate-fadeIn max-w-2xl mx-auto",children:[C.jsxs("div",{className:"flex justify-center mb-6 space-x-2 bg-slate-200 p-1 rounded-full w-fit mx-auto",children:[C.jsx("button",{onClick:()=>{r("route"),V(null)},className:`px-5 py-2 rounded-full font-bold text-sm transition-all ${i==="route"?"bg-white text-blue-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:k.navMode}),C.jsx("button",{onClick:()=>{r("dayPlan"),V(null)},className:`px-5 py-2 rounded-full font-bold text-sm transition-all ${i==="dayPlan"?"bg-white text-blue-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:k.dayMode})]}),C.jsxs("div",{className:"text-center mb-6",children:[C.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:i==="route"?k.campusNavTitle:k.itineraryTitle}),C.jsx("p",{className:"text-slate-500 mt-1",children:i==="route"?k.navSub:k.daySub})]}),!I&&C.jsxs(C.Fragment,{children:[C.jsxs("form",{onSubmit:B,className:"space-y-4 transition-all duration-500 bg-white p-6 rounded-2xl shadow-sm border border-slate-200",children:[i==="route"?C.jsxs(C.Fragment,{children:[C.jsxs("div",{children:[C.jsx("label",{htmlFor:"destination",className:"block text-sm font-semibold text-slate-700 mb-1",children:k.destLabel}),C.jsx("input",{type:"text",id:"destination",value:o,onChange:M=>a(M.target.value),placeholder:k.destPlace,className:"w-full bg-slate-50 border border-slate-300 text-slate-900 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all placeholder-slate-400"})]}),C.jsxs("div",{children:[C.jsx("label",{htmlFor:"notes",className:"block text-sm font-semibold text-slate-700 mb-1",children:k.notesLabel}),C.jsx("textarea",{id:"notes",value:u,onChange:M=>d(M.target.value),placeholder:k.notesPlace,rows:3,className:"w-full bg-slate-50 border border-slate-300 text-slate-900 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all placeholder-slate-400"})]})]}):C.jsxs("div",{children:[C.jsx("label",{htmlFor:"dayPlan",className:"block text-sm font-semibold text-slate-700 mb-1",children:k.dayPromptLabel}),C.jsx("textarea",{id:"dayPlan",value:p,onChange:M=>g(M.target.value),placeholder:k.dayPromptPlace,rows:5,className:"w-full bg-slate-50 border border-slate-300 text-slate-900 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all placeholder-slate-400"})]}),b&&C.jsx("p",{className:"text-red-600 bg-red-50 p-3 rounded-lg text-sm border border-red-100",children:b}),C.jsx("button",{type:"submit",disabled:y,className:"w-full bg-blue-700 hover:bg-blue-800 text-white font-bold py-3.5 px-4 rounded-xl flex items-center justify-center transition-all shadow-md hover:shadow-lg disabled:bg-slate-300 disabled:shadow-none",children:y?C.jsx(TE,{}):C.jsxs(C.Fragment,{children:[C.jsx(EE,{})," ",C.jsx("span",{className:"ml-2",children:i==="route"?k.findPath:k.genPlan})]})})]}),W.length>0&&!y&&C.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-200",children:[C.jsxs("h3",{className:"text-lg font-bold text-slate-700 mb-4 flex items-center gap-2",children:[C.jsx(Xx,{})," ",k.savedPlans]}),C.jsx("div",{className:"space-y-3",children:W.map(M=>C.jsxs("div",{onClick:()=>F(M),className:"bg-white border border-slate-200 rounded-xl p-4 flex justify-between items-center cursor-pointer transition-all hover:shadow-md hover:border-blue-300 group",children:[C.jsxs("div",{children:[C.jsx("div",{className:"font-bold text-slate-800",children:M.name}),C.jsxs("div",{className:"text-xs text-slate-500 flex gap-2 mt-1",children:[C.jsx("span",{className:"bg-slate-100 px-2 py-0.5 rounded text-slate-600 font-medium capitalize",children:M.mode==="route"?"Navigation":"Itinerary"}),C.jsx("span",{children:new Date(M.timestamp).toLocaleDateString()})]})]}),C.jsx("button",{onClick:le=>D(M.id,le),className:"p-2 text-slate-400 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100 focus:opacity-100",title:"Delete",children:C.jsx(Qx,{})})]},M.id))})]})]}),y&&C.jsxs("div",{className:"text-center mt-8 p-6 bg-white border border-slate-200 rounded-xl shadow-sm",children:[C.jsx("p",{className:"font-bold text-slate-800",children:k.analyzing}),C.jsx("p",{className:"text-sm text-slate-500 mt-2",children:k.connecting})]}),I&&C.jsxs("div",{className:"mt-6 animate-fadeIn space-y-4",children:[C.jsx(uF,{userLocation:U,userLocationAccuracy:t.accuracy,steps:I.steps,landmarks:I.landmarks,traffic:I.trafficSegments,currentStepIndex:A,itineraryLocations:I.locations,itineraryLines:I.lines,highlightedItineraryIndex:R}),i==="route"&&I.steps.length>0&&C.jsxs("div",{className:"p-5 bg-white border border-slate-200 shadow-md rounded-xl text-center relative z-10",children:[C.jsxs("p",{className:"font-bold text-sm uppercase tracking-wide text-blue-600 mb-1",children:[k.step," ",A+1," / ",I.steps.length]}),C.jsx("p",{className:"text-slate-800 text-xl font-medium leading-relaxed",children:I.steps[A].description}),C.jsxs("div",{className:"flex justify-between mt-6",children:[C.jsxs(n0,{onClick:()=>x(M=>Math.max(0,M-1)),disabled:A===0,children:[C.jsx(Wx,{}),C.jsx("span",{className:"ml-2",children:k.prev})]}),C.jsxs(n0,{onClick:()=>x(M=>Math.min(I.steps.length-1,M+1)),disabled:A===I.steps.length-1,children:[C.jsx("span",{className:"mr-2",children:k.next}),C.jsx($x,{})]})]})]}),i==="dayPlan"&&I.locations.length>0&&C.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-6",children:[C.jsx("h3",{className:"text-xl font-bold text-blue-800 border-b border-slate-100 pb-3 mb-4",children:k.yourItinerary}),C.jsxs("div",{className:"space-y-0 relative",children:[C.jsx("div",{className:"absolute left-4 top-4 bottom-4 w-0.5 bg-slate-200"}),I.locations.map((M,le)=>C.jsxs("div",{onClick:()=>z(le),className:`relative pl-10 py-3 cursor-pointer transition-all rounded-r-lg ${R===le?"bg-blue-50 border-l-4 border-blue-500 -ml-[2px]":"hover:bg-slate-50"}`,children:[C.jsx("div",{className:`absolute left-2.5 top-5 w-3 h-3 rounded-full border-2 border-white shadow-sm z-10 ${R===le?"bg-blue-600 scale-125":"bg-slate-400"}`}),C.jsxs("div",{className:"flex justify-between items-start",children:[C.jsxs("div",{children:[C.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:M.name}),C.jsx("p",{className:"text-sm text-slate-500",children:M.description})]}),C.jsxs("div",{className:"text-right flex-shrink-0 ml-2",children:[C.jsx("span",{className:"block text-blue-600 font-mono font-bold bg-blue-50 px-2 py-0.5 rounded text-sm",children:M.time}),C.jsx("span",{className:"block text-xs text-slate-400 mt-1",children:M.duration})]})]})]},le))]}),I.summaryText&&C.jsx("div",{className:"mt-6 p-4 bg-slate-50 rounded-lg text-sm text-slate-600 italic border-l-4 border-slate-300",children:I.summaryText})]}),C.jsxs("details",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[C.jsxs("summary",{className:"cursor-pointer p-4 text-slate-700 font-bold bg-slate-50 hover:bg-slate-100 transition-colors flex justify-between items-center",children:[C.jsx("span",{children:i==="route"?k.viewSummary:k.viewPlanText}),C.jsx("span",{className:"text-slate-400 text-xs",children:""})]}),C.jsxs("div",{className:"p-5 border-t border-slate-200",children:[C.jsx("div",{className:"prose prose-slate prose-sm max-w-none",dangerouslySetInnerHTML:{__html:(I.text||I.summaryText).replace(/\n/g,"<br />")}}),C.jsx(t0,{chunks:I.groundingChunks})]})]}),C.jsxs("div",{className:"flex space-x-3 pt-4",children:[C.jsx("button",{onClick:()=>V(null),className:"flex-1 bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 font-bold py-3 px-4 rounded-xl flex items-center justify-center transition-colors shadow-sm",children:i==="route"?k.planNew:k.createNew}),C.jsxs("button",{onClick:N,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-xl flex items-center justify-center transition-colors shadow-md",children:[C.jsx(Yx,{})," ",C.jsx("span",{className:"ml-2",children:k.savePlan})]})]})]}),I&&i==="route"&&I.steps.length===0&&!y&&C.jsxs("div",{className:"mt-8 text-center",children:[C.jsx("p",{className:"text-orange-600 font-medium bg-orange-50 p-2 rounded-lg inline-block",children:"Could not generate an interactive route. Displaying summary instead."}),C.jsxs("div",{className:"mt-4 p-5 bg-white border border-slate-200 shadow-sm rounded-xl text-left",children:[C.jsx("div",{className:"prose prose-slate prose-sm max-w-none",dangerouslySetInnerHTML:{__html:(I.text||I.summaryText||"").replace(/\n/g,"<br />")}}),C.jsx(t0,{chunks:I.groundingChunks})]}),C.jsx("button",{onClick:()=>V(null),className:"mt-6 w-full bg-slate-100 hover:bg-slate-200 text-slate-800 font-bold py-3 px-4 rounded-xl transition-colors",children:"Start Over"})]})]})},dF=({language:t,location:e})=>{const[n,i]=ne.useState([]),[r,o]=ne.useState(""),[a,u]=ne.useState(!1),d=ne.useRef(null),p=ne.useRef(null),g=Ls[t];ne.useEffect(()=>{try{d.current=$M(t),i([{sender:"bot",text:g.chatWelcome}])}catch(b){console.error("Failed to start chat:",b),i([{sender:"bot",text:"Error: Could not connect to AI service. Please check your API key configuration."}])}},[t]);const y=()=>{var b;(b=p.current)==null||b.scrollIntoView({behavior:"smooth"})};ne.useEffect(y,[n]);const T=async(b=r)=>{if(!b.trim()||a||!d.current)return;const q={sender:"user",text:b};i(A=>[...A,q]),o(""),u(!0);try{const A=await KM(d.current,b);let x="";i(R=>[...R,{sender:"bot",text:""}]);for await(const R of A)x+=R.text,i(z=>{const W=[...z];return W[W.length-1].text=x,W})}catch(A){const x=A instanceof Error?A.message:"An unknown error occurred.";i(R=>[...R,{sender:"bot",text:`Sorry, something went wrong. ${x}`}])}finally{u(!1)}},I=()=>{if(console.log("Share Location Clicked. Location:",e),e.latitude&&e.longitude){const b=`My current location is Latitude: ${e.latitude}, Longitude: ${e.longitude}.`;T(b)}else alert("Location is not available yet. Please Ensure GPS is enabled and wait a moment.")},V=b=>{b.key==="Enter"&&!a&&T()};return C.jsxs("div",{className:"flex flex-col h-[calc(100vh-150px)] max-h-[70vh] bg-white rounded-2xl shadow-lg border border-slate-200 animate-fadeIn overflow-hidden",children:[C.jsxs("div",{className:"flex-grow p-4 overflow-y-auto space-y-4 bg-slate-50",children:[n.map((b,q)=>C.jsxs("div",{className:`flex items-end gap-2 ${b.sender==="user"?"justify-end":"justify-start"}`,children:[b.sender==="bot"&&C.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-slate-200 text-slate-600 flex items-center justify-center mb-1 shadow-sm",children:C.jsx(Jx,{})}),C.jsxs("div",{className:`max-w-[80%] md:max-w-md px-5 py-3 rounded-2xl shadow-sm text-sm leading-relaxed ${b.sender==="user"?"bg-blue-600 text-white rounded-br-none":"bg-white text-slate-800 border border-slate-200 rounded-bl-none"}`,children:[C.jsx("p",{className:"break-words",children:b.text}),a&&b.sender==="bot"&&q===n.length-1&&C.jsxs("div",{className:"typing-indicator mt-1 opacity-70",children:[C.jsx("span",{children:"."}),C.jsx("span",{children:"."}),C.jsx("span",{children:"."})]})]}),b.sender==="user"&&C.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center mb-1 shadow-sm",children:C.jsx(wE,{})})]},q)),C.jsx("div",{ref:p})]}),C.jsxs("div",{className:"p-4 bg-white border-t border-slate-200 flex items-center gap-3",children:[C.jsx("button",{onClick:I,title:e.latitude?"Share my location":"Waiting for GPS...",disabled:a,className:`transition-colors p-2 rounded-full ${e.latitude?"text-blue-600 hover:bg-blue-50":"text-slate-300 hover:text-slate-400"}`,children:C.jsx(Zx,{})}),C.jsx("input",{type:"text",value:r,onChange:b=>o(b.target.value),onKeyPress:V,placeholder:g.chatInput,className:"flex-grow bg-slate-100 border border-slate-200 text-slate-900 rounded-full py-3 px-5 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:bg-white transition-all text-sm shadow-inner",disabled:a}),C.jsx("button",{onClick:()=>T(),disabled:a||!r.trim(),className:"bg-blue-600 hover:bg-blue-700 disabled:bg-slate-300 text-white p-3 rounded-full shadow-md transition-all transform hover:scale-105",children:C.jsx(Kx,{})})]}),C.jsx("style",{children:`
        .typing-indicator span {
          display: inline-block;
          animation: bounce 1.2s infinite;
          margin: 0 1px;
        }
        .typing-indicator span:nth-child(2) {
          animation-delay: 0.2s;
        }
        .typing-indicator span:nth-child(3) {
          animation-delay: 0.4s;
        }
        @keyframes bounce {
          0%, 60%, 100% { transform: translateY(0); }
          30% { transform: translateY(-4px); }
        }
      `})]})},hF=({location:t,manualLocation:e,language:n})=>{var B;const[i,r]=ne.useState(!0),[o,a]=ne.useState(null),[u,d]=ne.useState([]),[p,g]=ne.useState(!1),[y,T]=ne.useState(""),[I,V]=ne.useState("All"),[b,q]=ne.useState(!1),[A,x]=ne.useState({temp:32,condition:"Sunny",humidity:65}),[R,z]=ne.useState(!0),W=Ls[n];ne.useEffect(()=>{if(!Zi)return;const U=Ib(yC(Zi,"reports"),Sb("timestamp","desc"),xb(20)),M=Lb(U,le=>{const De=[];le.forEach(we=>{var Z;const Fe=we.data();De.push({id:we.id,timestamp:((Z=Fe.timestamp)==null?void 0:Z.toMillis())||Date.now(),severity:Fe.severity,location:Fe.location,description:Fe.description,originalText:Fe.originalText,reporterName:Fe.reporterName,verificationCount:Fe.verificationCount||0})}),d(De)});return()=>M()},[]);const J=async(U,M)=>{if(!Zi)return;const le=vC(Zi,"reports",U);await kb(le,{verificationCount:bb(M==="up"?1:-1)})};ne.useEffect(()=>{(async()=>{r(!0);const M=e||(t.latitude&&t.longitude?{latitude:t.latitude,longitude:t.longitude}:null);try{const le=await WM(M,n);a(le)}catch(le){console.error("Failed to fetch updates",le)}finally{r(!1)}})()},[t.latitude,t.longitude,e,n]);const k=()=>{if(!o||!o.text)return;if(p){window.speechSynthesis.cancel(),g(!1);return}const U=new SpeechSynthesisUtterance(o.text),le=window.speechSynthesis.getVoices().find(De=>De.lang.includes("IN")||De.lang.includes("hi"));le&&(U.voice=le),U.rate=.9,U.onend=()=>g(!1),window.speechSynthesis.speak(U),g(!0)};ne.useEffect(()=>()=>window.speechSynthesis.cancel(),[]);const N=U=>{const M=Math.floor((Date.now()-U)/6e4);return M<1?W.justNow:M<60?`${M} ${W.minsAgo}`:`${Math.floor(M/60)} ${W.hrsAgo}`},D=u.filter(U=>{const M=U.description.toLowerCase().includes(y.toLowerCase())||U.location.toLowerCase().includes(y.toLowerCase()),le=I==="All"||U.severity===I.toLowerCase();return M&&le}),F=((B=o==null?void 0:o.groundingChunks)==null?void 0:B.filter(U=>{var M,le;return((M=U.web)==null?void 0:M.uri)||((le=U.maps)==null?void 0:le.uri)}))||[];return C.jsxs("div",{className:"animate-fadeIn pb-24 max-w-3xl mx-auto space-y-8",children:[C.jsxs("div",{className:"sticky top-0 bg-slate-50/95 backdrop-blur z-20 pt-2 pb-4 px-1",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsxs("div",{children:[C.jsx("h1",{className:"text-2xl font-black text-slate-800 tracking-tight",children:"Campus Pulse"}),C.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-widest",children:new Date().toLocaleDateString("en-US",{weekday:"long",split:" ",month:"short",day:"numeric"})})]}),C.jsxs("div",{className:"flex items-center gap-2 bg-white px-3 py-1.5 rounded-full shadow-sm border border-slate-200",children:[C.jsx("span",{className:"text-yellow-500",children:C.jsx(rA,{})}),C.jsxs("div",{children:[C.jsxs("p",{className:"text-xs font-bold text-slate-700",children:[A.temp,"C"]}),C.jsx("p",{className:"text-[10px] text-slate-400 font-medium",children:A.condition})]})]})]}),C.jsxs("div",{className:"relative",children:[C.jsx("input",{type:"text",placeholder:"Search updates, places, or reports...",value:y,onChange:U=>T(U.target.value),className:"w-full bg-white border border-slate-300 rounded-xl pl-10 pr-4 py-3 shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"}),C.jsx("div",{className:"absolute left-3 top-3.5 text-slate-400",children:C.jsx(EE,{})})]})]}),C.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-700 rounded-2xl shadow-lg text-white overflow-hidden relative",children:[C.jsx("div",{className:"absolute top-0 right-0 p-32 bg-white opacity-5 rounded-full blur-3xl transform translate-x-10 -translate-y-10 pointer-events-none"}),C.jsxs("div",{className:"p-6 relative z-10",children:[C.jsxs("div",{className:"flex justify-between items-start mb-4",children:[C.jsxs("div",{children:[C.jsx("span",{className:"bg-blue-500/30 text-blue-100 border border-blue-400/30 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase tracking-wider mb-2 inline-block",children:"AI Generated"}),C.jsx("h2",{className:"text-xl font-bold",children:"Daily Briefing"})]}),C.jsx("button",{onClick:k,className:"bg-white/10 hover:bg-white/20 p-3 rounded-full backdrop-blur-sm transition-all border border-white/10",children:p?C.jsx(iA,{}):C.jsx(nA,{})})]}),i?C.jsxs("div",{className:"space-y-3 animate-pulse",children:[C.jsx("div",{className:"h-4 bg-white/20 rounded w-3/4"}),C.jsx("div",{className:"h-4 bg-white/20 rounded w-full"}),C.jsx("div",{className:"h-4 bg-white/20 rounded w-5/6"})]}):o?C.jsxs("div",{className:`prose prose-invert prose-sm max-w-none transition-all duration-500 ${R?"max-h-[500px]":"max-h-24 overflow-hidden relative"}`,children:[C.jsx("div",{className:"whitespace-pre-wrap leading-relaxed opacity-90",children:o.text}),!R&&C.jsx("div",{className:"absolute bottom-0 left-0 w-full h-16 bg-gradient-to-t from-indigo-700 to-transparent"})]}):C.jsx("div",{className:"text-center py-8 opacity-70 italic",children:W.noUpdates}),o&&C.jsx("button",{onClick:()=>z(!R),className:"mt-4 text-xs font-bold uppercase tracking-widest text-blue-200 hover:text-white transition-colors",children:R?"Show Less":"Read Full Briefing"})]}),F.length>0&&C.jsx("div",{className:"bg-black/20 p-4 backdrop-blur-sm flex gap-3 overflow-x-auto",children:F.map((U,M)=>{var le,De,we,Fe;return C.jsx("a",{href:((le=U.web)==null?void 0:le.uri)||((De=U.maps)==null?void 0:De.uri),target:"_blank",rel:"noopener noreferrer",className:"flex-shrink-0 text-xs bg-white/10 hover:bg-white/20 border border-white/10 text-white px-3 py-1.5 rounded-lg transition-all truncate max-w-[120px]",children:((we=U.web)==null?void 0:we.title)||((Fe=U.maps)==null?void 0:Fe.title)||"Source"},M)})})]}),C.jsxs("div",{children:[C.jsx("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-widest mb-4 px-1",children:"Campus Status"}),C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[C.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow relative group",children:[C.jsx("span",{className:"absolute top-5 right-5 w-3 h-3 bg-green-500 rounded-full animate-pulse shadow-[0_0_8px_rgba(34,197,94,0.6)]"}),C.jsx("div",{className:"w-10 h-10 bg-blue-50 text-blue-600 rounded-xl flex items-center justify-center mb-3",children:""}),C.jsx("h4",{className:"font-bold text-slate-900",children:"OPD Services"}),C.jsx("p",{className:"text-xs text-slate-500 mt-1 font-medium",children:"Open  Closes in 4h 30m"}),C.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 flex gap-2 opacity-60 group-hover:opacity-100 transition-opacity",children:[C.jsxs("button",{className:"flex-1 text-xs bg-slate-50 hover:bg-slate-100 py-2 rounded-lg font-bold text-slate-600 flex items-center justify-center gap-1",children:[C.jsx(R_,{})," Call"]}),C.jsxs("button",{className:"flex-1 text-xs bg-slate-50 hover:bg-slate-100 py-2 rounded-lg font-bold text-slate-600 flex items-center justify-center gap-1",children:[C.jsx(P_,{})," Map"]})]})]}),C.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-red-100 shadow-sm hover:shadow-md transition-shadow relative group",children:[C.jsx("span",{className:"absolute top-5 right-5 px-2 py-0.5 bg-red-100 text-red-700 text-[10px] font-bold uppercase rounded-full border border-red-200",children:"Critical"}),C.jsx("div",{className:"w-10 h-10 bg-red-50 text-red-600 rounded-xl flex items-center justify-center mb-3",children:""}),C.jsx("h4",{className:"font-bold text-slate-900",children:"Emergency / Casuality"}),C.jsx("p",{className:"text-xs text-slate-500 mt-1 font-medium",children:"24/7 Operational  High Load"}),C.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 flex gap-2 opacity-60 group-hover:opacity-100 transition-opacity",children:[C.jsxs("button",{className:"flex-1 text-xs bg-red-50 hover:bg-red-100 py-2 rounded-lg font-bold text-red-600 flex items-center justify-center gap-1",children:[C.jsx(R_,{})," SOS"]}),C.jsxs("button",{className:"flex-1 text-xs bg-slate-50 hover:bg-slate-100 py-2 rounded-lg font-bold text-slate-600 flex items-center justify-center gap-1",children:[C.jsx(P_,{})," Route"]})]})]})]})]}),C.jsxs("div",{children:[C.jsxs("div",{className:"flex justify-between items-end mb-4 px-1",children:[C.jsxs("div",{children:[C.jsx("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-widest",children:"Community Reports"}),C.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:"Real-time updates from students & staff"})]}),C.jsx("div",{className:"flex bg-white p-1 rounded-lg border border-slate-200 shadow-sm",children:["All","Heavy","Closure"].map(U=>C.jsx("button",{onClick:()=>V(U),className:`px-3 py-1 rounded-md text-[10px] font-bold transition-all ${I===U?"bg-slate-800 text-white shadow-sm":"text-slate-500 hover:bg-slate-50"}`,children:U},U))})]}),!Zi&&C.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4 flex items-center gap-3 mb-6",children:[C.jsx(jx,{}),C.jsxs("div",{children:[C.jsx("p",{className:"text-sm font-bold text-orange-800",children:"Connection Offline"}),C.jsx("p",{className:"text-xs text-orange-600",children:"Community reports are currently read-only."})]})]}),C.jsx("div",{className:"space-y-4",children:D.length>0?D.map(U=>C.jsx("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-all",children:C.jsxs("div",{className:"flex items-start gap-4",children:[C.jsxs("div",{className:"flex flex-col items-center gap-1 text-slate-400 bg-slate-50 rounded-lg p-1.5 border border-slate-100",children:[C.jsx("button",{onClick:()=>J(U.id,"up"),className:"hover:text-green-600 transition-colors",children:C.jsx(eA,{})}),C.jsx("span",{className:"text-xs font-bold text-slate-700",children:U.verificationCount||0}),C.jsx("button",{onClick:()=>J(U.id,"down"),className:"hover:text-red-500 transition-colors",children:C.jsx(tA,{})})]}),C.jsxs("div",{className:"flex-1",children:[C.jsxs("div",{className:"flex justify-between items-start",children:[C.jsx("h4",{className:"font-bold text-slate-900 text-sm",children:U.location}),C.jsx("span",{className:"text-[10px] text-slate-400 font-mono",children:N(U.timestamp)})]}),C.jsx("p",{className:"text-sm text-slate-600 mt-1 leading-snug",children:U.description}),C.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[C.jsx("span",{className:`text-[10px] font-bold uppercase px-2 py-0.5 rounded-full border ${U.severity==="heavy"?"bg-red-50 text-red-600 border-red-100":U.severity==="moderate"?"bg-yellow-50 text-yellow-600 border-yellow-100":"bg-green-50 text-green-600 border-green-100"}`,children:U.severity}),C.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[C.jsx(wE,{})," ",U.reporterName]})]})]})]})},U.id)):C.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-dashed border-slate-300",children:[C.jsx("div",{className:"text-slate-300 mb-2 mx-auto w-fit",children:C.jsx(em,{})}),C.jsx("p",{className:"text-slate-500 text-sm font-medium",children:y?"No reports match your search":"No reports yet. Be the first!"})]})})]}),C.jsx("button",{onClick:()=>{Zi?q(!0):alert("Database not connected.")},className:"fixed bottom-24 right-5 w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg shadow-blue-600/30 flex items-center justify-center hover:bg-blue-700 hover:scale-110 active:scale-95 transition-all z-30",children:C.jsx(oA,{})})]})},ic=({icon:t,title:e,description:n})=>C.jsxs("div",{className:"flex items-start space-x-4",children:[C.jsx("div",{className:"flex-shrink-0 text-blue-600 mt-1",children:t}),C.jsxs("div",{children:[C.jsx("h4",{className:"font-bold text-lg text-slate-800",children:e}),C.jsx("p",{className:"text-slate-600",children:n})]})]}),fF=({onClose:t})=>C.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn",onClick:t,children:C.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg p-6 md:p-8 space-y-6 max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[C.jsxs("div",{className:"text-center",children:[C.jsx("h2",{className:"text-2xl font-bold text-blue-800",children:"App Guide"}),C.jsx("p",{className:"text-slate-500 mt-1",children:"Here's a quick look at what each feature does."})]}),C.jsxs("div",{className:"space-y-6",children:[C.jsx(ic,{icon:C.jsx(_E,{}),title:"Plan Smart Route",description:"Use this to get detailed, step-by-step directions. Our AI 'Thinks' like a local, considering real-time traffic, narrow streets, market days, and even temporary closures. Just enter your destination and any special requests (like 'avoid the crowded temple road')."}),C.jsx(ic,{icon:C.jsx(yE,{}),title:"Local Updates",description:"Tap here to get a quick summary of what's happening around you right now. The AI scans for news on traffic jams, road closures, festivals, or other events that could affect your travel. It's like having a local news reporter just for you."}),C.jsx(ic,{icon:C.jsx(vE,{}),title:"Ask Assistant",description:"This is your personal chat assistant. Have a question? Just ask! You can ask for directions, find the nearest pharmacy, or even ask about the weather. For example, try asking: 'Where can I find the best chai near me?'"}),C.jsx(ic,{icon:C.jsx(em,{}),title:"Report Traffic",description:"This feature will allow you to help other users by reporting traffic jams, accidents, or road closures you see. By working together, we can make navigation better for everyone. (Coming soon!)"})]}),C.jsx("div",{className:"text-center pt-4",children:C.jsx("button",{onClick:t,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-xl transition-colors shadow-md",children:"Got It!"})})]})}),pF=({isOpen:t,onClose:e,onSave:n,currentLocation:i})=>{const[r,o]=ne.useState("");if(ne.useEffect(()=>{t&&o(i||"")},[t,i]),!t)return null;const a=()=>{n(r)};return C.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn",onClick:e,children:C.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 space-y-5",onClick:u=>u.stopPropagation(),children:[C.jsxs("div",{children:[C.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Enter Location Manually"}),C.jsx("p",{className:"text-sm text-slate-500 mt-1",children:'Set your starting point by name (e.g., "Main Market", "Railway Station"). Leave blank to clear and use GPS.'})]}),C.jsxs("div",{children:[C.jsx("label",{htmlFor:"manual-location",className:"sr-only",children:"Manual Location"}),C.jsx("input",{id:"manual-location",type:"text",value:r,onChange:u=>o(u.target.value),placeholder:"e.g., Town Center",className:"w-full bg-slate-50 border border-slate-300 text-slate-900 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",autoFocus:!0})]}),C.jsxs("div",{className:"flex justify-end space-x-3 pt-2",children:[C.jsx("button",{onClick:e,className:"px-5 py-2.5 bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 font-semibold rounded-lg transition-colors",children:"Cancel"}),C.jsx("button",{onClick:a,className:"px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition-colors shadow-sm",children:"Save Location"})]})]})})},mF=()=>{const[t,e]=ne.useState({latitude:null,longitude:null,accuracy:null}),[n,i]=ne.useState(null),[r,o]=ne.useState(!0),a=()=>{if(!navigator.geolocation){i("Geolocation is not supported by your browser."),o(!1);return}navigator.geolocation.getCurrentPosition(u=>{e({latitude:u.coords.latitude,longitude:u.coords.longitude,accuracy:u.coords.accuracy}),o(!1),i(null)},u=>{i(u.message),o(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})};return ne.useEffect(()=>{a();const u=setInterval(a,5e3);return()=>clearInterval(u)},[]),{location:t,error:n,loading:r}},gF=()=>{const[t,e]=ne.useState("home"),[n,i]=ne.useState(!1),{location:r,error:o,loading:a}=mF(),[u,d]=ne.useState(null),[p,g]=ne.useState(!1),[y,T]=ne.useState(!0),[I,V]=ne.useState("en"),b=Ls[I],q=async R=>{const z=R.trim();if(d(z===""?null:z),g(!1),z==="")T(!0);else{const W=await qM(z);T(W)}},A=()=>{switch(t){case"planner":return C.jsx(cF,{location:r,manualLocation:u,language:I});case"chat":return C.jsx(dF,{language:I,location:r});case"updates":return C.jsx(hF,{location:r,manualLocation:u,language:I});case"home":default:return C.jsx(Bb,{setView:e,geoStatus:{error:o,loading:a},onShowInstructions:()=>i(!0),manualLocation:u,onEnterLocationManually:()=>g(!0),isScbContext:y,language:I})}},x=({activeView:R,targetView:z,icon:W,label:J})=>C.jsxs("button",{onClick:()=>e(z),className:`flex flex-col items-center justify-center w-full pt-3 pb-2 transition-all duration-200 ${R===z?"text-blue-700 transform scale-105 font-semibold":"text-slate-400 hover:text-slate-600"}`,children:[W,C.jsx("span",{className:"text-[10px] uppercase tracking-wide mt-1",children:J})]});return C.jsxs("div",{className:"h-full w-full bg-slate-50 text-slate-900 font-sans flex flex-col overflow-hidden relative",children:[n&&C.jsx(fF,{onClose:()=>i(!1)}),C.jsx(pF,{isOpen:p,onClose:()=>g(!1),onSave:q,currentLocation:u}),C.jsxs("header",{className:"bg-white/90 backdrop-blur-md border-b border-slate-200 shadow-sm p-4 text-center z-10 flex justify-between items-center flex-shrink-0",children:[C.jsx("h1",{className:"text-xl font-bold tracking-tight text-blue-800 flex-grow text-center",children:b.appName}),C.jsx("button",{onClick:()=>V(R=>R==="en"?"or":"en"),className:"absolute right-4 top-1/2 transform -translate-y-1/2 bg-slate-100 hover:bg-slate-200 px-3 py-1.5 rounded-md text-xs font-bold border border-slate-300 text-slate-700 transition-colors shadow-sm",children:I==="en"?"":"English"})]}),C.jsx("main",{className:"flex-grow p-4 md:p-6 overflow-y-auto scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-transparent",children:A()}),C.jsxs("nav",{className:"bg-white border-t border-slate-200 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] flex justify-around z-10 flex-shrink-0 pb-safe",children:[C.jsx(x,{activeView:t,targetView:"home",icon:C.jsx(Ux,{}),label:b.navHome}),C.jsx(x,{activeView:t,targetView:"planner",icon:C.jsx(Ox,{}),label:b.navPlanner}),C.jsx(x,{activeView:t,targetView:"updates",icon:C.jsx(zx,{}),label:b.navUpdates}),C.jsx(x,{activeView:t,targetView:"chat",icon:C.jsx(Bx,{}),label:b.navChat})]})]})},UC=document.getElementById("root");if(!UC)throw new Error("Could not find root element to mount to");const _F=Dh.createRoot(UC);_F.render(C.jsx(ms.StrictMode,{children:C.jsx(gF,{})}));
